System.register(["./index-legacy-67e8bfb9.js"],(function(t,e){"use strict";var r,n,i,s,o,a,c,u,h,l,f,p,d,g,y,v,m,w,_,b,E,I,P,S,O,x,R,C,A,T,j,N,L,q,D,M,z,k,$,U,H,V,K,B,F,G,W,Q,Y,J,Z,X,tt,et,rt,nt,it,st,ot,at,ct,ut,ht,lt,ft,pt,dt,gt,yt,vt,mt,wt,_t,bt,Et,It,Pt,St,Ot,xt,Rt,Ct,At,Tt;return{setters:[t=>{r=t.aD,n=t.aE,i=t.aF,s=t.aG,o=t.aH,a=t.aI,c=t.aJ,u=t.aK,h=t.aL,l=t.aM,f=t.aN,p=t.aO,d=t.aP,g=t.aQ,y=t.aR,v=t.aS,m=t.aT,w=t.aU,_=t.aV,b=t.aW,E=t.aX,I=t.aY,P=t.aZ,S=t.a_,O=t.a$,x=t.b0,R=t.b1,C=t.b2,A=t.b3,T=t.b4,j=t.b5,N=t.b6,L=t.b7,q=t.b8,D=t.b9,M=t.ba,z=t.bb,k=t.bc,$=t.bd,U=t.be,H=t.bf,V=t.bg,K=t.bh,B=t.bi,F=t.bj,G=t.bk,W=t.bl,Q=t.bm,Y=t.bn,J=t.bo,Z=t.bp,X=t.bq,tt=t.br,et=t.bs,rt=t.bt,nt=t.bu,it=t.bv,st=t.bw,ot=t.bx,at=t.by,ct=t.bz,ut=t.bA,ht=t.bB,lt=t.bC,ft=t.bD,pt=t.bE,dt=t.bF,gt=t.bG,yt=t.bH,vt=t.bI,mt=t.bJ,wt=t.bK,_t=t.bL,bt=t.bM,Et=t.bN,It=t.bO,Pt=t.bP,St=t.bQ,Ot=t.bR,xt=t.bS,Rt=t.bT,Ct=t.bU,At=t.bV,Tt=t.aB}],execute:function(){var jt={},Nt=function(t,e){return Nt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},Nt(t,e)},Lt=function(){return Lt=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},Lt.apply(this,arguments)};
/*! *****************************************************************************
            Copyright (c) Microsoft Corporation.

            Permission to use, copy, modify, and/or distribute this software for any
            purpose with or without fee is hereby granted.

            THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
            REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
            AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
            INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
            LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
            OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
            PERFORMANCE OF THIS SOFTWARE.
            ***************************************************************************** */function qt(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Dt(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,s=r.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(n=s.next()).done;)o.push(n.value)}catch(a){i={error:a}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}return o}function Mt(t){return this instanceof Mt?(this.v=t,this):new Mt(t)}const zt=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return Lt},__asyncDelegator:function(t){var e,r;return e={},n("next"),n("throw",(function(t){throw t})),n("return"),e[Symbol.iterator]=function(){return this},e;function n(n,i){e[n]=t[n]?function(e){return(r=!r)?{value:Mt(t[n](e)),done:"return"===n}:i?i(e):e}:i}},__asyncGenerator:function(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(t,e||[]),s=[];return n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n;function o(t){i[t]&&(n[t]=function(e){return new Promise((function(r,n){s.push([t,e,r,n])>1||a(t,e)}))})}function a(t,e){try{(r=i[t](e)).value instanceof Mt?Promise.resolve(r.value.v).then(c,u):h(s[0][2],r)}catch(n){h(s[0][3],n)}var r}function c(t){a("next",t)}function u(t){a("throw",t)}function h(t,e){t(e),s.shift(),s.length&&a(s[0][0],s[0][1])}},__asyncValues:function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,r=t[Symbol.asyncIterator];return r?r.call(t):(t=qt(t),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(r){e[r]=t[r]&&function(e){return new Promise((function(n,i){!function(t,e,r,n){Promise.resolve(n).then((function(e){t({value:e,done:r})}),e)}(n,i,(e=t[r](e)).done,e.value)}))}}},__await:Mt,__awaiter:function(t,e,r,n){return new(r||(r=Promise))((function(i,s){function o(t){try{c(n.next(t))}catch(e){s(e)}}function a(t){try{c(n.throw(t))}catch(e){s(e)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(o,a)}c((n=n.apply(t,e||[])).next())}))},__classPrivateFieldGet:function(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)},__classPrivateFieldSet:function(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r},__createBinding:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]},__decorate:function(t,e,r,n){var i,s=arguments.length,o=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(o=(s<3?i(o):s>3?i(e,r,o):i(e,r))||o);return s>3&&o&&Object.defineProperty(e,r,o),o},__exportStar:function(t,e){for(var r in t)"default"===r||e.hasOwnProperty(r)||(e[r]=t[r])},__extends:function(t,e){function r(){this.constructor=t}Nt(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},__generator:function(t,e){var r,n,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(i=2&s[0]?n.return:s[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,s[1])).done)return i;switch(n=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(a){s=[6,a],n=0}finally{r=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}},__importDefault:function(t){return t&&t.__esModule?t:{default:t}},__importStar:function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e},__makeTemplateObject:function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t},__metadata:function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},__param:function(t,e){return function(r,n){e(r,n,t)}},__read:Dt,__rest:function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]])}return r},__spread:function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Dt(arguments[e]));return t},__spreadArrays:function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),i=0;for(e=0;e<r;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,i++)n[i]=s[o];return n},__values:qt},Symbol.toStringTag,{value:"Module"})),kt=r(zt);var $t={};Object.defineProperty($t,"__esModule",{value:!0}),$t.safeJsonParse=function(t){if("string"!=typeof t)throw new Error("Cannot safe json parse value of type "+typeof t);try{return JSON.parse(t)}catch(e){return t}},$t.safeJsonStringify=function(t){return"string"==typeof t?t:JSON.stringify(t,((t,e)=>void 0===e?null:e))};var Ut,Ht,Vt,Kt,Bt={exports:{}},Ft={},Gt={},Wt={};Object.defineProperty(jt,"__esModule",{value:!0}),jt.KeyValueStorage=void 0;const Qt=kt,Yt=$t,Jt=Qt.__importDefault((Ut||(Ut=1,function(){let t;function e(){}t=e,t.prototype.getItem=function(t){return this.hasOwnProperty(t)?String(this[t]):null},t.prototype.setItem=function(t,e){this[t]=String(e)},t.prototype.removeItem=function(t){delete this[t]},t.prototype.clear=function(){const t=this;Object.keys(t).forEach((function(e){t[e]=void 0,delete t[e]}))},t.prototype.key=function(t){return t=t||0,Object.keys(this)[t]},t.prototype.__defineGetter__("length",(function(){return Object.keys(this).length})),void 0!==n&&n.localStorage?Bt.exports=n.localStorage:"undefined"!=typeof window&&window.localStorage?Bt.exports=window.localStorage:Bt.exports=new e}()),Bt.exports)),Zt=(Kt||(Kt=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=kt;e.__exportStar((Ht||(Ht=1,Object.defineProperty(Gt,"__esModule",{value:!0}),Gt.IKeyValueStorage=void 0,Gt.IKeyValueStorage=class{}),Gt),t),e.__exportStar(function(){if(Vt)return Wt;Vt=1,Object.defineProperty(Wt,"__esModule",{value:!0}),Wt.parseEntry=void 0;const t=$t;return Wt.parseEntry=function(e){var r;return[e[0],t.safeJsonParse(null!==(r=e[1])&&void 0!==r?r:"")]},Wt}(),t)}(Ft)),Ft);class Xt{constructor(){this.localStorage=Jt.default}getKeys(){return Qt.__awaiter(this,void 0,void 0,(function*(){return Object.keys(this.localStorage)}))}getEntries(){return Qt.__awaiter(this,void 0,void 0,(function*(){return Object.entries(this.localStorage).map(Zt.parseEntry)}))}getItem(t){return Qt.__awaiter(this,void 0,void 0,(function*(){const e=this.localStorage.getItem(t);if(null!==e)return Yt.safeJsonParse(e)}))}setItem(t,e){return Qt.__awaiter(this,void 0,void 0,(function*(){this.localStorage.setItem(t,Yt.safeJsonStringify(e))}))}removeItem(t){return Qt.__awaiter(this,void 0,void 0,(function*(){this.localStorage.removeItem(t)}))}}jt.KeyValueStorage=Xt;var te=jt.default=Xt,ee={},re=function(t,e){return re=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},re(t,e)},ne=function(){return ne=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},ne.apply(this,arguments)};function ie(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function se(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,s=r.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(n=s.next()).done;)o.push(n.value)}catch(a){i={error:a}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}return o}function oe(t){return this instanceof oe?(this.v=t,this):new oe(t)}const ae=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return ne},__asyncDelegator:function(t){var e,r;return e={},n("next"),n("throw",(function(t){throw t})),n("return"),e[Symbol.iterator]=function(){return this},e;function n(n,i){e[n]=t[n]?function(e){return(r=!r)?{value:oe(t[n](e)),done:"return"===n}:i?i(e):e}:i}},__asyncGenerator:function(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(t,e||[]),s=[];return n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n;function o(t){i[t]&&(n[t]=function(e){return new Promise((function(r,n){s.push([t,e,r,n])>1||a(t,e)}))})}function a(t,e){try{(r=i[t](e)).value instanceof oe?Promise.resolve(r.value.v).then(c,u):h(s[0][2],r)}catch(n){h(s[0][3],n)}var r}function c(t){a("next",t)}function u(t){a("throw",t)}function h(t,e){t(e),s.shift(),s.length&&a(s[0][0],s[0][1])}},__asyncValues:function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,r=t[Symbol.asyncIterator];return r?r.call(t):(t=ie(t),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(r){e[r]=t[r]&&function(e){return new Promise((function(n,i){!function(t,e,r,n){Promise.resolve(n).then((function(e){t({value:e,done:r})}),e)}(n,i,(e=t[r](e)).done,e.value)}))}}},__await:oe,__awaiter:function(t,e,r,n){return new(r||(r=Promise))((function(i,s){function o(t){try{c(n.next(t))}catch(e){s(e)}}function a(t){try{c(n.throw(t))}catch(e){s(e)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(o,a)}c((n=n.apply(t,e||[])).next())}))},__classPrivateFieldGet:function(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)},__classPrivateFieldSet:function(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r},__createBinding:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]},__decorate:function(t,e,r,n){var i,s=arguments.length,o=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(o=(s<3?i(o):s>3?i(e,r,o):i(e,r))||o);return s>3&&o&&Object.defineProperty(e,r,o),o},__exportStar:function(t,e){for(var r in t)"default"===r||e.hasOwnProperty(r)||(e[r]=t[r])},__extends:function(t,e){function r(){this.constructor=t}re(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},__generator:function(t,e){var r,n,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(i=2&s[0]?n.return:s[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,s[1])).done)return i;switch(n=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(a){s=[6,a],n=0}finally{r=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}},__importDefault:function(t){return t&&t.__esModule?t:{default:t}},__importStar:function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e},__makeTemplateObject:function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t},__metadata:function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},__param:function(t,e){return function(r,n){e(r,n,t)}},__read:se,__rest:function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]])}return r},__spread:function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(se(arguments[e]));return t},__spreadArrays:function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),i=0;for(e=0;e<r;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,i++)n[i]=s[o];return n},__values:ie},Symbol.toStringTag,{value:"Module"})),ce=r(ae);var ue={},he={},le={};let fe=class{};const pe=Object.freeze(Object.defineProperty({__proto__:null,IEvents:fe},Symbol.toStringTag,{value:"Module"})),de=r(pe);var ge,ye;function ve(){return ye||(ye=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),ce.__exportStar(function(){if(ge)return le;ge=1,Object.defineProperty(le,"__esModule",{value:!0}),le.IHeartBeat=void 0;const t=de;class e extends t.IEvents{constructor(t){super()}}return le.IHeartBeat=e,le}(),t)}(he)),he}var me,we,_e,be={},Ee={};function Ie(){return we||(we=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),ce.__exportStar(function(){if(me)return Ee;me=1,Object.defineProperty(Ee,"__esModule",{value:!0}),Ee.HEARTBEAT_EVENTS=Ee.HEARTBEAT_INTERVAL=void 0;const t=i;return Ee.HEARTBEAT_INTERVAL=t.FIVE_SECONDS,Ee.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Ee}(),t)}(be)),be}!function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=ce;e.__exportStar(function(){if(_e)return ue;_e=1,Object.defineProperty(ue,"__esModule",{value:!0}),ue.HeartBeat=void 0;const t=ce,e=s,r=i,n=ve(),o=Ie();class a extends n.IHeartBeat{constructor(t){super(t),this.events=new e.EventEmitter,this.interval=o.HEARTBEAT_INTERVAL,this.interval=(null==t?void 0:t.interval)||o.HEARTBEAT_INTERVAL}static init(e){return t.__awaiter(this,void 0,void 0,(function*(){const t=new a(e);return yield t.init(),t}))}init(){return t.__awaiter(this,void 0,void 0,(function*(){yield this.initialize()}))}stop(){clearInterval(this.intervalRef)}on(t,e){this.events.on(t,e)}once(t,e){this.events.once(t,e)}off(t,e){this.events.off(t,e)}removeListener(t,e){this.events.removeListener(t,e)}initialize(){return t.__awaiter(this,void 0,void 0,(function*(){this.intervalRef=setInterval((()=>this.pulse()),r.toMiliseconds(this.interval))}))}pulse(){this.events.emit(o.HEARTBEAT_EVENTS.pulse)}}return ue.HeartBeat=a,ue}(),t),e.__exportStar(ve(),t),e.__exportStar(Ie(),t)}(ee);var Pe={},Se=function(t,e){return Se=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},Se(t,e)},Oe=function(){return Oe=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},Oe.apply(this,arguments)};
/*! *****************************************************************************
            Copyright (c) Microsoft Corporation.

            Permission to use, copy, modify, and/or distribute this software for any
            purpose with or without fee is hereby granted.

            THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
            REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
            AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
            INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
            LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
            OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
            PERFORMANCE OF THIS SOFTWARE.
            ***************************************************************************** */function xe(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Re(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,s=r.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(n=s.next()).done;)o.push(n.value)}catch(a){i={error:a}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}return o}function Ce(t){return this instanceof Ce?(this.v=t,this):new Ce(t)}const Ae=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return Oe},__asyncDelegator:function(t){var e,r;return e={},n("next"),n("throw",(function(t){throw t})),n("return"),e[Symbol.iterator]=function(){return this},e;function n(n,i){e[n]=t[n]?function(e){return(r=!r)?{value:Ce(t[n](e)),done:"return"===n}:i?i(e):e}:i}},__asyncGenerator:function(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(t,e||[]),s=[];return n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n;function o(t){i[t]&&(n[t]=function(e){return new Promise((function(r,n){s.push([t,e,r,n])>1||a(t,e)}))})}function a(t,e){try{(r=i[t](e)).value instanceof Ce?Promise.resolve(r.value.v).then(c,u):h(s[0][2],r)}catch(n){h(s[0][3],n)}var r}function c(t){a("next",t)}function u(t){a("throw",t)}function h(t,e){t(e),s.shift(),s.length&&a(s[0][0],s[0][1])}},__asyncValues:function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,r=t[Symbol.asyncIterator];return r?r.call(t):(t=xe(t),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(r){e[r]=t[r]&&function(e){return new Promise((function(n,i){!function(t,e,r,n){Promise.resolve(n).then((function(e){t({value:e,done:r})}),e)}(n,i,(e=t[r](e)).done,e.value)}))}}},__await:Ce,__awaiter:function(t,e,r,n){return new(r||(r=Promise))((function(i,s){function o(t){try{c(n.next(t))}catch(e){s(e)}}function a(t){try{c(n.throw(t))}catch(e){s(e)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(o,a)}c((n=n.apply(t,e||[])).next())}))},__classPrivateFieldGet:function(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)},__classPrivateFieldSet:function(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r},__createBinding:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]},__decorate:function(t,e,r,n){var i,s=arguments.length,o=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(o=(s<3?i(o):s>3?i(e,r,o):i(e,r))||o);return s>3&&o&&Object.defineProperty(e,r,o),o},__exportStar:function(t,e){for(var r in t)"default"===r||e.hasOwnProperty(r)||(e[r]=t[r])},__extends:function(t,e){function r(){this.constructor=t}Se(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},__generator:function(t,e){var r,n,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(i=2&s[0]?n.return:s[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,s[1])).done)return i;switch(n=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(a){s=[6,a],n=0}finally{r=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}},__importDefault:function(t){return t&&t.__esModule?t:{default:t}},__importStar:function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e},__makeTemplateObject:function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t},__metadata:function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},__param:function(t,e){return function(r,n){e(r,n,t)}},__read:Re,__rest:function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]])}return r},__spread:function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Re(arguments[e]));return t},__spreadArrays:function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),i=0;for(e=0;e<r;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,i++)n[i]=s[o];return n},__values:xe},Symbol.toStringTag,{value:"Module"})),Te=r(Ae);var je,Ne,Le,qe;function De(){if(qe)return Le;qe=1;const t=function(){if(Ne)return je;function t(t){try{return JSON.stringify(t)}catch(e){return'"[Circular]"'}}return Ne=1,je=function(e,r,n){var i=n&&n.stringify||t;if("object"==typeof e&&null!==e){var s=r.length+1;if(1===s)return e;var o=new Array(s);o[0]=i(e);for(var a=1;a<s;a++)o[a]=i(r[a]);return o.join(" ")}if("string"!=typeof e)return e;var c=r.length;if(0===c)return e;for(var u="",h=0,l=-1,f=e&&e.length||0,p=0;p<f;){if(37===e.charCodeAt(p)&&p+1<f){switch(l=l>-1?l:0,e.charCodeAt(p+1)){case 100:case 102:if(h>=c)break;if(null==r[h])break;l<p&&(u+=e.slice(l,p)),u+=Number(r[h]),l=p+2,p++;break;case 105:if(h>=c)break;if(null==r[h])break;l<p&&(u+=e.slice(l,p)),u+=Math.floor(Number(r[h])),l=p+2,p++;break;case 79:case 111:case 106:if(h>=c)break;if(void 0===r[h])break;l<p&&(u+=e.slice(l,p));var d=typeof r[h];if("string"===d){u+="'"+r[h]+"'",l=p+2,p++;break}if("function"===d){u+=r[h].name||"<anonymous>",l=p+2,p++;break}u+=i(r[h]),l=p+2,p++;break;case 115:if(h>=c)break;l<p&&(u+=e.slice(l,p)),u+=String(r[h]),l=p+2,p++;break;case 37:l<p&&(u+=e.slice(l,p)),u+="%",l=p+2,p++,h--}++h}++p}return-1===l?e:(l<f&&(u+=e.slice(l)),u)},je}();Le=n;const e=function(){function t(t){return void 0!==t&&t}try{return"undefined"!=typeof globalThis||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch(e){return t(self)||t(window)||t(this)||{}}}().console||{},r={mapHttpRequest:u,mapHttpResponse:u,wrapRequestSerializer:h,wrapResponseSerializer:h,wrapErrorSerializer:h,req:u,res:u,err:function(t){const e={type:t.constructor.name,msg:t.message,stack:t.stack};for(const r in t)void 0===e[r]&&(e[r]=t[r]);return e}};function n(t){(t=t||{}).browser=t.browser||{};const r=t.browser.transmit;if(r&&"function"!=typeof r.send)throw Error("pino: transmit option must have a send function");const u=t.browser.write||e;t.browser.write&&(t.browser.asObject=!0);const h=t.serializers||{},f=function(t,e){return Array.isArray(t)?t.filter((function(t){return"!stdSerializers.err"!==t})):!0===t&&Object.keys(e)}(t.browser.serialize,h);let p=t.browser.serialize;Array.isArray(t.browser.serialize)&&t.browser.serialize.indexOf("!stdSerializers.err")>-1&&(p=!1),"function"==typeof u&&(u.error=u.fatal=u.warn=u.info=u.debug=u.trace=u),!1===t.enabled&&(t.level="silent");const d=t.level||"info",g=Object.create(u);g.log||(g.log=l),Object.defineProperty(g,"levelVal",{get:function(){return"silent"===this.level?1/0:this.levels.values[this.level]}}),Object.defineProperty(g,"level",{get:function(){return this._level},set:function(t){if("silent"!==t&&!this.levels.values[t])throw Error("unknown level "+t);this._level=t,i(y,g,"error","log"),i(y,g,"fatal","error"),i(y,g,"warn","error"),i(y,g,"info","log"),i(y,g,"debug","log"),i(y,g,"trace","log")}});const y={transmit:r,serialize:f,asObject:t.browser.asObject,levels:["error","fatal","warn","info","debug","trace"],timestamp:c(t)};return g.levels=n.levels,g.level=d,g.setMaxListeners=g.getMaxListeners=g.emit=g.addListener=g.on=g.prependListener=g.once=g.prependOnceListener=g.removeListener=g.removeAllListeners=g.listeners=g.listenerCount=g.eventNames=g.write=g.flush=l,g.serializers=h,g._serialize=f,g._stdErrSerialize=p,g.child=function(e,n){if(!e)throw new Error("missing bindings for child Pino");n=n||{},f&&e.serializers&&(n.serializers=e.serializers);const i=n.serializers;if(f&&i){var c=Object.assign({},h,i),u=!0===t.browser.serialize?Object.keys(c):f;delete e.serializers,s([e],u,c,this._stdErrSerialize)}function l(t){this._childLevel=1+(0|t._childLevel),this.error=o(t,e,"error"),this.fatal=o(t,e,"fatal"),this.warn=o(t,e,"warn"),this.info=o(t,e,"info"),this.debug=o(t,e,"debug"),this.trace=o(t,e,"trace"),c&&(this.serializers=c,this._serialize=u),r&&(this._logEvent=a([].concat(t._logEvent.bindings,e)))}return l.prototype=this,new l(this)},r&&(g._logEvent=a()),g}function i(r,i,o,c){const u=Object.getPrototypeOf(i);i[o]=i.levelVal>i.levels.values[o]?l:u[o]?u[o]:e[o]||e[c]||l,function(r,i,o){var c;(r.transmit||i[o]!==l)&&(i[o]=(c=i[o],function(){const u=r.timestamp(),h=new Array(arguments.length),l=Object.getPrototypeOf&&Object.getPrototypeOf(this)===e?e:this;for(var f=0;f<h.length;f++)h[f]=arguments[f];if(r.serialize&&!r.asObject&&s(h,this._serialize,this.serializers,this._stdErrSerialize),r.asObject?c.call(l,function(e,r,i,o){e._serialize&&s(i,e._serialize,e.serializers,e._stdErrSerialize);const a=i.slice();let c=a[0];const u={};o&&(u.time=o),u.level=n.levels.values[r];let h=1+(0|e._childLevel);if(h<1&&(h=1),null!==c&&"object"==typeof c){for(;h--&&"object"==typeof a[0];)Object.assign(u,a.shift());c=a.length?t(a.shift(),a):void 0}else"string"==typeof c&&(c=t(a.shift(),a));return void 0!==c&&(u.msg=c),u}(this,o,h,u)):c.apply(l,h),r.transmit){const t=r.transmit.level||i.level,e=n.levels.values[t],c=n.levels.values[o];if(c<e)return;!function(t,e,r){const n=e.send,i=e.ts,o=e.methodLevel,c=e.methodValue,u=e.val,h=t._logEvent.bindings;s(r,t._serialize||Object.keys(t.serializers),t.serializers,void 0===t._stdErrSerialize||t._stdErrSerialize),t._logEvent.ts=i,t._logEvent.messages=r.filter((function(t){return-1===h.indexOf(t)})),t._logEvent.level.label=o,t._logEvent.level.value=c,n(o,t._logEvent,u),t._logEvent=a(h)}(this,{ts:u,methodLevel:o,methodValue:c,transmitLevel:t,transmitValue:n.levels.values[r.transmit.level||i.level],send:r.transmit.send,val:i.levelVal},h)}}))}(r,i,o)}function s(t,e,r,i){for(const s in t)if(i&&t[s]instanceof Error)t[s]=n.stdSerializers.err(t[s]);else if("object"==typeof t[s]&&!Array.isArray(t[s]))for(const n in t[s])e&&e.indexOf(n)>-1&&n in r&&(t[s][n]=r[n](t[s][n]))}function o(t,e,r){return function(){const n=new Array(1+arguments.length);n[0]=e;for(var i=1;i<n.length;i++)n[i]=arguments[i-1];return t[r].apply(this,n)}}function a(t){return{ts:0,messages:[],bindings:t||[],level:{label:"",value:0}}}function c(t){return"function"==typeof t.timestamp?t.timestamp:!1===t.timestamp?f:p}function u(){return{}}function h(t){return t}function l(){}function f(){return!1}function p(){return Date.now()}return n.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},n.stdSerializers=r,n.stdTimeFunctions=Object.assign({},{nullTime:f,epochTime:p,unixTime:function(){return Math.round(Date.now()/1e3)},isoTime:function(){return new Date(Date.now()).toISOString()}}),Le}var Me,ze={};function ke(){return Me||(Me=1,Object.defineProperty(ze,"__esModule",{value:!0}),ze.PINO_CUSTOM_CONTEXT_KEY=ze.PINO_LOGGER_DEFAULTS=void 0,ze.PINO_LOGGER_DEFAULTS={level:"info"},ze.PINO_CUSTOM_CONTEXT_KEY="custom_context"),ze}var $e,Ue={};!function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.pino=void 0;const e=Te,r=e.__importDefault(De());Object.defineProperty(t,"pino",{enumerable:!0,get:function(){return r.default}}),e.__exportStar(ke(),t),e.__exportStar(function(){if($e)return Ue;$e=1,Object.defineProperty(Ue,"__esModule",{value:!0}),Ue.generateChildLogger=Ue.formatChildLoggerContext=Ue.getLoggerContext=Ue.setBrowserLoggerContext=Ue.getBrowserLoggerContext=Ue.getDefaultLoggerOptions=void 0;const t=ke();function e(e,r=t.PINO_CUSTOM_CONTEXT_KEY){return e[r]||""}function r(e,r,n=t.PINO_CUSTOM_CONTEXT_KEY){return e[n]=r,e}function n(r,n=t.PINO_CUSTOM_CONTEXT_KEY){let i="";return i=void 0===r.bindings?e(r,n):r.bindings().context||"",i}function i(e,r,i=t.PINO_CUSTOM_CONTEXT_KEY){const s=n(e,i);return s.trim()?`${s}/${r}`:r}return Ue.getDefaultLoggerOptions=function(e){return Object.assign(Object.assign({},e),{level:(null==e?void 0:e.level)||t.PINO_LOGGER_DEFAULTS.level})},Ue.getBrowserLoggerContext=e,Ue.setBrowserLoggerContext=r,Ue.getLoggerContext=n,Ue.formatChildLoggerContext=i,Ue.generateChildLogger=function(e,n,s=t.PINO_CUSTOM_CONTEXT_KEY){const o=i(e,n,s);return r(e.child({context:o}),o,s)},Ue}(),t)}(Pe);class He extends fe{constructor(t){super(),this.opts=t,this.protocol="wc",this.version=2}}class Ve extends fe{constructor(t,e){super(),this.core=t,this.logger=e,this.records=new Map}}class Ke{constructor(t,e){this.logger=t,this.core=e}}let Be=class extends fe{constructor(t,e){super(),this.relayer=t,this.logger=e}},Fe=class extends fe{constructor(t){super()}},Ge=class{constructor(t,e,r,n){this.core=t,this.logger=e,this.name=r}};class We extends fe{constructor(t,e){super(),this.relayer=t,this.logger=e}}let Qe=class extends fe{constructor(t,e){super(),this.core=t,this.logger=e}},Ye=class{constructor(t,e){this.projectId=t,this.logger=e}},Je=class{constructor(t){this.opts=t,this.protocol="wc",this.version=2}},Ze=class{constructor(t){this.client=t}};const Xe=t=>JSON.stringify(t,((t,e)=>"bigint"==typeof e?e.toString()+"n":e));function tr(t){if("string"!=typeof t)throw new Error("Cannot safe json parse value of type "+typeof t);try{return(t=>{const e=t.replace(/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,'$1"$2n"$3');return JSON.parse(e,((t,e)=>"string"==typeof e&&e.match(/^\d+n$/)?BigInt(e.substring(0,e.length-1)):e))})(t)}catch(e){return t}}function er(t){return"string"==typeof t?t:Xe(t)||""}var rr={},nr={};!function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=o,r=a;t.DIGEST_LENGTH=64,t.BLOCK_SIZE=128;var n=function(){function n(){this.digestLength=t.DIGEST_LENGTH,this.blockSize=t.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return n.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},n.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},n.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},n.prototype.update=function(e,r){if(void 0===r&&(r=e.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var n=0;if(this._bytesHashed+=r,this._bufferLength>0){for(;this._bufferLength<t.BLOCK_SIZE&&r>0;)this._buffer[this._bufferLength++]=e[n++],r--;this._bufferLength===this.blockSize&&(s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(r>=this.blockSize&&(n=s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,e,n,r),r%=this.blockSize);r>0;)this._buffer[this._bufferLength++]=e[n++],r--;return this},n.prototype.finish=function(t){if(!this._finished){var r=this._bytesHashed,n=this._bufferLength,i=r/536870912|0,o=r<<3,a=r%128<112?128:256;this._buffer[n]=128;for(var c=n+1;c<a-8;c++)this._buffer[c]=0;e.writeUint32BE(i,this._buffer,a-8),e.writeUint32BE(o,this._buffer,a-4),s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,a),this._finished=!0}for(c=0;c<this.digestLength/8;c++)e.writeUint32BE(this._stateHi[c],t,8*c),e.writeUint32BE(this._stateLo[c],t,8*c+4);return this},n.prototype.digest=function(){var t=new Uint8Array(this.digestLength);return this.finish(t),t},n.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},n.prototype.restoreState=function(t){return this._stateHi.set(t.stateHi),this._stateLo.set(t.stateLo),this._bufferLength=t.bufferLength,t.buffer&&this._buffer.set(t.buffer),this._bytesHashed=t.bytesHashed,this._finished=!1,this},n.prototype.cleanSavedState=function(t){r.wipe(t.stateHi),r.wipe(t.stateLo),t.buffer&&r.wipe(t.buffer),t.bufferLength=0,t.bytesHashed=0},n}();t.SHA512=n;var i=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function s(t,r,n,s,o,a,c){for(var u,h,l,f,p,d,g,y,v=n[0],m=n[1],w=n[2],_=n[3],b=n[4],E=n[5],I=n[6],P=n[7],S=s[0],O=s[1],x=s[2],R=s[3],C=s[4],A=s[5],T=s[6],j=s[7];c>=128;){for(var N=0;N<16;N++){var L=8*N+a;t[N]=e.readUint32BE(o,L),r[N]=e.readUint32BE(o,L+4)}for(N=0;N<80;N++){var q,D,M=v,z=m,k=w,$=_,U=b,H=E,V=I,K=S,B=O,F=x,G=R,W=C,Q=A,Y=T;if(p=65535&(h=j),d=h>>>16,g=65535&(u=P),y=u>>>16,p+=65535&(h=(C>>>14|b<<18)^(C>>>18|b<<14)^(b>>>9|C<<23)),d+=h>>>16,g+=65535&(u=(b>>>14|C<<18)^(b>>>18|C<<14)^(C>>>9|b<<23)),y+=u>>>16,p+=65535&(h=C&A^~C&T),d+=h>>>16,g+=65535&(u=b&E^~b&I),y+=u>>>16,u=i[2*N],p+=65535&(h=i[2*N+1]),d+=h>>>16,g+=65535&u,y+=u>>>16,u=t[N%16],d+=(h=r[N%16])>>>16,g+=65535&u,y+=u>>>16,g+=(d+=(p+=65535&h)>>>16)>>>16,p=65535&(h=f=65535&p|d<<16),d=h>>>16,g=65535&(u=l=65535&g|(y+=g>>>16)<<16),y=u>>>16,p+=65535&(h=(S>>>28|v<<4)^(v>>>2|S<<30)^(v>>>7|S<<25)),d+=h>>>16,g+=65535&(u=(v>>>28|S<<4)^(S>>>2|v<<30)^(S>>>7|v<<25)),y+=u>>>16,d+=(h=S&O^S&x^O&x)>>>16,g+=65535&(u=v&m^v&w^m&w),y+=u>>>16,q=65535&(g+=(d+=(p+=65535&h)>>>16)>>>16)|(y+=g>>>16)<<16,D=65535&p|d<<16,p=65535&(h=G),d=h>>>16,g=65535&(u=$),y=u>>>16,d+=(h=f)>>>16,g+=65535&(u=l),y+=u>>>16,m=M,w=z,_=k,b=$=65535&(g+=(d+=(p+=65535&h)>>>16)>>>16)|(y+=g>>>16)<<16,E=U,I=H,P=V,v=q,O=K,x=B,R=F,C=G=65535&p|d<<16,A=W,T=Q,j=Y,S=D,N%16==15)for(L=0;L<16;L++)u=t[L],p=65535&(h=r[L]),d=h>>>16,g=65535&u,y=u>>>16,u=t[(L+9)%16],p+=65535&(h=r[(L+9)%16]),d+=h>>>16,g+=65535&u,y+=u>>>16,l=t[(L+1)%16],p+=65535&(h=((f=r[(L+1)%16])>>>1|l<<31)^(f>>>8|l<<24)^(f>>>7|l<<25)),d+=h>>>16,g+=65535&(u=(l>>>1|f<<31)^(l>>>8|f<<24)^l>>>7),y+=u>>>16,l=t[(L+14)%16],d+=(h=((f=r[(L+14)%16])>>>19|l<<13)^(l>>>29|f<<3)^(f>>>6|l<<26))>>>16,g+=65535&(u=(l>>>19|f<<13)^(f>>>29|l<<3)^l>>>6),y+=u>>>16,y+=(g+=(d+=(p+=65535&h)>>>16)>>>16)>>>16,t[L]=65535&g|y<<16,r[L]=65535&p|d<<16}p=65535&(h=S),d=h>>>16,g=65535&(u=v),y=u>>>16,u=n[0],d+=(h=s[0])>>>16,g+=65535&u,y+=u>>>16,y+=(g+=(d+=(p+=65535&h)>>>16)>>>16)>>>16,n[0]=v=65535&g|y<<16,s[0]=S=65535&p|d<<16,p=65535&(h=O),d=h>>>16,g=65535&(u=m),y=u>>>16,u=n[1],d+=(h=s[1])>>>16,g+=65535&u,y+=u>>>16,y+=(g+=(d+=(p+=65535&h)>>>16)>>>16)>>>16,n[1]=m=65535&g|y<<16,s[1]=O=65535&p|d<<16,p=65535&(h=x),d=h>>>16,g=65535&(u=w),y=u>>>16,u=n[2],d+=(h=s[2])>>>16,g+=65535&u,y+=u>>>16,y+=(g+=(d+=(p+=65535&h)>>>16)>>>16)>>>16,n[2]=w=65535&g|y<<16,s[2]=x=65535&p|d<<16,p=65535&(h=R),d=h>>>16,g=65535&(u=_),y=u>>>16,u=n[3],d+=(h=s[3])>>>16,g+=65535&u,y+=u>>>16,y+=(g+=(d+=(p+=65535&h)>>>16)>>>16)>>>16,n[3]=_=65535&g|y<<16,s[3]=R=65535&p|d<<16,p=65535&(h=C),d=h>>>16,g=65535&(u=b),y=u>>>16,u=n[4],d+=(h=s[4])>>>16,g+=65535&u,y+=u>>>16,y+=(g+=(d+=(p+=65535&h)>>>16)>>>16)>>>16,n[4]=b=65535&g|y<<16,s[4]=C=65535&p|d<<16,p=65535&(h=A),d=h>>>16,g=65535&(u=E),y=u>>>16,u=n[5],d+=(h=s[5])>>>16,g+=65535&u,y+=u>>>16,y+=(g+=(d+=(p+=65535&h)>>>16)>>>16)>>>16,n[5]=E=65535&g|y<<16,s[5]=A=65535&p|d<<16,p=65535&(h=T),d=h>>>16,g=65535&(u=I),y=u>>>16,u=n[6],d+=(h=s[6])>>>16,g+=65535&u,y+=u>>>16,y+=(g+=(d+=(p+=65535&h)>>>16)>>>16)>>>16,n[6]=I=65535&g|y<<16,s[6]=T=65535&p|d<<16,p=65535&(h=j),d=h>>>16,g=65535&(u=P),y=u>>>16,u=n[7],d+=(h=s[7])>>>16,g+=65535&u,y+=u>>>16,y+=(g+=(d+=(p+=65535&h)>>>16)>>>16)>>>16,n[7]=P=65535&g|y<<16,s[7]=j=65535&p|d<<16,a+=128,c-=128}return a}t.hash=function(t){var e=new n;e.update(t);var r=e.digest();return e.clean(),r}}(nr),function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.convertSecretKeyToX25519=t.convertPublicKeyToX25519=t.verify=t.sign=t.extractPublicKeyFromSecretKey=t.generateKeyPair=t.generateKeyPairFromSeed=t.SEED_LENGTH=t.SECRET_KEY_LENGTH=t.PUBLIC_KEY_LENGTH=t.SIGNATURE_LENGTH=void 0;const e=c,r=nr,n=a;function i(t){const e=new Float64Array(16);if(t)for(let r=0;r<t.length;r++)e[r]=t[r];return e}t.SIGNATURE_LENGTH=64,t.PUBLIC_KEY_LENGTH=32,t.SECRET_KEY_LENGTH=64,t.SEED_LENGTH=32,new Uint8Array(32)[0]=9;const s=i(),o=i([1]),u=i([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),h=i([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),l=i([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),f=i([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),p=i([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function d(t,e){for(let r=0;r<16;r++)t[r]=0|e[r]}function g(t){let e=1;for(let r=0;r<16;r++){let n=t[r]+e+65535;e=Math.floor(n/65536),t[r]=n-65536*e}t[0]+=e-1+37*(e-1)}function y(t,e,r){const n=~(r-1);for(let i=0;i<16;i++){const r=n&(t[i]^e[i]);t[i]^=r,e[i]^=r}}function v(t,e){const r=i(),n=i();for(let i=0;i<16;i++)n[i]=e[i];g(n),g(n),g(n);for(let i=0;i<2;i++){r[0]=n[0]-65517;for(let e=1;e<15;e++)r[e]=n[e]-65535-(r[e-1]>>16&1),r[e-1]&=65535;r[15]=n[15]-32767-(r[14]>>16&1);const t=r[15]>>16&1;r[14]&=65535,y(n,r,1-t)}for(let i=0;i<16;i++)t[2*i]=255&n[i],t[2*i+1]=n[i]>>8}function m(t,e){let r=0;for(let n=0;n<32;n++)r|=t[n]^e[n];return(1&r-1>>>8)-1}function w(t,e){const r=new Uint8Array(32),n=new Uint8Array(32);return v(r,t),v(n,e),m(r,n)}function _(t){const e=new Uint8Array(32);return v(e,t),1&e[0]}function b(t,e,r){for(let n=0;n<16;n++)t[n]=e[n]+r[n]}function E(t,e,r){for(let n=0;n<16;n++)t[n]=e[n]-r[n]}function I(t,e,r){let n,i,s=0,o=0,a=0,c=0,u=0,h=0,l=0,f=0,p=0,d=0,g=0,y=0,v=0,m=0,w=0,_=0,b=0,E=0,I=0,P=0,S=0,O=0,x=0,R=0,C=0,A=0,T=0,j=0,N=0,L=0,q=0,D=r[0],M=r[1],z=r[2],k=r[3],$=r[4],U=r[5],H=r[6],V=r[7],K=r[8],B=r[9],F=r[10],G=r[11],W=r[12],Q=r[13],Y=r[14],J=r[15];n=e[0],s+=n*D,o+=n*M,a+=n*z,c+=n*k,u+=n*$,h+=n*U,l+=n*H,f+=n*V,p+=n*K,d+=n*B,g+=n*F,y+=n*G,v+=n*W,m+=n*Q,w+=n*Y,_+=n*J,n=e[1],o+=n*D,a+=n*M,c+=n*z,u+=n*k,h+=n*$,l+=n*U,f+=n*H,p+=n*V,d+=n*K,g+=n*B,y+=n*F,v+=n*G,m+=n*W,w+=n*Q,_+=n*Y,b+=n*J,n=e[2],a+=n*D,c+=n*M,u+=n*z,h+=n*k,l+=n*$,f+=n*U,p+=n*H,d+=n*V,g+=n*K,y+=n*B,v+=n*F,m+=n*G,w+=n*W,_+=n*Q,b+=n*Y,E+=n*J,n=e[3],c+=n*D,u+=n*M,h+=n*z,l+=n*k,f+=n*$,p+=n*U,d+=n*H,g+=n*V,y+=n*K,v+=n*B,m+=n*F,w+=n*G,_+=n*W,b+=n*Q,E+=n*Y,I+=n*J,n=e[4],u+=n*D,h+=n*M,l+=n*z,f+=n*k,p+=n*$,d+=n*U,g+=n*H,y+=n*V,v+=n*K,m+=n*B,w+=n*F,_+=n*G,b+=n*W,E+=n*Q,I+=n*Y,P+=n*J,n=e[5],h+=n*D,l+=n*M,f+=n*z,p+=n*k,d+=n*$,g+=n*U,y+=n*H,v+=n*V,m+=n*K,w+=n*B,_+=n*F,b+=n*G,E+=n*W,I+=n*Q,P+=n*Y,S+=n*J,n=e[6],l+=n*D,f+=n*M,p+=n*z,d+=n*k,g+=n*$,y+=n*U,v+=n*H,m+=n*V,w+=n*K,_+=n*B,b+=n*F,E+=n*G,I+=n*W,P+=n*Q,S+=n*Y,O+=n*J,n=e[7],f+=n*D,p+=n*M,d+=n*z,g+=n*k,y+=n*$,v+=n*U,m+=n*H,w+=n*V,_+=n*K,b+=n*B,E+=n*F,I+=n*G,P+=n*W,S+=n*Q,O+=n*Y,x+=n*J,n=e[8],p+=n*D,d+=n*M,g+=n*z,y+=n*k,v+=n*$,m+=n*U,w+=n*H,_+=n*V,b+=n*K,E+=n*B,I+=n*F,P+=n*G,S+=n*W,O+=n*Q,x+=n*Y,R+=n*J,n=e[9],d+=n*D,g+=n*M,y+=n*z,v+=n*k,m+=n*$,w+=n*U,_+=n*H,b+=n*V,E+=n*K,I+=n*B,P+=n*F,S+=n*G,O+=n*W,x+=n*Q,R+=n*Y,C+=n*J,n=e[10],g+=n*D,y+=n*M,v+=n*z,m+=n*k,w+=n*$,_+=n*U,b+=n*H,E+=n*V,I+=n*K,P+=n*B,S+=n*F,O+=n*G,x+=n*W,R+=n*Q,C+=n*Y,A+=n*J,n=e[11],y+=n*D,v+=n*M,m+=n*z,w+=n*k,_+=n*$,b+=n*U,E+=n*H,I+=n*V,P+=n*K,S+=n*B,O+=n*F,x+=n*G,R+=n*W,C+=n*Q,A+=n*Y,T+=n*J,n=e[12],v+=n*D,m+=n*M,w+=n*z,_+=n*k,b+=n*$,E+=n*U,I+=n*H,P+=n*V,S+=n*K,O+=n*B,x+=n*F,R+=n*G,C+=n*W,A+=n*Q,T+=n*Y,j+=n*J,n=e[13],m+=n*D,w+=n*M,_+=n*z,b+=n*k,E+=n*$,I+=n*U,P+=n*H,S+=n*V,O+=n*K,x+=n*B,R+=n*F,C+=n*G,A+=n*W,T+=n*Q,j+=n*Y,N+=n*J,n=e[14],w+=n*D,_+=n*M,b+=n*z,E+=n*k,I+=n*$,P+=n*U,S+=n*H,O+=n*V,x+=n*K,R+=n*B,C+=n*F,A+=n*G,T+=n*W,j+=n*Q,N+=n*Y,L+=n*J,n=e[15],_+=n*D,b+=n*M,E+=n*z,I+=n*k,P+=n*$,S+=n*U,O+=n*H,x+=n*V,R+=n*K,C+=n*B,A+=n*F,T+=n*G,j+=n*W,N+=n*Q,L+=n*Y,q+=n*J,s+=38*b,o+=38*E,a+=38*I,c+=38*P,u+=38*S,h+=38*O,l+=38*x,f+=38*R,p+=38*C,d+=38*A,g+=38*T,y+=38*j,v+=38*N,m+=38*L,w+=38*q,i=1,n=s+i+65535,i=Math.floor(n/65536),s=n-65536*i,n=o+i+65535,i=Math.floor(n/65536),o=n-65536*i,n=a+i+65535,i=Math.floor(n/65536),a=n-65536*i,n=c+i+65535,i=Math.floor(n/65536),c=n-65536*i,n=u+i+65535,i=Math.floor(n/65536),u=n-65536*i,n=h+i+65535,i=Math.floor(n/65536),h=n-65536*i,n=l+i+65535,i=Math.floor(n/65536),l=n-65536*i,n=f+i+65535,i=Math.floor(n/65536),f=n-65536*i,n=p+i+65535,i=Math.floor(n/65536),p=n-65536*i,n=d+i+65535,i=Math.floor(n/65536),d=n-65536*i,n=g+i+65535,i=Math.floor(n/65536),g=n-65536*i,n=y+i+65535,i=Math.floor(n/65536),y=n-65536*i,n=v+i+65535,i=Math.floor(n/65536),v=n-65536*i,n=m+i+65535,i=Math.floor(n/65536),m=n-65536*i,n=w+i+65535,i=Math.floor(n/65536),w=n-65536*i,n=_+i+65535,i=Math.floor(n/65536),_=n-65536*i,s+=i-1+37*(i-1),i=1,n=s+i+65535,i=Math.floor(n/65536),s=n-65536*i,n=o+i+65535,i=Math.floor(n/65536),o=n-65536*i,n=a+i+65535,i=Math.floor(n/65536),a=n-65536*i,n=c+i+65535,i=Math.floor(n/65536),c=n-65536*i,n=u+i+65535,i=Math.floor(n/65536),u=n-65536*i,n=h+i+65535,i=Math.floor(n/65536),h=n-65536*i,n=l+i+65535,i=Math.floor(n/65536),l=n-65536*i,n=f+i+65535,i=Math.floor(n/65536),f=n-65536*i,n=p+i+65535,i=Math.floor(n/65536),p=n-65536*i,n=d+i+65535,i=Math.floor(n/65536),d=n-65536*i,n=g+i+65535,i=Math.floor(n/65536),g=n-65536*i,n=y+i+65535,i=Math.floor(n/65536),y=n-65536*i,n=v+i+65535,i=Math.floor(n/65536),v=n-65536*i,n=m+i+65535,i=Math.floor(n/65536),m=n-65536*i,n=w+i+65535,i=Math.floor(n/65536),w=n-65536*i,n=_+i+65535,i=Math.floor(n/65536),_=n-65536*i,s+=i-1+37*(i-1),t[0]=s,t[1]=o,t[2]=a,t[3]=c,t[4]=u,t[5]=h,t[6]=l,t[7]=f,t[8]=p,t[9]=d,t[10]=g,t[11]=y,t[12]=v,t[13]=m,t[14]=w,t[15]=_}function P(t,e){I(t,e,e)}function S(t,e){const r=i();let n;for(n=0;n<16;n++)r[n]=e[n];for(n=253;n>=0;n--)P(r,r),2!==n&&4!==n&&I(r,r,e);for(n=0;n<16;n++)t[n]=r[n]}function O(t,e){const r=i(),n=i(),s=i(),o=i(),a=i(),c=i(),u=i(),l=i(),f=i();E(r,t[1],t[0]),E(f,e[1],e[0]),I(r,r,f),b(n,t[0],t[1]),b(f,e[0],e[1]),I(n,n,f),I(s,t[3],e[3]),I(s,s,h),I(o,t[2],e[2]),b(o,o,o),E(a,n,r),E(c,o,s),b(u,o,s),b(l,n,r),I(t[0],a,c),I(t[1],l,u),I(t[2],u,c),I(t[3],a,l)}function x(t,e,r){for(let n=0;n<4;n++)y(t[n],e[n],r)}function R(t,e){const r=i(),n=i(),s=i();S(s,e[2]),I(r,e[0],s),I(n,e[1],s),v(t,n),t[31]^=_(r)<<7}function C(t,e,r){d(t[0],s),d(t[1],o),d(t[2],o),d(t[3],s);for(let n=255;n>=0;--n){const i=r[n/8|0]>>(7&n)&1;x(t,e,i),O(e,t),O(t,t),x(t,e,i)}}function A(t,e){const r=[i(),i(),i(),i()];d(r[0],l),d(r[1],f),d(r[2],o),I(r[3],l,f),C(t,r,e)}function T(e){if(e.length!==t.SEED_LENGTH)throw new Error(`ed25519: seed must be ${t.SEED_LENGTH} bytes`);const n=(0,r.hash)(e);n[0]&=248,n[31]&=127,n[31]|=64;const s=new Uint8Array(32),o=[i(),i(),i(),i()];A(o,n),R(s,o);const a=new Uint8Array(64);return a.set(e),a.set(s,32),{publicKey:s,secretKey:a}}t.generateKeyPairFromSeed=T,t.generateKeyPair=function(t){const r=(0,e.randomBytes)(32,t),i=T(r);return(0,n.wipe)(r),i},t.extractPublicKeyFromSecretKey=function(e){if(e.length!==t.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${t.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(e.subarray(32))};const j=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function N(t,e){let r,n,i,s;for(n=63;n>=32;--n){for(r=0,i=n-32,s=n-12;i<s;++i)e[i]+=r-16*e[n]*j[i-(n-32)],r=Math.floor((e[i]+128)/256),e[i]-=256*r;e[i]+=r,e[n]=0}for(r=0,i=0;i<32;i++)e[i]+=r-(e[31]>>4)*j[i],r=e[i]>>8,e[i]&=255;for(i=0;i<32;i++)e[i]-=r*j[i];for(n=0;n<32;n++)e[n+1]+=e[n]>>8,t[n]=255&e[n]}function L(t){const e=new Float64Array(64);for(let r=0;r<64;r++)e[r]=t[r];for(let r=0;r<64;r++)t[r]=0;N(t,e)}function q(t,e){const r=i(),n=i(),a=i(),c=i(),h=i(),l=i(),f=i();return d(t[2],o),function(t,e){for(let r=0;r<16;r++)t[r]=e[2*r]+(e[2*r+1]<<8);t[15]&=32767}(t[1],e),P(a,t[1]),I(c,a,u),E(a,a,t[2]),b(c,t[2],c),P(h,c),P(l,h),I(f,l,h),I(r,f,a),I(r,r,c),function(t,e){const r=i();let n;for(n=0;n<16;n++)r[n]=e[n];for(n=250;n>=0;n--)P(r,r),1!==n&&I(r,r,e);for(n=0;n<16;n++)t[n]=r[n]}(r,r),I(r,r,a),I(r,r,c),I(r,r,c),I(t[0],r,c),P(n,t[0]),I(n,n,c),w(n,a)&&I(t[0],t[0],p),P(n,t[0]),I(n,n,c),w(n,a)?-1:(_(t[0])===e[31]>>7&&E(t[0],s,t[0]),I(t[3],t[0],t[1]),0)}t.sign=function(t,e){const n=new Float64Array(64),s=[i(),i(),i(),i()],o=(0,r.hash)(t.subarray(0,32));o[0]&=248,o[31]&=127,o[31]|=64;const a=new Uint8Array(64);a.set(o.subarray(32),32);const c=new r.SHA512;c.update(a.subarray(32)),c.update(e);const u=c.digest();c.clean(),L(u),A(s,u),R(a,s),c.reset(),c.update(a.subarray(0,32)),c.update(t.subarray(32)),c.update(e);const h=c.digest();L(h);for(let r=0;r<32;r++)n[r]=u[r];for(let r=0;r<32;r++)for(let t=0;t<32;t++)n[r+t]+=h[r]*o[t];return N(a.subarray(32),n),a},t.verify=function(e,n,s){const o=new Uint8Array(32),a=[i(),i(),i(),i()],c=[i(),i(),i(),i()];if(s.length!==t.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${t.SIGNATURE_LENGTH} bytes`);if(q(c,e))return!1;const u=new r.SHA512;u.update(s.subarray(0,32)),u.update(e),u.update(n);const h=u.digest();return L(h),C(a,c,h),A(c,s.subarray(32)),O(a,c),R(o,a),!m(s,o)},t.convertPublicKeyToX25519=function(t){let e=[i(),i(),i(),i()];if(q(e,t))throw new Error("Ed25519: invalid public key");let r=i(),n=i(),s=e[1];b(r,o,s),E(n,o,s),S(n,n),I(r,r,n);let a=new Uint8Array(32);return v(a,r),a},t.convertSecretKeyToX25519=function(t){const e=(0,r.hash)(t.subarray(0,32));e[0]&=248,e[31]&=127,e[31]|=64;const i=new Uint8Array(e.subarray(0,32));return(0,n.wipe)(e),i}}(rr);const ir=".",sr="base64url",or="utf8",ar="utf8",cr=":",ur="did",hr="key",lr="base58btc",fr="z",pr="K36";function dr(t){return h(u(er(t),or),sr)}function gr(t){const e=u(pr,lr),r=fr+h(l([e,t]),lr);return[ur,hr,r].join(cr)}function yr(t=c.randomBytes(32)){return rr.generateKeyPairFromSeed(t)}async function vr(t,e,r,n,s=i.fromMiliseconds(Date.now())){const o={alg:"EdDSA",typ:"JWT"},a={iss:gr(n.publicKey),sub:t,aud:e,iat:s,exp:s+r},c=u([dr((l={header:o,payload:a}).header),dr(l.payload)].join(ir),ar);var l;return function(t){return[dr(t.header),dr(t.payload),(e=t.signature,h(e,sr))].join(ir);var e}({header:o,payload:a,signature:rr.sign(n.secretKey,c)})}const mr="INTERNAL_ERROR",wr="SERVER_ERROR",_r=[-32700,-32600,-32601,-32602,-32603],br={PARSE_ERROR:{code:-32700,message:"Parse error"},INVALID_REQUEST:{code:-32600,message:"Invalid Request"},METHOD_NOT_FOUND:{code:-32601,message:"Method not found"},INVALID_PARAMS:{code:-32602,message:"Invalid params"},[mr]:{code:-32603,message:"Internal error"},[wr]:{code:-32e3,message:"Server error"}},Er=wr;function Ir(t){return Object.keys(br).includes(t)?br[t]:br[Er]}function Pr(t,e,r){return t.message.includes("getaddrinfo ENOTFOUND")||t.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${e}`):t}var Sr={},Or=function(t,e){return Or=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},Or(t,e)},xr=function(){return xr=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},xr.apply(this,arguments)};
/*! *****************************************************************************
            Copyright (c) Microsoft Corporation.

            Permission to use, copy, modify, and/or distribute this software for any
            purpose with or without fee is hereby granted.

            THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
            REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
            AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
            INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
            LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
            OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
            PERFORMANCE OF THIS SOFTWARE.
            ***************************************************************************** */function Rr(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Cr(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,i,s=r.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(n=s.next()).done;)o.push(n.value)}catch(a){i={error:a}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}return o}function Ar(t){return this instanceof Ar?(this.v=t,this):new Ar(t)}const Tr=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return xr},__asyncDelegator:function(t){var e,r;return e={},n("next"),n("throw",(function(t){throw t})),n("return"),e[Symbol.iterator]=function(){return this},e;function n(n,i){e[n]=t[n]?function(e){return(r=!r)?{value:Ar(t[n](e)),done:"return"===n}:i?i(e):e}:i}},__asyncGenerator:function(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(t,e||[]),s=[];return n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n;function o(t){i[t]&&(n[t]=function(e){return new Promise((function(r,n){s.push([t,e,r,n])>1||a(t,e)}))})}function a(t,e){try{(r=i[t](e)).value instanceof Ar?Promise.resolve(r.value.v).then(c,u):h(s[0][2],r)}catch(n){h(s[0][3],n)}var r}function c(t){a("next",t)}function u(t){a("throw",t)}function h(t,e){t(e),s.shift(),s.length&&a(s[0][0],s[0][1])}},__asyncValues:function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,r=t[Symbol.asyncIterator];return r?r.call(t):(t=Rr(t),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(r){e[r]=t[r]&&function(e){return new Promise((function(n,i){!function(t,e,r,n){Promise.resolve(n).then((function(e){t({value:e,done:r})}),e)}(n,i,(e=t[r](e)).done,e.value)}))}}},__await:Ar,__awaiter:function(t,e,r,n){return new(r||(r=Promise))((function(i,s){function o(t){try{c(n.next(t))}catch(e){s(e)}}function a(t){try{c(n.throw(t))}catch(e){s(e)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(o,a)}c((n=n.apply(t,e||[])).next())}))},__classPrivateFieldGet:function(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)},__classPrivateFieldSet:function(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r},__createBinding:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]},__decorate:function(t,e,r,n){var i,s=arguments.length,o=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(o=(s<3?i(o):s>3?i(e,r,o):i(e,r))||o);return s>3&&o&&Object.defineProperty(e,r,o),o},__exportStar:function(t,e){for(var r in t)"default"===r||e.hasOwnProperty(r)||(e[r]=t[r])},__extends:function(t,e){function r(){this.constructor=t}Or(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},__generator:function(t,e){var r,n,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(i=2&s[0]?n.return:s[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,s[1])).done)return i;switch(n=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(a){s=[6,a],n=0}finally{r=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}},__importDefault:function(t){return t&&t.__esModule?t:{default:t}},__importStar:function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e},__makeTemplateObject:function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t},__metadata:function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},__param:function(t,e){return function(r,n){e(r,n,t)}},__read:Cr,__rest:function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]])}return r},__spread:function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Cr(arguments[e]));return t},__spreadArrays:function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),i=0;for(e=0;e<r;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,i++)n[i]=s[o];return n},__values:Rr},Symbol.toStringTag,{value:"Module"})),jr=r(Tr);var Nr,Lr,qr={},Dr={};function Mr(t=3){return Date.now()*Math.pow(10,t)+Math.floor(Math.random()*Math.pow(10,t))}function zr(t=6){return BigInt(Mr(t))}function kr(t,e,r){return{id:r||Mr(),jsonrpc:"2.0",method:t,params:e}}function $r(t,e){return{id:t,jsonrpc:"2.0",result:e}}function Ur(t,e,r){return{id:t,jsonrpc:"2.0",error:Hr(e,r)}}function Hr(t,e){return void 0===t?Ir(mr):("string"==typeof t&&(t=Object.assign(Object.assign({},Ir(wr)),{message:t})),void 0!==e&&(t.data=e),r=t.code,_r.includes(r)&&(t=function(t){const e=Object.values(br).find((e=>e.code===t));return e||br[Er]}(t.code)),t);var r}!function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=jr;e.__exportStar(function(){if(Nr)return qr;function t(){return(null==n?void 0:n.crypto)||(null==n?void 0:n.msCrypto)||{}}function e(){const e=t();return e.subtle||e.webkitSubtle}return Nr=1,Object.defineProperty(qr,"__esModule",{value:!0}),qr.isBrowserCryptoAvailable=qr.getSubtleCrypto=qr.getBrowerCrypto=void 0,qr.getBrowerCrypto=t,qr.getSubtleCrypto=e,qr.isBrowserCryptoAvailable=function(){return!!t()&&!!e()},qr}(),t),e.__exportStar(function(){if(Lr)return Dr;function t(){return"undefined"==typeof document&&"undefined"!=typeof navigator&&"ReactNative"===navigator.product}function e(){return void 0!==f&&void 0!==f.versions&&void 0!==f.versions.node}return Lr=1,Object.defineProperty(Dr,"__esModule",{value:!0}),Dr.isBrowser=Dr.isNode=Dr.isReactNative=void 0,Dr.isReactNative=t,Dr.isNode=e,Dr.isBrowser=function(){return!t()&&!e()},Dr}(),t)}(Sr);class Vr{}class Kr extends Vr{constructor(){super()}}class Br extends Kr{constructor(t){super()}}function Fr(t,e){const r=function(t){const e=t.match(new RegExp(/^\w+:/,"gi"));if(e&&e.length)return e[0]}(t);return void 0!==r&&new RegExp(e).test(r)}function Gr(t){return Fr(t,"^https?:")}function Wr(t){return Fr(t,"^wss?:")}function Qr(t){return new RegExp("wss?://localhost(:d{2,5})?").test(t)}function Yr(t){return"object"==typeof t&&"id"in t&&"jsonrpc"in t&&"2.0"===t.jsonrpc}function Jr(t){return Yr(t)&&"method"in t}function Zr(t){return Yr(t)&&(Xr(t)||tn(t))}function Xr(t){return"result"in t}function tn(t){return"error"in t}class en extends Br{constructor(t){super(t),this.events=new s.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(t),this.connection.connected&&this.registerEventListeners()}async connect(t=this.connection){await this.open(t)}async disconnect(){await this.close()}on(t,e){this.events.on(t,e)}once(t,e){this.events.once(t,e)}off(t,e){this.events.off(t,e)}removeListener(t,e){this.events.removeListener(t,e)}async request(t,e){return this.requestStrict(kr(t.method,t.params||[],t.id||zr().toString()),e)}async requestStrict(t,e){return new Promise((async(r,n)=>{if(!this.connection.connected)try{await this.open()}catch(i){n(i)}this.events.on(`${t.id}`,(t=>{tn(t)?n(t.error):r(t.result)}));try{await this.connection.send(t,e)}catch(i){n(i)}}))}setConnection(t=this.connection){return t}onPayload(t){this.events.emit("payload",t),Zr(t)?this.events.emit(`${t.id}`,t):this.events.emit("message",{type:t.method,data:t.params})}onClose(t){t&&3e3===t.code&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${t.code} ${t.reason?`(${t.reason})`:""}`)),this.events.emit("disconnect")}async open(t=this.connection){this.connection===t&&this.connection.connected||(this.connection.connected&&this.close(),"string"==typeof t&&(await this.connection.open(t),t=this.connection),this.connection=this.setConnection(t),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",(t=>this.onPayload(t))),this.connection.on("close",(t=>this.onClose(t))),this.connection.on("error",(t=>this.events.emit("error",t))),this.connection.on("register_error",(t=>this.onClose())),this.hasRegisteredEventListeners=!0)}}const rn=t=>t.split("?")[0],nn="undefined"!=typeof WebSocket?WebSocket:void 0!==p&&void 0!==p.WebSocket?p.WebSocket:"undefined"!=typeof window&&void 0!==window.WebSocket?window.WebSocket:"undefined"!=typeof self&&void 0!==self.WebSocket?self.WebSocket:require("ws");class sn{constructor(t){if(this.url=t,this.events=new s.EventEmitter,this.registering=!1,!Wr(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);this.url=t}get connected(){return void 0!==this.socket}get connecting(){return this.registering}on(t,e){this.events.on(t,e)}once(t,e){this.events.once(t,e)}off(t,e){this.events.off(t,e)}removeListener(t,e){this.events.removeListener(t,e)}async open(t=this.url){await this.register(t)}async close(){return new Promise(((t,e)=>{void 0!==this.socket?(this.socket.onclose=e=>{this.onClose(e),t()},this.socket.close()):e(new Error("Connection already closed"))}))}async send(t,e){void 0===this.socket&&(this.socket=await this.register());try{this.socket.send(er(t))}catch(r){this.onError(t.id,r)}}register(t=this.url){if(!Wr(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise(((t,e)=>{this.events.once("register_error",(t=>{this.resetMaxListeners(),e(t)})),this.events.once("open",(()=>{if(this.resetMaxListeners(),void 0===this.socket)return e(new Error("WebSocket connection is missing or invalid"));t(this.socket)}))}))}return this.url=t,this.registering=!0,new Promise(((e,r)=>{const n=Sr.isReactNative()?void 0:{rejectUnauthorized:!Qr(t)},i=new nn(t,[],n);"undefined"!=typeof WebSocket||void 0!==p&&void 0!==p.WebSocket||"undefined"!=typeof window&&void 0!==window.WebSocket||"undefined"!=typeof self&&void 0!==self.WebSocket?i.onerror=t=>{const e=t;r(this.emitError(e.error))}:i.on("error",(t=>{r(this.emitError(t))})),i.onopen=()=>{this.onOpen(i),e(i)}}))}onOpen(t){t.onmessage=t=>this.onPayload(t),t.onclose=t=>this.onClose(t),this.socket=t,this.registering=!1,this.events.emit("open")}onClose(t){this.socket=void 0,this.registering=!1,this.events.emit("close",t)}onPayload(t){if(void 0===t.data)return;const e="string"==typeof t.data?tr(t.data):t.data;this.events.emit("payload",e)}onError(t,e){const r=this.parseError(e),n=Ur(t,r.message||r.toString());this.events.emit("payload",n)}parseError(t,e=this.url){return Pr(t,rn(e),"WS")}resetMaxListeners(){this.events.getMaxListeners()>10&&this.events.setMaxListeners(10)}emitError(t){const e=this.parseError(new Error((null==t?void 0:t.message)||`WebSocket connection failed for host: ${rn(this.url)}`));return this.events.emit("register_error",e),e}}var on={exports:{}};!function(t,e){var r="__lodash_hash_undefined__",i=1,s=2,o=9007199254740991,a="[object Arguments]",c="[object Array]",u="[object AsyncFunction]",h="[object Boolean]",l="[object Date]",f="[object Error]",p="[object Function]",d="[object GeneratorFunction]",g="[object Map]",y="[object Number]",v="[object Null]",m="[object Object]",w="[object Promise]",_="[object Proxy]",b="[object RegExp]",E="[object Set]",I="[object String]",P="[object Symbol]",S="[object Undefined]",O="[object WeakMap]",x="[object ArrayBuffer]",R="[object DataView]",C=/^\[object .+?Constructor\]$/,A=/^(?:0|[1-9]\d*)$/,T={};T["[object Float32Array]"]=T["[object Float64Array]"]=T["[object Int8Array]"]=T["[object Int16Array]"]=T["[object Int32Array]"]=T["[object Uint8Array]"]=T["[object Uint8ClampedArray]"]=T["[object Uint16Array]"]=T["[object Uint32Array]"]=!0,T[a]=T[c]=T[x]=T[h]=T[R]=T[l]=T[f]=T[p]=T[g]=T[y]=T[m]=T[b]=T[E]=T[I]=T[O]=!1;var j="object"==typeof n&&n&&n.Object===Object&&n,N="object"==typeof self&&self&&self.Object===Object&&self,L=j||N||Function("return this")(),q=e&&!e.nodeType&&e,D=q&&t&&!t.nodeType&&t,M=D&&D.exports===q,z=M&&j.process,k=function(){try{return z&&z.binding&&z.binding("util")}catch(t){}}(),$=k&&k.isTypedArray;function U(t,e){for(var r=-1,n=null==t?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1}function H(t){var e=-1,r=Array(t.size);return t.forEach((function(t,n){r[++e]=[n,t]})),r}function V(t){var e=-1,r=Array(t.size);return t.forEach((function(t){r[++e]=t})),r}var K,B,F,G=Array.prototype,W=Function.prototype,Q=Object.prototype,Y=L["__core-js_shared__"],J=W.toString,Z=Q.hasOwnProperty,X=(K=/[^.]+$/.exec(Y&&Y.keys&&Y.keys.IE_PROTO||""))?"Symbol(src)_1."+K:"",tt=Q.toString,et=RegExp("^"+J.call(Z).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),rt=M?L.Buffer:void 0,nt=L.Symbol,it=L.Uint8Array,st=Q.propertyIsEnumerable,ot=G.splice,at=nt?nt.toStringTag:void 0,ct=Object.getOwnPropertySymbols,ut=rt?rt.isBuffer:void 0,ht=(B=Object.keys,F=Object,function(t){return B(F(t))}),lt=kt(L,"DataView"),ft=kt(L,"Map"),pt=kt(L,"Promise"),dt=kt(L,"Set"),gt=kt(L,"WeakMap"),yt=kt(Object,"create"),vt=Vt(lt),mt=Vt(ft),wt=Vt(pt),_t=Vt(dt),bt=Vt(gt),Et=nt?nt.prototype:void 0,It=Et?Et.valueOf:void 0;function Pt(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function St(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function Ot(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function xt(t){var e=-1,r=null==t?0:t.length;for(this.__data__=new Ot;++e<r;)this.add(t[e])}function Rt(t){var e=this.__data__=new St(t);this.size=e.size}function Ct(t,e){var r=Ft(t),n=!r&&Bt(t),i=!r&&!n&&Gt(t),s=!r&&!n&&!i&&Zt(t),o=r||n||i||s,a=o?function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}(t.length,String):[],c=a.length;for(var u in t)!e&&!Z.call(t,u)||o&&("length"==u||i&&("offset"==u||"parent"==u)||s&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||Ht(u,c))||a.push(u);return a}function At(t,e){for(var r=t.length;r--;)if(Kt(t[r][0],e))return r;return-1}function Tt(t){return null==t?void 0===t?S:v:at&&at in Object(t)?function(t){var e=Z.call(t,at),r=t[at];try{t[at]=void 0;var n=!0}catch(s){}var i=tt.call(t);return n&&(e?t[at]=r:delete t[at]),i}(t):function(t){return tt.call(t)}(t)}function jt(t){return Jt(t)&&Tt(t)==a}function Nt(t,e,r,n,o){return t===e||(null==t||null==e||!Jt(t)&&!Jt(e)?t!=t&&e!=e:function(t,e,r,n,o,u){var p=Ft(t),d=Ft(e),v=p?c:Ut(t),w=d?c:Ut(e),_=(v=v==a?m:v)==m,S=(w=w==a?m:w)==m,O=v==w;if(O&&Gt(t)){if(!Gt(e))return!1;p=!0,_=!1}if(O&&!_)return u||(u=new Rt),p||Zt(t)?Dt(t,e,r,n,o,u):function(t,e,r,n,o,a,c){switch(r){case R:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case x:return!(t.byteLength!=e.byteLength||!a(new it(t),new it(e)));case h:case l:case y:return Kt(+t,+e);case f:return t.name==e.name&&t.message==e.message;case b:case I:return t==e+"";case g:var u=H;case E:var p=n&i;if(u||(u=V),t.size!=e.size&&!p)return!1;var d=c.get(t);if(d)return d==e;n|=s,c.set(t,e);var v=Dt(u(t),u(e),n,o,a,c);return c.delete(t),v;case P:if(It)return It.call(t)==It.call(e)}return!1}(t,e,v,r,n,o,u);if(!(r&i)){var C=_&&Z.call(t,"__wrapped__"),A=S&&Z.call(e,"__wrapped__");if(C||A){var T=C?t.value():t,j=A?e.value():e;return u||(u=new Rt),o(T,j,r,n,u)}}return!!O&&(u||(u=new Rt),function(t,e,r,n,s,o){var a=r&i,c=Mt(t),u=c.length,h=Mt(e),l=h.length;if(u!=l&&!a)return!1;for(var f=u;f--;){var p=c[f];if(!(a?p in e:Z.call(e,p)))return!1}var d=o.get(t);if(d&&o.get(e))return d==e;var g=!0;o.set(t,e),o.set(e,t);for(var y=a;++f<u;){var v=t[p=c[f]],m=e[p];if(n)var w=a?n(m,v,p,e,t,o):n(v,m,p,t,e,o);if(!(void 0===w?v===m||s(v,m,r,n,o):w)){g=!1;break}y||(y="constructor"==p)}if(g&&!y){var _=t.constructor,b=e.constructor;_==b||!("constructor"in t)||!("constructor"in e)||"function"==typeof _&&_ instanceof _&&"function"==typeof b&&b instanceof b||(g=!1)}return o.delete(t),o.delete(e),g}(t,e,r,n,o,u))}(t,e,r,n,Nt,o))}function Lt(t){return!(!Yt(t)||function(t){return!!X&&X in t}(t))&&(Wt(t)?et:C).test(Vt(t))}function qt(t){if(r=(e=t)&&e.constructor,n="function"==typeof r&&r.prototype||Q,e!==n)return ht(t);var e,r,n,i=[];for(var s in Object(t))Z.call(t,s)&&"constructor"!=s&&i.push(s);return i}function Dt(t,e,r,n,o,a){var c=r&i,u=t.length,h=e.length;if(u!=h&&!(c&&h>u))return!1;var l=a.get(t);if(l&&a.get(e))return l==e;var f=-1,p=!0,d=r&s?new xt:void 0;for(a.set(t,e),a.set(e,t);++f<u;){var g=t[f],y=e[f];if(n)var v=c?n(y,g,f,e,t,a):n(g,y,f,t,e,a);if(void 0!==v){if(v)continue;p=!1;break}if(d){if(!U(e,(function(t,e){if(i=e,!d.has(i)&&(g===t||o(g,t,r,n,a)))return d.push(e);var i}))){p=!1;break}}else if(g!==y&&!o(g,y,r,n,a)){p=!1;break}}return a.delete(t),a.delete(e),p}function Mt(t){return function(t,e,r){var n=e(t);return Ft(t)?n:function(t,e){for(var r=-1,n=e.length,i=t.length;++r<n;)t[i+r]=e[r];return t}(n,r(t))}(t,Xt,$t)}function zt(t,e){var r,n,i=t.__data__;return("string"==(n=typeof(r=e))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?i["string"==typeof e?"string":"hash"]:i.map}function kt(t,e){var r=function(t,e){return null==t?void 0:t[e]}(t,e);return Lt(r)?r:void 0}Pt.prototype.clear=function(){this.__data__=yt?yt(null):{},this.size=0},Pt.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},Pt.prototype.get=function(t){var e=this.__data__;if(yt){var n=e[t];return n===r?void 0:n}return Z.call(e,t)?e[t]:void 0},Pt.prototype.has=function(t){var e=this.__data__;return yt?void 0!==e[t]:Z.call(e,t)},Pt.prototype.set=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=yt&&void 0===e?r:e,this},St.prototype.clear=function(){this.__data__=[],this.size=0},St.prototype.delete=function(t){var e=this.__data__,r=At(e,t);return!(r<0||(r==e.length-1?e.pop():ot.call(e,r,1),--this.size,0))},St.prototype.get=function(t){var e=this.__data__,r=At(e,t);return r<0?void 0:e[r][1]},St.prototype.has=function(t){return At(this.__data__,t)>-1},St.prototype.set=function(t,e){var r=this.__data__,n=At(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this},Ot.prototype.clear=function(){this.size=0,this.__data__={hash:new Pt,map:new(ft||St),string:new Pt}},Ot.prototype.delete=function(t){var e=zt(this,t).delete(t);return this.size-=e?1:0,e},Ot.prototype.get=function(t){return zt(this,t).get(t)},Ot.prototype.has=function(t){return zt(this,t).has(t)},Ot.prototype.set=function(t,e){var r=zt(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this},xt.prototype.add=xt.prototype.push=function(t){return this.__data__.set(t,r),this},xt.prototype.has=function(t){return this.__data__.has(t)},Rt.prototype.clear=function(){this.__data__=new St,this.size=0},Rt.prototype.delete=function(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r},Rt.prototype.get=function(t){return this.__data__.get(t)},Rt.prototype.has=function(t){return this.__data__.has(t)},Rt.prototype.set=function(t,e){var r=this.__data__;if(r instanceof St){var n=r.__data__;if(!ft||n.length<199)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new Ot(n)}return r.set(t,e),this.size=r.size,this};var $t=ct?function(t){return null==t?[]:(t=Object(t),function(t,e){for(var r=-1,n=null==t?0:t.length,i=0,s=[];++r<n;){var o=t[r];e(o,r,t)&&(s[i++]=o)}return s}(ct(t),(function(e){return st.call(t,e)})))}:function(){return[]},Ut=Tt;function Ht(t,e){return!!(e=null==e?o:e)&&("number"==typeof t||A.test(t))&&t>-1&&t%1==0&&t<e}function Vt(t){if(null!=t){try{return J.call(t)}catch(e){}try{return t+""}catch(e){}}return""}function Kt(t,e){return t===e||t!=t&&e!=e}(lt&&Ut(new lt(new ArrayBuffer(1)))!=R||ft&&Ut(new ft)!=g||pt&&Ut(pt.resolve())!=w||dt&&Ut(new dt)!=E||gt&&Ut(new gt)!=O)&&(Ut=function(t){var e=Tt(t),r=e==m?t.constructor:void 0,n=r?Vt(r):"";if(n)switch(n){case vt:return R;case mt:return g;case wt:return w;case _t:return E;case bt:return O}return e});var Bt=jt(function(){return arguments}())?jt:function(t){return Jt(t)&&Z.call(t,"callee")&&!st.call(t,"callee")},Ft=Array.isArray,Gt=ut||function(){return!1};function Wt(t){if(!Yt(t))return!1;var e=Tt(t);return e==p||e==d||e==u||e==_}function Qt(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=o}function Yt(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function Jt(t){return null!=t&&"object"==typeof t}var Zt=$?function(t){return function(e){return t(e)}}($):function(t){return Jt(t)&&Qt(t.length)&&!!T[Tt(t)]};function Xt(t){return null!=(e=t)&&Qt(e.length)&&!Wt(e)?Ct(t):qt(t);var e}t.exports=function(t,e){return Nt(t,e)}}(on,on.exports);const an=d(on.exports);var cn=function(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var s=t.charAt(i),o=s.charCodeAt(0);if(255!==r[o])throw new TypeError(s+" is ambiguous");r[o]=i}var a=t.length,c=t.charAt(0),u=Math.log(a)/Math.log(256),h=Math.log(256)/Math.log(a);function l(t){if("string"!=typeof t)throw new TypeError("Expected String");if(0===t.length)return new Uint8Array;var e=0;if(" "!==t[e]){for(var n=0,i=0;t[e]===c;)n++,e++;for(var s=(t.length-e)*u+1>>>0,o=new Uint8Array(s);t[e];){var h=r[t.charCodeAt(e)];if(255===h)return;for(var l=0,f=s-1;(0!==h||l<i)&&-1!==f;f--,l++)h+=a*o[f]>>>0,o[f]=h%256>>>0,h=h/256>>>0;if(0!==h)throw new Error("Non-zero carry");i=l,e++}if(" "!==t[e]){for(var p=s-i;p!==s&&0===o[p];)p++;for(var d=new Uint8Array(n+(s-p)),g=n;p!==s;)d[g++]=o[p++];return d}}}return{encode:function(e){if(e instanceof Uint8Array||(ArrayBuffer.isView(e)?e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength):Array.isArray(e)&&(e=Uint8Array.from(e))),!(e instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===e.length)return"";for(var r=0,n=0,i=0,s=e.length;i!==s&&0===e[i];)i++,r++;for(var o=(s-i)*h+1>>>0,u=new Uint8Array(o);i!==s;){for(var l=e[i],f=0,p=o-1;(0!==l||f<n)&&-1!==p;p--,f++)l+=256*u[p]>>>0,u[p]=l%a>>>0,l=l/a>>>0;if(0!==l)throw new Error("Non-zero carry");n=f,i++}for(var d=o-n;d!==o&&0===u[d];)d++;for(var g=c.repeat(r);d<o;++d)g+=t.charAt(u[d]);return g},decodeUnsafe:l,decode:function(t){var r=l(t);if(r)return r;throw new Error(`Non-${e} character`)}}},un=cn;const hn=t=>{if(t instanceof Uint8Array&&"Uint8Array"===t.constructor.name)return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")};class ln{constructor(t,e,r){this.name=t,this.prefix=e,this.baseEncode=r}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class fn{constructor(t,e,r){if(this.name=t,this.prefix=e,void 0===e.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=e.codePointAt(0),this.baseDecode=r}decode(t){if("string"==typeof t){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(t){return dn(this,t)}}class pn{constructor(t){this.decoders=t}or(t){return dn(this,t)}decode(t){const e=t[0],r=this.decoders[e];if(r)return r.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const dn=(t,e)=>new pn({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class gn{constructor(t,e,r,n){this.name=t,this.prefix=e,this.baseEncode=r,this.baseDecode=n,this.encoder=new ln(t,e,r),this.decoder=new fn(t,e,n)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const yn=({name:t,prefix:e,encode:r,decode:n})=>new gn(t,e,r,n),vn=({prefix:t,name:e,alphabet:r})=>{const{encode:n,decode:i}=un(r,e);return yn({prefix:t,name:e,encode:n,decode:t=>hn(i(t))})},mn=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>yn({prefix:e,name:t,encode:t=>((t,e,r)=>{const n="="===e[e.length-1],i=(1<<r)-1;let s="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>r;)o-=r,s+=e[i&a>>o];if(o&&(s+=e[i&a<<r-o]),n)for(;s.length*r&7;)s+="=";return s})(t,n,r),decode:e=>((t,e,r,n)=>{const i={};for(let h=0;h<e.length;++h)i[e[h]]=h;let s=t.length;for(;"="===t[s-1];)--s;const o=new Uint8Array(s*r/8|0);let a=0,c=0,u=0;for(let h=0;h<s;++h){const e=i[t[h]];if(void 0===e)throw new SyntaxError(`Non-${n} character`);c=c<<r|e,a+=r,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(e,n,r,t)}),wn=yn({prefix:"\0",name:"identity",encode:t=>(t=>(new TextDecoder).decode(t))(t),decode:t=>(t=>(new TextEncoder).encode(t))(t)});var _n=Object.freeze({__proto__:null,identity:wn});const bn=mn({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var En=Object.freeze({__proto__:null,base2:bn});const In=mn({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Pn=Object.freeze({__proto__:null,base8:In});const Sn=vn({prefix:"9",name:"base10",alphabet:"0123456789"});var On=Object.freeze({__proto__:null,base10:Sn});const xn=mn({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Rn=mn({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Cn=Object.freeze({__proto__:null,base16:xn,base16upper:Rn});const An=mn({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Tn=mn({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),jn=mn({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Nn=mn({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Ln=mn({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),qn=mn({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Dn=mn({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Mn=mn({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),zn=mn({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var kn=Object.freeze({__proto__:null,base32:An,base32upper:Tn,base32pad:jn,base32padupper:Nn,base32hex:Ln,base32hexupper:qn,base32hexpad:Dn,base32hexpadupper:Mn,base32z:zn});const $n=vn({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Un=vn({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Hn=Object.freeze({__proto__:null,base36:$n,base36upper:Un});const Vn=vn({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Kn=vn({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Bn=Object.freeze({__proto__:null,base58btc:Vn,base58flickr:Kn});const Fn=mn({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Gn=mn({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Wn=mn({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Qn=mn({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Yn=Object.freeze({__proto__:null,base64:Fn,base64pad:Gn,base64url:Wn,base64urlpad:Qn});const Jn=Array.from(""),Zn=Jn.reduce(((t,e,r)=>(t[r]=e,t)),[]),Xn=Jn.reduce(((t,e,r)=>(t[e.codePointAt(0)]=r,t)),[]),ti=yn({prefix:"",name:"base256emoji",encode:function(t){return t.reduce(((t,e)=>t+=Zn[e]),"")},decode:function(t){const e=[];for(const r of t){const t=Xn[r.codePointAt(0)];if(void 0===t)throw new Error(`Non-base256emoji character: ${r}`);e.push(t)}return new Uint8Array(e)}});var ei=Object.freeze({__proto__:null,base256emoji:ti}),ri=function t(e,r,n){r=r||[];for(var i=n=n||0;e>=si;)r[n++]=255&e|ni,e/=128;for(;e&ii;)r[n++]=255&e|ni,e>>>=7;return r[n]=0|e,t.bytes=n-i+1,r},ni=128,ii=-128,si=Math.pow(2,31),oi=function t(e,r){var n,i=0,s=0,o=r=r||0,a=e.length;do{if(o>=a)throw t.bytes=0,new RangeError("Could not decode varint");n=e[o++],i+=s<28?(n&ci)<<s:(n&ci)*Math.pow(2,s),s+=7}while(n>=ai);return t.bytes=o-r,i},ai=128,ci=127,ui=Math.pow(2,7),hi=Math.pow(2,14),li=Math.pow(2,21),fi=Math.pow(2,28),pi=Math.pow(2,35),di=Math.pow(2,42),gi=Math.pow(2,49),yi=Math.pow(2,56),vi=Math.pow(2,63),mi={encode:ri,decode:oi,encodingLength:function(t){return t<ui?1:t<hi?2:t<li?3:t<fi?4:t<pi?5:t<di?6:t<gi?7:t<yi?8:t<vi?9:10}};const wi=(t,e,r=0)=>(mi.encode(t,e,r),e),_i=t=>mi.encodingLength(t),bi=(t,e)=>{const r=e.byteLength,n=_i(t),i=n+_i(r),s=new Uint8Array(i+r);return wi(t,s,0),wi(r,s,n),s.set(e,i),new Ei(t,r,e,s)};class Ei{constructor(t,e,r,n){this.code=t,this.size=e,this.digest=r,this.bytes=n}}const Ii=({name:t,code:e,encode:r})=>new Pi(t,e,r);class Pi{constructor(t,e,r){this.name=t,this.code=e,this.encode=r}digest(t){if(t instanceof Uint8Array){const e=this.encode(t);return e instanceof Uint8Array?bi(this.code,e):e.then((t=>bi(this.code,t)))}throw Error("Unknown type, must be binary type")}}const Si=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),Oi=Ii({name:"sha2-256",code:18,encode:Si("SHA-256")}),xi=Ii({name:"sha2-512",code:19,encode:Si("SHA-512")});Object.freeze({__proto__:null,sha256:Oi,sha512:xi});const Ri=hn,Ci={code:0,name:"identity",encode:Ri,digest:t=>bi(0,Ri(t))};Object.freeze({__proto__:null,identity:Ci}),new TextEncoder,new TextDecoder;const Ai={..._n,...En,...Pn,...On,...Cn,...kn,...Hn,...Bn,...Yn,...ei};function Ti(t){return null!=globalThis.Buffer?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function ji(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}const Ni=ji("utf8","u",(t=>"u"+new TextDecoder("utf8").decode(t)),(t=>(new TextEncoder).encode(t.substring(1)))),Li=ji("ascii","a",(t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e}),(t=>{const e=function(t=0){return null!=globalThis.Buffer&&null!=globalThis.Buffer.allocUnsafe?Ti(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}((t=t.substring(1)).length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e})),qi={utf8:Ni,"utf-8":Ni,hex:Ai.base16,latin1:Li,ascii:Li,binary:Li,...Ai},Di="core",Mi=`wc@2:${Di}:`,zi="error",ki={database:":memory:"},$i="client_ed25519_seed",Ui=i.ONE_DAY,Hi=i.SIX_HOURS,Vi="wss://relay.walletconnect.com",Ki="wss://relay.walletconnect.org",Bi="relayer_message",Fi="relayer_message_ack",Gi="relayer_connect",Wi="relayer_disconnect",Qi="relayer_error",Yi="relayer_connection_stalled",Ji="relayer_publish",Zi="payload",Xi="connect",ts="disconnect",es="error",rs=i.ONE_SECOND,ns="subscription_created",is="subscription_deleted",ss="subscription_sync",os="subscription_resubscribed",as=1e3*i.FIVE_SECONDS,cs={wc_pairingDelete:{req:{ttl:i.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:i.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:i.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:i.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:i.ONE_DAY,prompt:!1,tag:0},res:{ttl:i.ONE_DAY,prompt:!1,tag:0}}},us="pairing_create",hs="pairing_expire",ls="pairing_delete",fs="pairing_ping",ps="history_created",ds="history_updated",gs="history_deleted",ys="history_sync",vs="expirer_created",ms="expirer_deleted",ws="expirer_expired",_s="expirer_sync",bs="verify-api",Es="https://verify.walletconnect.com",Is="https://verify.walletconnect.org";class Ps{constructor(t,e){this.core=t,this.logger=e,this.keychain=new Map,this.name="keychain",this.version="0.3",this.initialized=!1,this.storagePrefix=Mi,this.init=async()=>{if(!this.initialized){const t=await this.getKeyChain();typeof t<"u"&&(this.keychain=t),this.initialized=!0}},this.has=t=>(this.isInitialized(),this.keychain.has(t)),this.set=async(t,e)=>{this.isInitialized(),this.keychain.set(t,e),await this.persist()},this.get=t=>{this.isInitialized();const e=this.keychain.get(t);if(typeof e>"u"){const{message:e}=m("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(e)}return e},this.del=async t=>{this.isInitialized(),this.keychain.delete(t),await this.persist()},this.core=t,this.logger=Pe.generateChildLogger(e,this.name)}get context(){return Pe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(t){await this.core.storage.setItem(this.storageKey,X(t))}async getKeyChain(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?tt(t):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:t}=m("NOT_INITIALIZED",this.name);throw new Error(t)}}}class Ss{constructor(t,e,r){this.core=t,this.logger=e,this.name="crypto",this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=t=>(this.isInitialized(),this.keychain.has(t)),this.getClientId=async()=>(this.isInitialized(),gr(yr(await this.getClientSeed()).publicKey)),this.generateKeyPair=()=>{this.isInitialized();const t=w();return this.setPrivateKey(t.publicKey,t.privateKey)},this.signJWT=async t=>{this.isInitialized();const e=yr(await this.getClientSeed()),r=_(),n=Ui;return await vr(r,t,n,e)},this.generateSharedKey=(t,e,r)=>{this.isInitialized();const n=this.getPrivateKey(t),i=b(n,e);return this.setSymKey(i,r)},this.setSymKey=async(t,e)=>{this.isInitialized();const r=e||E(t);return await this.keychain.set(r,t),r},this.deleteKeyPair=async t=>{this.isInitialized(),await this.keychain.del(t)},this.deleteSymKey=async t=>{this.isInitialized(),await this.keychain.del(t)},this.encode=async(t,e,r)=>{this.isInitialized();const n=I(r),i=er(e);if(P(n)){const e=n.senderPublicKey,r=n.receiverPublicKey;t=await this.generateSharedKey(e,r)}const s=this.getSymKey(t),{type:o,senderPublicKey:a}=n;return S({type:o,symKey:s,message:i,senderPublicKey:a})},this.decode=async(t,e,r)=>{this.isInitialized();const n=O(e,r);if(P(n)){const e=n.receiverPublicKey,r=n.senderPublicKey;t=await this.generateSharedKey(e,r)}try{const r=this.getSymKey(t);return tr(x({symKey:r,encoded:e}))}catch(Ve){this.logger.error(`Failed to decode message from topic: '${t}', clientId: '${await this.getClientId()}'`),this.logger.error(Ve)}},this.getPayloadType=t=>{const e=R(t);return C(e.type)},this.getPayloadSenderPublicKey=t=>{const e=R(t);return e.senderPublicKey?h(e.senderPublicKey,A):void 0},this.core=t,this.logger=Pe.generateChildLogger(e,this.name),this.keychain=r||new Ps(this.core,this.logger)}get context(){return Pe.getLoggerContext(this.logger)}async setPrivateKey(t,e){return await this.keychain.set(t,e),t}getPrivateKey(t){return this.keychain.get(t)}async getClientSeed(){let t="";try{t=this.keychain.get($i)}catch{t=_(),await this.keychain.set($i,t)}return function(t,e="utf8"){const r=qi[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return"utf8"!==e&&"utf-8"!==e||null==globalThis.Buffer||null==globalThis.Buffer.from?r.decoder.decode(`${r.prefix}${t}`):Ti(globalThis.Buffer.from(t,"utf-8"))}(t,"base16")}getSymKey(t){return this.keychain.get(t)}isInitialized(){if(!this.initialized){const{message:t}=m("NOT_INITIALIZED",this.name);throw new Error(t)}}}class Os extends Ke{constructor(t,e){super(t,e),this.logger=t,this.core=e,this.messages=new Map,this.name="messages",this.version="0.3",this.initialized=!1,this.storagePrefix=Mi,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const t=await this.getRelayerMessages();typeof t<"u"&&(this.messages=t),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(t){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(t)}finally{this.initialized=!0}}},this.set=async(t,e)=>{this.isInitialized();const r=et(e);let n=this.messages.get(t);return typeof n>"u"&&(n={}),typeof n[r]<"u"||(n[r]=e,this.messages.set(t,n),await this.persist()),r},this.get=t=>{this.isInitialized();let e=this.messages.get(t);return typeof e>"u"&&(e={}),e},this.has=(t,e)=>(this.isInitialized(),typeof this.get(t)[et(e)]<"u"),this.del=async t=>{this.isInitialized(),this.messages.delete(t),await this.persist()},this.logger=Pe.generateChildLogger(t,this.name),this.core=e}get context(){return Pe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setRelayerMessages(t){await this.core.storage.setItem(this.storageKey,X(t))}async getRelayerMessages(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?tt(t):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:t}=m("NOT_INITIALIZED",this.name);throw new Error(t)}}}class xs extends Be{constructor(t,e){super(t,e),this.relayer=t,this.logger=e,this.events=new s.EventEmitter,this.name="publisher",this.queue=new Map,this.publishTimeout=i.toMiliseconds(i.TEN_SECONDS),this.needsTransportRestart=!1,this.publish=async(t,e,r)=>{var n;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:t,message:e,opts:r}});try{const s=(null==r?void 0:r.ttl)||Hi,o=rt(r),a=(null==r?void 0:r.prompt)||!1,c=(null==r?void 0:r.tag)||0,u=(null==r?void 0:r.id)||zr().toString(),h={topic:t,message:e,opts:{ttl:s,relay:o,prompt:a,tag:c,id:u}},l=setTimeout((()=>this.queue.set(u,h)),this.publishTimeout);try{await await T(this.rpcPublish(t,e,s,o,a,c,u),this.publishTimeout,"Failed to publish payload, please try again."),this.removeRequestFromQueue(u),this.relayer.events.emit(Ji,h)}catch(i){if(this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0,null!=(n=null==r?void 0:r.internal)&&n.throwOnFailedPublish)throw this.removeRequestFromQueue(u),i;return}finally{clearTimeout(l)}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:t,message:e,opts:r}})}catch(s){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(s),s}},this.on=(t,e)=>{this.events.on(t,e)},this.once=(t,e)=>{this.events.once(t,e)},this.off=(t,e)=>{this.events.off(t,e)},this.removeListener=(t,e)=>{this.events.removeListener(t,e)},this.relayer=t,this.logger=Pe.generateChildLogger(e,this.name),this.registerEventListeners()}get context(){return Pe.getLoggerContext(this.logger)}rpcPublish(t,e,r,n,i,s,o){var a,c,u,h;const l={method:nt(n.protocol).publish,params:{topic:t,message:e,ttl:r,prompt:i,tag:s},id:o};return g(null==(a=l.params)?void 0:a.prompt)&&(null==(c=l.params)||delete c.prompt),g(null==(u=l.params)?void 0:u.tag)&&(null==(h=l.params)||delete h.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:l}),this.relayer.request(l)}removeRequestFromQueue(t){this.queue.delete(t)}checkQueue(){this.queue.forEach((async t=>{const{topic:e,message:r,opts:n}=t;await this.publish(e,r,n)}))}registerEventListeners(){this.relayer.core.heartbeat.on(ee.HEARTBEAT_EVENTS.pulse,(()=>{if(this.needsTransportRestart)return this.needsTransportRestart=!1,void this.relayer.events.emit(Yi);this.checkQueue()})),this.relayer.on(Fi,(t=>{this.removeRequestFromQueue(t.id.toString())}))}}class Rs{constructor(){this.map=new Map,this.set=(t,e)=>{const r=this.get(t);this.exists(t,e)||this.map.set(t,[...r,e])},this.get=t=>this.map.get(t)||[],this.exists=(t,e)=>this.get(t).includes(e),this.delete=(t,e)=>{if(typeof e>"u")return void this.map.delete(t);if(!this.map.has(t))return;const r=this.get(t);if(!this.exists(t,e))return;const n=r.filter((t=>t!==e));n.length?this.map.set(t,n):this.map.delete(t)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var Cs=Object.defineProperty,As=Object.defineProperties,Ts=Object.getOwnPropertyDescriptors,js=Object.getOwnPropertySymbols,Ns=Object.prototype.hasOwnProperty,Ls=Object.prototype.propertyIsEnumerable,qs=(t,e,r)=>e in t?Cs(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ds=(t,e)=>{for(var r in e||(e={}))Ns.call(e,r)&&qs(t,r,e[r]);if(js)for(var r of js(e))Ls.call(e,r)&&qs(t,r,e[r]);return t},Ms=(t,e)=>As(t,Ts(e));class zs extends We{constructor(t,e){super(t,e),this.relayer=t,this.logger=e,this.subscriptions=new Map,this.topicMap=new Rs,this.events=new s.EventEmitter,this.name="subscription",this.version="0.3",this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Mi,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(t,e)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:t,opts:e}});try{const r=rt(e),n={topic:t,relay:r};this.pending.set(t,n);const i=await this.rpcSubscribe(t,r);return this.onSubscribe(i,n),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:t,opts:e}}),i}catch(He){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(He),He}},this.unsubscribe=async(t,e)=>{await this.restartToComplete(),this.isInitialized(),typeof(null==e?void 0:e.id)<"u"?await this.unsubscribeById(t,e.id,e):await this.unsubscribeByTopic(t,e)},this.isSubscribed=async t=>!!this.topics.includes(t)||await new Promise(((e,r)=>{const n=new i.Watch;n.start(this.pendingSubscriptionWatchLabel);const s=setInterval((()=>{!this.pending.has(t)&&this.topics.includes(t)&&(clearInterval(s),n.stop(this.pendingSubscriptionWatchLabel),e(!0)),n.elapsed(this.pendingSubscriptionWatchLabel)>=as&&(clearInterval(s),n.stop(this.pendingSubscriptionWatchLabel),r(new Error("Subscription resolution timeout")))}),this.pollingInterval)})).catch((()=>!1)),this.on=(t,e)=>{this.events.on(t,e)},this.once=(t,e)=>{this.events.once(t,e)},this.off=(t,e)=>{this.events.off(t,e)},this.removeListener=(t,e)=>{this.events.removeListener(t,e)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=t,this.logger=Pe.generateChildLogger(e,this.name),this.clientId=""}get context(){return Pe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(t,e){let r=!1;try{r=this.getSubscription(t).topic===e}catch{}return r}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(t,e){const r=this.topicMap.get(t);await Promise.all(r.map((async r=>await this.unsubscribeById(t,r,e))))}async unsubscribeById(t,e,r){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:e,opts:r}});try{const n=rt(r);await this.rpcUnsubscribe(t,e,n);const i=H("USER_DISCONNECTED",`${this.name}, ${t}`);await this.onUnsubscribe(t,e,i),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:e,opts:r}})}catch(n){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(n),n}}async rpcSubscribe(t,e){const r={method:nt(e.protocol).subscribe,params:{topic:t}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:r});try{await await T(this.relayer.request(r),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Yi)}return et(t+this.clientId)}async rpcBatchSubscribe(t){if(!t.length)return;const e=t[0].relay,r={method:nt(e.protocol).batchSubscribe,params:{topics:t.map((t=>t.topic))}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:r});try{return await await T(this.relayer.request(r),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(Yi)}}rpcUnsubscribe(t,e,r){const n={method:nt(r.protocol).unsubscribe,params:{topic:t,id:e}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n}),this.relayer.request(n)}onSubscribe(t,e){this.setSubscription(t,Ms(Ds({},e),{id:t})),this.pending.delete(e.topic)}onBatchSubscribe(t){t.length&&t.forEach((t=>{this.setSubscription(t.id,Ds({},t)),this.pending.delete(t.topic)}))}async onUnsubscribe(t,e,r){this.events.removeAllListeners(e),this.hasSubscription(e,t)&&this.deleteSubscription(e,r),await this.relayer.messages.del(t)}async setRelayerSubscriptions(t){await this.relayer.core.storage.setItem(this.storageKey,t)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(t,e){this.subscriptions.has(t)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:t,subscription:e}),this.addSubscription(t,e))}addSubscription(t,e){this.subscriptions.set(t,Ds({},e)),this.topicMap.set(e.topic,t),this.events.emit(ns,e)}getSubscription(t){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:t});const e=this.subscriptions.get(t);if(!e){const{message:e}=m("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(e)}return e}deleteSubscription(t,e){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:t,reason:e});const r=this.getSubscription(t);this.subscriptions.delete(t),this.topicMap.delete(r.topic,t),this.events.emit(is,Ms(Ds({},r),{reason:e}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(ss)}async reset(){if(this.cached.length){const t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let e=0;e<t;e++){const t=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(t)}}this.events.emit(os)}async restore(){try{const t=await this.getRelayerSubscriptions();if(typeof t>"u"||!t.length)return;if(this.subscriptions.size){const{message:t}=m("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(t)}this.cached=t,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(t){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(t)}}async batchSubscribe(t){if(!t.length)return;const e=await this.rpcBatchSubscribe(t);it(e)&&this.onBatchSubscribe(e.map(((e,r)=>Ms(Ds({},t[r]),{id:e}))))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||this.relayer.transportExplicitlyClosed)return;const t=[];this.pending.forEach((e=>{t.push(e)})),await this.batchSubscribe(t)}registerEventListeners(){this.relayer.core.heartbeat.on(ee.HEARTBEAT_EVENTS.pulse,(async()=>{await this.checkPending()})),this.relayer.on(Gi,(async()=>{await this.onConnect()})),this.relayer.on(Wi,(()=>{this.onDisconnect()})),this.events.on(ns,(async t=>{const e=ns;this.logger.info(`Emitting ${e}`),this.logger.debug({type:"event",event:e,data:t}),await this.persist()})),this.events.on(is,(async t=>{const e=is;this.logger.info(`Emitting ${e}`),this.logger.debug({type:"event",event:e,data:t}),await this.persist()}))}isInitialized(){if(!this.initialized){const{message:t}=m("NOT_INITIALIZED",this.name);throw new Error(t)}}async restartToComplete(){this.restartInProgress&&await new Promise((t=>{const e=setInterval((()=>{this.restartInProgress||(clearInterval(e),t())}),this.pollingInterval)}))}}var ks=Object.defineProperty,$s=Object.getOwnPropertySymbols,Us=Object.prototype.hasOwnProperty,Hs=Object.prototype.propertyIsEnumerable,Vs=(t,e,r)=>e in t?ks(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;class Ks extends Fe{constructor(t){super(t),this.protocol="wc",this.version=2,this.events=new s.EventEmitter,this.name="relayer",this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.hasExperiencedNetworkDisruption=!1,this.request=async t=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(t)}catch(e){throw this.logger.debug("Failed to Publish Request"),this.logger.error(e),e}},this.onPayloadHandler=t=>{this.onProviderPayload(t)},this.onConnectHandler=()=>{this.events.emit(Gi)},this.onDisconnectHandler=()=>{this.onProviderDisconnect()},this.onProviderErrorHandler=t=>{this.logger.error(t),this.events.emit(Qi,t),this.logger.info("Fatal socket error received, closing transport"),this.transportClose()},this.registerProviderListeners=()=>{this.provider.on(Zi,this.onPayloadHandler),this.provider.on(Xi,this.onConnectHandler),this.provider.on(ts,this.onDisconnectHandler),this.provider.on(es,this.onProviderErrorHandler)},this.core=t.core,this.logger=typeof t.logger<"u"&&"string"!=typeof t.logger?Pe.generateChildLogger(t.logger,this.name):Pe.pino(Pe.getDefaultLoggerOptions({level:t.logger||"error"})),this.messages=new Os(this.logger,t.core),this.subscriber=new zs(this,this.logger),this.publisher=new xs(this,this.logger),this.relayUrl=(null==t?void 0:t.relayUrl)||Vi,this.projectId=t.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${Ki}...`),await this.restartTransport(Ki)}this.initialized=!0,setTimeout((async()=>{0===this.subscriber.topics.length&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)}),1e4)}get context(){return Pe.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(t,e,r){this.isInitialized(),await this.publisher.publish(t,e,r),await this.recordMessageEvent({topic:t,message:e,publishedAt:Date.now()})}async subscribe(t,e){var r;this.isInitialized();let n,i=(null==(r=this.subscriber.topicMap.get(t))?void 0:r[0])||"";if(i)return i;const s=e=>{e.topic===t&&(this.subscriber.off(ns,s),n())};return await Promise.all([new Promise((t=>{n=t,this.subscriber.on(ns,s)})),new Promise((async r=>{i=await this.subscriber.subscribe(t,e),r()}))]),i}async unsubscribe(t,e){this.isInitialized(),await this.subscriber.unsubscribe(t,e)}on(t,e){this.events.on(t,e)}once(t,e){this.events.once(t,e)}off(t,e){this.events.off(t,e)}removeListener(t,e){this.events.removeListener(t,e)}async transportClose(){this.transportExplicitlyClosed=!0,this.hasExperiencedNetworkDisruption&&this.connected?await T(this.provider.disconnect(),1e3,"provider.disconnect()").catch((()=>this.onProviderDisconnect())):this.connected&&await this.provider.disconnect()}async transportOpen(t){if(this.transportExplicitlyClosed=!1,await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress){t&&t!==this.relayUrl&&(this.relayUrl=t,await this.transportClose(),await this.createProvider()),this.connectionAttemptInProgress=!0;try{await Promise.all([new Promise((t=>{if(!this.initialized)return t();this.subscriber.once(os,(()=>{t()}))})),new Promise((async(t,e)=>{try{await T(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`)}catch(r){return void e(r)}t()}))])}catch(e){this.logger.error(e);const t=e;if(!this.isConnectionStalled(t.message))throw e;this.provider.events.emit(ts)}finally{this.connectionAttemptInProgress=!1,this.hasExperiencedNetworkDisruption=!1}}}async restartTransport(t){await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress&&(this.relayUrl=t||this.relayUrl,await this.transportClose(),await this.createProvider(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!(await j()))throw new Error("No internet connection detected. Please restart your network and try again.")}isConnectionStalled(t){return this.staleConnectionErrors.some((e=>t.includes(e)))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const t=await this.core.crypto.signJWT(this.relayUrl);this.provider=new en(new sn(N({sdkVersion:"2.10.2",protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:t,useOnCloseEvent:!0}))),this.registerProviderListeners()}async recordMessageEvent(t){const{topic:e,message:r}=t;await this.messages.set(e,r)}async shouldIgnoreMessageEvent(t){const{topic:e,message:r}=t;if(!r||0===r.length)return this.logger.debug(`Ignoring invalid/empty message: ${r}`),!0;if(!(await this.subscriber.isSubscribed(e)))return this.logger.debug(`Ignoring message for non-subscribed topic ${e}`),!0;const n=this.messages.has(e,r);return n&&this.logger.debug(`Ignoring duplicate message: ${r}`),n}async onProviderPayload(t){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:t}),Jr(t)){if(!t.method.endsWith("_subscription"))return;const e=t.params,{topic:r,message:n,publishedAt:i}=e.data,s={topic:r,message:n,publishedAt:i};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(((t,e)=>{for(var r in e||(e={}))Us.call(e,r)&&Vs(t,r,e[r]);if($s)for(var r of $s(e))Hs.call(e,r)&&Vs(t,r,e[r]);return t})({type:"event",event:e.id},s)),this.events.emit(e.id,s),await this.acknowledgePayload(t),await this.onMessageEvent(s)}else Zr(t)&&this.events.emit(Fi,t)}async onMessageEvent(t){await this.shouldIgnoreMessageEvent(t)||(this.events.emit(Bi,t),await this.recordMessageEvent(t))}async acknowledgePayload(t){const e=$r(t.id,!0);await this.provider.connection.send(e)}unregisterProviderListeners(){this.provider.off(Zi,this.onPayloadHandler),this.provider.off(Xi,this.onConnectHandler),this.provider.off(ts,this.onDisconnectHandler),this.provider.off(es,this.onProviderErrorHandler)}async registerEventListeners(){this.events.on(Yi,(()=>{this.restartTransport().catch((t=>this.logger.error(t)))}));let t=await j();L((async e=>{this.initialized&&t!==e&&(t=e,e?await this.restartTransport().catch((t=>this.logger.error(t))):(this.hasExperiencedNetworkDisruption=!0,await this.transportClose().catch((t=>this.logger.error(t)))))}))}onProviderDisconnect(){this.events.emit(Wi),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||(this.logger.info("attemptToReconnect called. Connecting..."),setTimeout((async()=>{await this.restartTransport().catch((t=>this.logger.error(t)))}),i.toMiliseconds(rs)))}isInitialized(){if(!this.initialized){const{message:t}=m("NOT_INITIALIZED",this.name);throw new Error(t)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectionAttemptInProgress)return await new Promise((t=>{const e=setInterval((()=>{this.connected&&(clearInterval(e),t())}),this.connectionStatusPollingInterval)}));await this.restartTransport()}}}var Bs=Object.defineProperty,Fs=Object.getOwnPropertySymbols,Gs=Object.prototype.hasOwnProperty,Ws=Object.prototype.propertyIsEnumerable,Qs=(t,e,r)=>e in t?Bs(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ys=(t,e)=>{for(var r in e||(e={}))Gs.call(e,r)&&Qs(t,r,e[r]);if(Fs)for(var r of Fs(e))Ws.call(e,r)&&Qs(t,r,e[r]);return t};class Js extends Ge{constructor(t,e,r,n=Mi,i=void 0){super(t,e,r,n),this.core=t,this.logger=e,this.name=r,this.map=new Map,this.version="0.3",this.cached=[],this.initialized=!1,this.storagePrefix=Mi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach((t=>{this.getKey&&null!==t&&!g(t)?this.map.set(this.getKey(t),t):y(t)?this.map.set(t.id,t):v(t)&&this.map.set(t.topic,t)})),this.cached=[],this.initialized=!0)},this.set=async(t,e)=>{this.isInitialized(),this.map.has(t)?await this.update(t,e):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:t,value:e}),this.map.set(t,e),await this.persist())},this.get=t=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:t}),this.getData(t)),this.getAll=t=>(this.isInitialized(),t?this.values.filter((e=>Object.keys(t).every((r=>an(e[r],t[r]))))):this.values),this.update=async(t,e)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:t,update:e});const r=Ys(Ys({},this.getData(t)),e);this.map.set(t,r),await this.persist()},this.delete=async(t,e)=>{this.isInitialized(),this.map.has(t)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:t,reason:e}),this.map.delete(t),await this.persist())},this.logger=Pe.generateChildLogger(e,this.name),this.storagePrefix=n,this.getKey=i}get context(){return Pe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(t){await this.core.storage.setItem(this.storageKey,t)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(t){const e=this.map.get(t);if(!e){const{message:e}=m("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(e),new Error(e)}return e}async persist(){await this.setDataStore(this.values)}async restore(){try{const t=await this.getDataStore();if(typeof t>"u"||!t.length)return;if(this.map.size){const{message:t}=m("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=t,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(t){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(t)}}isInitialized(){if(!this.initialized){const{message:t}=m("NOT_INITIALIZED",this.name);throw new Error(t)}}}class Zs{constructor(t,e){this.core=t,this.logger=e,this.name="pairing",this.version="0.3",this.events=new q,this.initialized=!1,this.storagePrefix=Mi,this.ignoredPayloadTypes=[D],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:t})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...t])]},this.create=async()=>{this.isInitialized();const t=_(),e=await this.core.crypto.setSymKey(t),r=M(i.FIVE_MINUTES),n={protocol:"irn"},s={topic:e,expiry:r,relay:n,active:!1},o=z({protocol:this.core.protocol,version:this.core.version,topic:e,symKey:t,relay:n});return await this.pairings.set(e,s),await this.core.relayer.subscribe(e),this.core.expirer.set(e,r),{topic:e,uri:o}},this.pair=async t=>{this.isInitialized(),this.isValidPair(t);const{topic:e,symKey:r,relay:n}=k(t.uri);let s;if(this.pairings.keys.includes(e)&&(s=this.pairings.get(e),s.active))throw new Error(`Pairing already exists: ${e}. Please try again with a new connection URI.`);this.core.crypto.keychain.has(e)||(await this.core.crypto.setSymKey(r,e),await this.core.relayer.subscribe(e,{relay:n}));const o=M(i.FIVE_MINUTES),a={topic:e,relay:n,expiry:o,active:!1};return await this.pairings.set(e,a),this.core.expirer.set(e,o),t.activatePairing&&await this.activate({topic:e}),this.events.emit(us,a),a},this.activate=async({topic:t})=>{this.isInitialized();const e=M(i.THIRTY_DAYS);await this.pairings.update(t,{active:!0,expiry:e}),this.core.expirer.set(t,e)},this.ping=async t=>{this.isInitialized(),await this.isValidPing(t);const{topic:e}=t;if(this.pairings.keys.includes(e)){const t=await this.sendRequest(e,"wc_pairingPing",{}),{done:r,resolve:n,reject:i}=$();this.events.once(U("pairing_ping",t),(({error:t})=>{t?i(t):n()})),await r()}},this.updateExpiry=async({topic:t,expiry:e})=>{this.isInitialized(),await this.pairings.update(t,{expiry:e})},this.updateMetadata=async({topic:t,metadata:e})=>{this.isInitialized(),await this.pairings.update(t,{peerMetadata:e})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async t=>{this.isInitialized(),await this.isValidDisconnect(t);const{topic:e}=t;this.pairings.keys.includes(e)&&(await this.sendRequest(e,"wc_pairingDelete",H("USER_DISCONNECTED")),await this.deletePairing(e))},this.sendRequest=async(t,e,r)=>{const n=kr(e,r),i=await this.core.crypto.encode(t,n),s=cs[e].req;return this.core.history.set(t,n),this.core.relayer.publish(t,i,s),n.id},this.sendResult=async(t,e,r)=>{const n=$r(t,r),i=await this.core.crypto.encode(e,n),s=await this.core.history.get(e,t),o=cs[s.request.method].res;await this.core.relayer.publish(e,i,o),await this.core.history.resolve(n)},this.sendError=async(t,e,r)=>{const n=Ur(t,r),i=await this.core.crypto.encode(e,n),s=await this.core.history.get(e,t),o=cs[s.request.method]?cs[s.request.method].res:cs.unregistered_method.res;await this.core.relayer.publish(e,i,o),await this.core.history.resolve(n)},this.deletePairing=async(t,e)=>{await this.core.relayer.unsubscribe(t),await Promise.all([this.pairings.delete(t,H("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(t),e?Promise.resolve():this.core.expirer.del(t)])},this.cleanup=async()=>{const t=this.pairings.getAll().filter((t=>V(t.expiry)));await Promise.all(t.map((t=>this.deletePairing(t.topic))))},this.onRelayEventRequest=t=>{const{topic:e,payload:r}=t;switch(r.method){case"wc_pairingPing":return this.onPairingPingRequest(e,r);case"wc_pairingDelete":return this.onPairingDeleteRequest(e,r);default:return this.onUnknownRpcMethodRequest(e,r)}},this.onRelayEventResponse=async t=>{const{topic:e,payload:r}=t,n=(await this.core.history.get(e,r.id)).request.method;return"wc_pairingPing"===n?this.onPairingPingResponse(e,r):this.onUnknownRpcMethodResponse(n)},this.onPairingPingRequest=async(t,e)=>{const{id:r}=e;try{this.isValidPing({topic:t}),await this.sendResult(r,t,!0),this.events.emit(fs,{id:r,topic:t})}catch(Ke){await this.sendError(r,t,Ke),this.logger.error(Ke)}},this.onPairingPingResponse=(t,e)=>{const{id:r}=e;setTimeout((()=>{Xr(e)?this.events.emit(U("pairing_ping",r),{}):tn(e)&&this.events.emit(U("pairing_ping",r),{error:e.error})}),500)},this.onPairingDeleteRequest=async(t,e)=>{const{id:r}=e;try{this.isValidDisconnect({topic:t}),await this.deletePairing(t),this.events.emit(ls,{id:r,topic:t})}catch(Ke){await this.sendError(r,t,Ke),this.logger.error(Ke)}},this.onUnknownRpcMethodRequest=async(t,e)=>{const{id:r,method:n}=e;try{if(this.registeredMethods.includes(n))return;const e=H("WC_METHOD_UNSUPPORTED",n);await this.sendError(r,t,e),this.logger.error(e)}catch(i){await this.sendError(r,t,i),this.logger.error(i)}},this.onUnknownRpcMethodResponse=t=>{this.registeredMethods.includes(t)||this.logger.error(H("WC_METHOD_UNSUPPORTED",t))},this.isValidPair=t=>{if(!K(t)){const{message:e}=m("MISSING_OR_INVALID",`pair() params: ${t}`);throw new Error(e)}if(!B(t.uri)){const{message:e}=m("MISSING_OR_INVALID",`pair() uri: ${t.uri}`);throw new Error(e)}},this.isValidPing=async t=>{if(!K(t)){const{message:e}=m("MISSING_OR_INVALID",`ping() params: ${t}`);throw new Error(e)}const{topic:e}=t;await this.isValidPairingTopic(e)},this.isValidDisconnect=async t=>{if(!K(t)){const{message:e}=m("MISSING_OR_INVALID",`disconnect() params: ${t}`);throw new Error(e)}const{topic:e}=t;await this.isValidPairingTopic(e)},this.isValidPairingTopic=async t=>{if(!F(t,!1)){const{message:e}=m("MISSING_OR_INVALID",`pairing topic should be a string: ${t}`);throw new Error(e)}if(!this.pairings.keys.includes(t)){const{message:e}=m("NO_MATCHING_KEY",`pairing topic doesn't exist: ${t}`);throw new Error(e)}if(V(this.pairings.get(t).expiry)){await this.deletePairing(t);const{message:e}=m("EXPIRED",`pairing topic: ${t}`);throw new Error(e)}},this.core=t,this.logger=Pe.generateChildLogger(e,this.name),this.pairings=new Js(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Pe.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:t}=m("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.core.relayer.on(Bi,(async t=>{const{topic:e,message:r}=t;if(!this.pairings.keys.includes(e)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(r)))return;const n=await this.core.crypto.decode(e,r);try{Jr(n)?(this.core.history.set(e,n),this.onRelayEventRequest({topic:e,payload:n})):Zr(n)&&(await this.core.history.resolve(n),await this.onRelayEventResponse({topic:e,payload:n}),this.core.history.delete(e,n.id))}catch(He){this.logger.error(He)}}))}registerExpirerEvents(){this.core.expirer.on(ws,(async t=>{const{topic:e}=G(t.target);e&&this.pairings.keys.includes(e)&&(await this.deletePairing(e,!0),this.events.emit(hs,{topic:e}))}))}}class Xs extends Ve{constructor(t,e){super(t,e),this.core=t,this.logger=e,this.records=new Map,this.events=new s.EventEmitter,this.name="history",this.version="0.3",this.cached=[],this.initialized=!1,this.storagePrefix=Mi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach((t=>this.records.set(t.id,t))),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(t,e,r)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:t,request:e,chainId:r}),this.records.has(e.id))return;const n={id:e.id,topic:t,request:{method:e.method,params:e.params||null},chainId:r,expiry:M(i.THIRTY_DAYS)};this.records.set(n.id,n),this.events.emit(ps,n)},this.resolve=async t=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:t}),!this.records.has(t.id))return;const e=await this.getRecord(t.id);typeof e.response>"u"&&(e.response=tn(t)?{error:t.error}:{result:t.result},this.records.set(e.id,e),this.events.emit(ds,e))},this.get=async(t,e)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:t,id:e}),await this.getRecord(e)),this.delete=(t,e)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:e}),this.values.forEach((r=>{if(r.topic===t){if(typeof e<"u"&&r.id!==e)return;this.records.delete(r.id),this.events.emit(gs,r)}}))},this.exists=async(t,e)=>(this.isInitialized(),!!this.records.has(e)&&(await this.getRecord(e)).topic===t),this.on=(t,e)=>{this.events.on(t,e)},this.once=(t,e)=>{this.events.once(t,e)},this.off=(t,e)=>{this.events.off(t,e)},this.removeListener=(t,e)=>{this.events.removeListener(t,e)},this.logger=Pe.generateChildLogger(e,this.name)}get context(){return Pe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const t=[];return this.values.forEach((e=>{if(typeof e.response<"u")return;const r={topic:e.topic,request:kr(e.request.method,e.request.params,e.id),chainId:e.chainId};return t.push(r)})),t}async setJsonRpcRecords(t){await this.core.storage.setItem(this.storageKey,t)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(t){this.isInitialized();const e=this.records.get(t);if(!e){const{message:e}=m("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(e)}return e}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(ys)}async restore(){try{const t=await this.getJsonRpcRecords();if(typeof t>"u"||!t.length)return;if(this.records.size){const{message:t}=m("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=t,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(t){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(t)}}registerEventListeners(){this.events.on(ps,(t=>{const e=ps;this.logger.info(`Emitting ${e}`),this.logger.debug({type:"event",event:e,record:t}),this.persist()})),this.events.on(ds,(t=>{const e=ds;this.logger.info(`Emitting ${e}`),this.logger.debug({type:"event",event:e,record:t}),this.persist()})),this.events.on(gs,(t=>{const e=gs;this.logger.info(`Emitting ${e}`),this.logger.debug({type:"event",event:e,record:t}),this.persist()})),this.core.heartbeat.on(ee.HEARTBEAT_EVENTS.pulse,(()=>{this.cleanup()}))}cleanup(){try{this.records.forEach((t=>{i.toMiliseconds(t.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${t.id}`),this.delete(t.topic,t.id))}))}catch(t){this.logger.warn(t)}}isInitialized(){if(!this.initialized){const{message:t}=m("NOT_INITIALIZED",this.name);throw new Error(t)}}}class to extends Qe{constructor(t,e){super(t,e),this.core=t,this.logger=e,this.expirations=new Map,this.events=new s.EventEmitter,this.name="expirer",this.version="0.3",this.cached=[],this.initialized=!1,this.storagePrefix=Mi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach((t=>this.expirations.set(t.target,t))),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=t=>{try{const e=this.formatTarget(t);return typeof this.getExpiration(e)<"u"}catch{return!1}},this.set=(t,e)=>{this.isInitialized();const r=this.formatTarget(t),n={target:r,expiry:e};this.expirations.set(r,n),this.checkExpiry(r,n),this.events.emit(vs,{target:r,expiration:n})},this.get=t=>{this.isInitialized();const e=this.formatTarget(t);return this.getExpiration(e)},this.del=t=>{if(this.isInitialized(),this.has(t)){const e=this.formatTarget(t),r=this.getExpiration(e);this.expirations.delete(e),this.events.emit(ms,{target:e,expiration:r})}},this.on=(t,e)=>{this.events.on(t,e)},this.once=(t,e)=>{this.events.once(t,e)},this.off=(t,e)=>{this.events.off(t,e)},this.removeListener=(t,e)=>{this.events.removeListener(t,e)},this.logger=Pe.generateChildLogger(e,this.name)}get context(){return Pe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(t){if("string"==typeof t)return W(t);if("number"==typeof t)return Q(t);const{message:e}=m("UNKNOWN_TYPE","Target type: "+typeof t);throw new Error(e)}async setExpirations(t){await this.core.storage.setItem(this.storageKey,t)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(_s)}async restore(){try{const t=await this.getExpirations();if(typeof t>"u"||!t.length)return;if(this.expirations.size){const{message:t}=m("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=t,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(t){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(t)}}getExpiration(t){const e=this.expirations.get(t);if(!e){const{message:e}=m("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(e),new Error(e)}return e}checkExpiry(t,e){const{expiry:r}=e;i.toMiliseconds(r)-Date.now()<=0&&this.expire(t,e)}expire(t,e){this.expirations.delete(t),this.events.emit(ws,{target:t,expiration:e})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach(((t,e)=>this.checkExpiry(e,t)))}registerEventListeners(){this.core.heartbeat.on(ee.HEARTBEAT_EVENTS.pulse,(()=>this.checkExpirations())),this.events.on(vs,(t=>{const e=vs;this.logger.info(`Emitting ${e}`),this.logger.debug({type:"event",event:e,data:t}),this.persist()})),this.events.on(ws,(t=>{const e=ws;this.logger.info(`Emitting ${e}`),this.logger.debug({type:"event",event:e,data:t}),this.persist()})),this.events.on(ms,(t=>{const e=ms;this.logger.info(`Emitting ${e}`),this.logger.debug({type:"event",event:e,data:t}),this.persist()}))}isInitialized(){if(!this.initialized){const{message:t}=m("NOT_INITIALIZED",this.name);throw new Error(t)}}}class eo extends Ye{constructor(t,e){super(t,e),this.projectId=t,this.logger=e,this.name=bs,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=async()=>{if(this.verifyDisabled||Y()||!J())return;const t=Es;this.verifyUrl!==t&&this.removeIframe(),this.verifyUrl=t;try{await this.createIframe()}catch(e){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(e)}if(!this.initialized){this.removeIframe(),this.verifyUrl=Is;try{await this.createIframe()}catch(e){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(e),this.verifyDisabled=!0}}},this.register=async t=>{this.initialized?this.sendPost(t.attestationId):(this.addToQueue(t.attestationId),await this.init())},this.resolve=async t=>{if(this.isDevEnv)return"";const e=(null==t?void 0:t.verifyUrl)||Es;let r;try{r=await this.fetchAttestation(t.attestationId,e)}catch(Ke){this.logger.info(`failed to resolve attestation: ${t.attestationId} from url: ${e}`),this.logger.info(Ke),r=await this.fetchAttestation(t.attestationId,Is)}return r},this.fetchAttestation=async(t,e)=>{this.logger.info(`resolving attestation: ${t} from url: ${e}`);const r=this.startAbortTimer(2*i.ONE_SECOND),n=await fetch(`${e}/attestation/${t}`,{signal:this.abortController.signal});return clearTimeout(r),200===n.status?await n.json():void 0},this.addToQueue=t=>{this.queue.push(t)},this.processQueue=()=>{0!==this.queue.length&&(this.queue.forEach((t=>this.sendPost(t))),this.queue=[])},this.sendPost=t=>{var e;try{if(!this.iframe)return;null==(e=this.iframe.contentWindow)||e.postMessage(t,"*"),this.logger.info(`postMessage sent: ${t} ${this.verifyUrl}`)}catch{}},this.createIframe=async()=>{let t;const e=r=>{"verify_ready"===r.data&&(this.initialized=!0,this.processQueue(),window.removeEventListener("message",e),t())};await Promise.race([new Promise((r=>{if(document.getElementById(bs))return r();window.addEventListener("message",e);const n=document.createElement("iframe");n.id=bs,n.src=`${this.verifyUrl}/${this.projectId}`,n.style.display="none",document.body.append(n),this.iframe=n,t=r})),new Promise(((t,r)=>setTimeout((()=>{window.removeEventListener("message",e),r("verify iframe load timeout")}),i.toMiliseconds(i.FIVE_SECONDS))))])},this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.logger=Pe.generateChildLogger(e,this.name),this.verifyUrl=Es,this.abortController=new AbortController,this.isDevEnv=Z()&&{}.IS_VITEST}get context(){return Pe.getLoggerContext(this.logger)}startAbortTimer(t){return this.abortController=new AbortController,setTimeout((()=>this.abortController.abort()),i.toMiliseconds(t))}}var ro=Object.defineProperty,no=Object.getOwnPropertySymbols,io=Object.prototype.hasOwnProperty,so=Object.prototype.propertyIsEnumerable,oo=(t,e,r)=>e in t?ro(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ao=(t,e)=>{for(var r in e||(e={}))io.call(e,r)&&oo(t,r,e[r]);if(no)for(var r of no(e))so.call(e,r)&&oo(t,r,e[r]);return t};class co extends He{constructor(t){super(t),this.protocol="wc",this.version=2,this.name=Di,this.events=new s.EventEmitter,this.initialized=!1,this.on=(t,e)=>this.events.on(t,e),this.once=(t,e)=>this.events.once(t,e),this.off=(t,e)=>this.events.off(t,e),this.removeListener=(t,e)=>this.events.removeListener(t,e),this.projectId=null==t?void 0:t.projectId,this.relayUrl=(null==t?void 0:t.relayUrl)||Vi,this.customStoragePrefix=null!=t&&t.customStoragePrefix?`:${t.customStoragePrefix}`:"";const e=typeof(null==t?void 0:t.logger)<"u"&&"string"!=typeof(null==t?void 0:t.logger)?t.logger:Pe.pino(Pe.getDefaultLoggerOptions({level:(null==t?void 0:t.logger)||zi}));this.logger=Pe.generateChildLogger(e,this.name),this.heartbeat=new ee.HeartBeat,this.crypto=new Ss(this,this.logger,null==t?void 0:t.keychain),this.history=new Xs(this,this.logger),this.expirer=new to(this,this.logger),this.storage=null!=t&&t.storage?t.storage:new te(ao(ao({},ki),null==t?void 0:t.storageOptions)),this.relayer=new Ks({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new Zs(this,this.logger),this.verify=new eo(this.projectId||"",this.logger)}static async init(t){const e=new co(t);await e.initialize();const r=await e.crypto.getClientId();return await e.storage.setItem("WALLETCONNECT_CLIENT_ID",r),e}get context(){return Pe.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(t){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,t),this.logger.error(t.message),t}}}const uo=co,ho="client",lo=`wc@2:${ho}:`,fo=ho,po="error",go="WALLETCONNECT_DEEPLINK_CHOICE",yo="Proposal expired",vo=i.SEVEN_DAYS,mo={wc_sessionPropose:{req:{ttl:i.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:i.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:i.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:i.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:i.ONE_DAY,prompt:!1,tag:1104},res:{ttl:i.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:i.ONE_DAY,prompt:!1,tag:1106},res:{ttl:i.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:i.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:i.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:i.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:i.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:i.ONE_DAY,prompt:!1,tag:1112},res:{ttl:i.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:i.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:i.THIRTY_SECONDS,prompt:!1,tag:1115}}},wo={min:i.FIVE_MINUTES,max:i.SEVEN_DAYS},_o="IDLE",bo="ACTIVE",Eo=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var Io=Object.defineProperty,Po=Object.defineProperties,So=Object.getOwnPropertyDescriptors,Oo=Object.getOwnPropertySymbols,xo=Object.prototype.hasOwnProperty,Ro=Object.prototype.propertyIsEnumerable,Co=(t,e,r)=>e in t?Io(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ao=(t,e)=>{for(var r in e||(e={}))xo.call(e,r)&&Co(t,r,e[r]);if(Oo)for(var r of Oo(e))Ro.call(e,r)&&Co(t,r,e[r]);return t},To=(t,e)=>Po(t,So(e));class jo extends Ze{constructor(t){super(t),this.name="engine",this.events=new q,this.initialized=!1,this.ignoredPayloadTypes=[D],this.requestQueue={state:_o,queue:[]},this.sessionRequestQueue={state:_o,queue:[]},this.requestQueueDelay=i.ONE_SECOND,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),this.client.core.pairing.register({methods:Object.keys(mo)}),this.initialized=!0,setTimeout((()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()}),i.toMiliseconds(this.requestQueueDelay)))},this.connect=async t=>{await this.isInitialized();const e=To(Ao({},t),{requiredNamespaces:t.requiredNamespaces||{},optionalNamespaces:t.optionalNamespaces||{}});await this.isValidConnect(e);const{pairingTopic:r,requiredNamespaces:n,optionalNamespaces:s,sessionProperties:o,relays:a}=e;let c,u=r,h=!1;if(u&&(h=this.client.core.pairing.pairings.get(u).active),!u||!h){const{topic:t,uri:e}=await this.client.core.pairing.create();u=t,c=e}const l=await this.client.core.crypto.generateKeyPair(),f=Ao({requiredNamespaces:n,optionalNamespaces:s,relays:null!=a?a:[{protocol:"irn"}],proposer:{publicKey:l,metadata:this.client.metadata}},o&&{sessionProperties:o}),{reject:p,resolve:d,done:g}=$(i.FIVE_MINUTES,yo);if(this.events.once(U("session_connect"),(async({error:t,session:e})=>{if(t)p(t);else if(e){e.self.publicKey=l;const t=To(Ao({},e),{requiredNamespaces:e.requiredNamespaces,optionalNamespaces:e.optionalNamespaces});await this.client.session.set(e.topic,t),await this.setExpiry(e.topic,e.expiry),u&&await this.client.core.pairing.updateMetadata({topic:u,metadata:e.peer.metadata}),d(t)}})),!u){const{message:t}=m("NO_MATCHING_KEY",`connect() pairing topic: ${u}`);throw new Error(t)}const y=await this.sendRequest({topic:u,method:"wc_sessionPropose",params:f}),v=M(i.FIVE_MINUTES);return await this.setProposal(y,Ao({id:y,expiry:v},f)),{uri:c,approval:g}},this.pair=async t=>(await this.isInitialized(),await this.client.core.pairing.pair(t)),this.approve=async t=>{await this.isInitialized(),await this.isValidApprove(t);const{id:e,relayProtocol:r,namespaces:n,sessionProperties:i}=t,s=this.client.proposal.get(e);let{pairingTopic:o,proposer:a,requiredNamespaces:c,optionalNamespaces:u}=s;o=o||"",ot(c)||(c=at(n,"approve()"));const h=await this.client.core.crypto.generateKeyPair(),l=a.publicKey,f=await this.client.core.crypto.generateSharedKey(h,l);o&&e&&(await this.client.core.pairing.updateMetadata({topic:o,metadata:a.metadata}),await this.sendResult({id:e,topic:o,result:{relay:{protocol:null!=r?r:"irn"},responderPublicKey:h}}),await this.client.proposal.delete(e,H("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:o}));const p=Ao({relay:{protocol:null!=r?r:"irn"},namespaces:n,requiredNamespaces:c,optionalNamespaces:u,pairingTopic:o,controller:{publicKey:h,metadata:this.client.metadata},expiry:M(vo)},i&&{sessionProperties:i});await this.client.core.relayer.subscribe(f),await this.sendRequest({topic:f,method:"wc_sessionSettle",params:p,throwOnFailedPublish:!0});const d=To(Ao({},p),{topic:f,pairingTopic:o,acknowledged:!1,self:p.controller,peer:{publicKey:a.publicKey,metadata:a.metadata},controller:h});return await this.client.session.set(f,d),await this.setExpiry(f,M(vo)),{topic:f,acknowledged:()=>new Promise((t=>setTimeout((()=>t(this.client.session.get(f))),500)))}},this.reject=async t=>{await this.isInitialized(),await this.isValidReject(t);const{id:e,reason:r}=t,{pairingTopic:n}=this.client.proposal.get(e);n&&(await this.sendError(e,n,r),await this.client.proposal.delete(e,H("USER_DISCONNECTED")))},this.update=async t=>{await this.isInitialized(),await this.isValidUpdate(t);const{topic:e,namespaces:r}=t,n=await this.sendRequest({topic:e,method:"wc_sessionUpdate",params:{namespaces:r}}),{done:i,resolve:s,reject:o}=$();return this.events.once(U("session_update",n),(({error:t})=>{t?o(t):s()})),await this.client.session.update(e,{namespaces:r}),{acknowledged:i}},this.extend=async t=>{await this.isInitialized(),await this.isValidExtend(t);const{topic:e}=t,r=await this.sendRequest({topic:e,method:"wc_sessionExtend",params:{}}),{done:n,resolve:i,reject:s}=$();return this.events.once(U("session_extend",r),(({error:t})=>{t?s(t):i()})),await this.setExpiry(e,M(vo)),{acknowledged:n}},this.request=async t=>{await this.isInitialized(),await this.isValidRequest(t);const{chainId:e,request:r,topic:n,expiry:i}=t,s=Mr(),{done:o,resolve:a,reject:c}=$(i,"Request expired. Please try again.");return this.events.once(U("session_request",s),(({error:t,result:e})=>{t?c(t):a(e)})),await Promise.all([new Promise((async t=>{await this.sendRequest({clientRpcId:s,topic:n,method:"wc_sessionRequest",params:{request:r,chainId:e},expiry:i,throwOnFailedPublish:!0}).catch((t=>c(t))),this.client.events.emit("session_request_sent",{topic:n,request:r,chainId:e,id:s}),t()})),new Promise((async t=>{const e=await this.client.core.storage.getItem(go);ct({id:s,topic:n,wcDeepLink:e}),t()})),o()]).then((t=>t[2]))},this.respond=async t=>{await this.isInitialized(),await this.isValidRespond(t);const{topic:e,response:r}=t,{id:n}=r;Xr(r)?await this.sendResult({id:n,topic:e,result:r.result,throwOnFailedPublish:!0}):tn(r)&&await this.sendError(n,e,r.error),this.cleanupAfterResponse(t)},this.ping=async t=>{await this.isInitialized(),await this.isValidPing(t);const{topic:e}=t;if(this.client.session.keys.includes(e)){const t=await this.sendRequest({topic:e,method:"wc_sessionPing",params:{}}),{done:r,resolve:n,reject:i}=$();this.events.once(U("session_ping",t),(({error:t})=>{t?i(t):n()})),await r()}else this.client.core.pairing.pairings.keys.includes(e)&&await this.client.core.pairing.ping({topic:e})},this.emit=async t=>{await this.isInitialized(),await this.isValidEmit(t);const{topic:e,event:r,chainId:n}=t;await this.sendRequest({topic:e,method:"wc_sessionEvent",params:{event:r,chainId:n}})},this.disconnect=async t=>{await this.isInitialized(),await this.isValidDisconnect(t);const{topic:e}=t;this.client.session.keys.includes(e)?(await this.sendRequest({topic:e,method:"wc_sessionDelete",params:H("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession(e)):await this.client.core.pairing.disconnect({topic:e})},this.find=t=>(this.isInitialized(),this.client.session.getAll().filter((e=>ut(e,t)))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async t=>{if(t.pairingTopic)try{const e=this.client.core.pairing.pairings.get(t.pairingTopic),r=this.client.core.pairing.pairings.getAll().filter((r=>{var n,i;return(null==(n=r.peerMetadata)?void 0:n.url)&&(null==(i=r.peerMetadata)?void 0:i.url)===t.peer.metadata.url&&r.topic&&r.topic!==e.topic}));if(0===r.length)return;this.client.logger.info(`Cleaning up ${r.length} duplicate pairing(s)`),await Promise.all(r.map((t=>this.client.core.pairing.disconnect({topic:t.topic})))),this.client.logger.info("Duplicate pairings clean up finished")}catch(e){this.client.logger.error(e)}},this.deleteSession=async(t,e)=>{const{self:r}=this.client.session.get(t);await this.client.core.relayer.unsubscribe(t),this.client.session.delete(t,H("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(r.publicKey)&&await this.client.core.crypto.deleteKeyPair(r.publicKey),this.client.core.crypto.keychain.has(t)&&await this.client.core.crypto.deleteSymKey(t),e||this.client.core.expirer.del(t),this.client.core.storage.removeItem(go).catch((t=>this.client.logger.warn(t)))},this.deleteProposal=async(t,e)=>{await Promise.all([this.client.proposal.delete(t,H("USER_DISCONNECTED")),e?Promise.resolve():this.client.core.expirer.del(t)])},this.deletePendingSessionRequest=async(t,e,r=!1)=>{await Promise.all([this.client.pendingRequest.delete(t,e),r?Promise.resolve():this.client.core.expirer.del(t)]),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter((e=>e.id!==t)),r&&(this.sessionRequestQueue.state=_o)},this.setExpiry=async(t,e)=>{this.client.session.keys.includes(t)&&await this.client.session.update(t,{expiry:e}),this.client.core.expirer.set(t,e)},this.setProposal=async(t,e)=>{await this.client.proposal.set(t,e),this.client.core.expirer.set(t,e.expiry)},this.setPendingSessionRequest=async t=>{const e=mo.wc_sessionRequest.req.ttl,{id:r,topic:n,params:i,verifyContext:s}=t;await this.client.pendingRequest.set(r,{id:r,topic:n,params:i,verifyContext:s}),e&&this.client.core.expirer.set(r,M(e))},this.sendRequest=async t=>{const{topic:e,method:r,params:n,expiry:i,relayRpcId:s,clientRpcId:o,throwOnFailedPublish:a}=t,c=kr(r,n,o);if(J()&&Eo.includes(r)){const t=et(JSON.stringify(c));this.client.core.verify.register({attestationId:t})}const u=await this.client.core.crypto.encode(e,c),h=mo[r].req;return i&&(h.ttl=i),s&&(h.id=s),this.client.core.history.set(e,c),a?(h.internal=To(Ao({},h.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(e,u,h)):this.client.core.relayer.publish(e,u,h).catch((t=>this.client.logger.error(t))),c.id},this.sendResult=async t=>{const{id:e,topic:r,result:n,throwOnFailedPublish:i}=t,s=$r(e,n),o=await this.client.core.crypto.encode(r,s),a=await this.client.core.history.get(r,e),c=mo[a.request.method].res;i?(c.internal=To(Ao({},c.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(r,o,c)):this.client.core.relayer.publish(r,o,c).catch((t=>this.client.logger.error(t))),await this.client.core.history.resolve(s)},this.sendError=async(t,e,r)=>{const n=Ur(t,r),i=await this.client.core.crypto.encode(e,n),s=await this.client.core.history.get(e,t),o=mo[s.request.method].res;this.client.core.relayer.publish(e,i,o),await this.client.core.history.resolve(n)},this.cleanup=async()=>{const t=[],e=[];this.client.session.getAll().forEach((e=>{V(e.expiry)&&t.push(e.topic)})),this.client.proposal.getAll().forEach((t=>{V(t.expiry)&&e.push(t.id)})),await Promise.all([...t.map((t=>this.deleteSession(t))),...e.map((t=>this.deleteProposal(t)))])},this.onRelayEventRequest=async t=>{this.requestQueue.queue.push(t),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state!==bo){for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=bo;const e=this.requestQueue.queue.shift();if(e)try{this.processRequest(e),await new Promise((t=>setTimeout(t,300)))}catch(t){this.client.logger.warn(t)}}this.requestQueue.state=_o}else this.client.logger.info("Request queue already active, skipping...")},this.processRequest=t=>{const{topic:e,payload:r}=t,n=r.method;switch(n){case"wc_sessionPropose":return this.onSessionProposeRequest(e,r);case"wc_sessionSettle":return this.onSessionSettleRequest(e,r);case"wc_sessionUpdate":return this.onSessionUpdateRequest(e,r);case"wc_sessionExtend":return this.onSessionExtendRequest(e,r);case"wc_sessionPing":return this.onSessionPingRequest(e,r);case"wc_sessionDelete":return this.onSessionDeleteRequest(e,r);case"wc_sessionRequest":return this.onSessionRequest(e,r);case"wc_sessionEvent":return this.onSessionEventRequest(e,r);default:return this.client.logger.info(`Unsupported request method ${n}`)}},this.onRelayEventResponse=async t=>{const{topic:e,payload:r}=t,n=(await this.client.core.history.get(e,r.id)).request.method;switch(n){case"wc_sessionPropose":return this.onSessionProposeResponse(e,r);case"wc_sessionSettle":return this.onSessionSettleResponse(e,r);case"wc_sessionUpdate":return this.onSessionUpdateResponse(e,r);case"wc_sessionExtend":return this.onSessionExtendResponse(e,r);case"wc_sessionPing":return this.onSessionPingResponse(e,r);case"wc_sessionRequest":return this.onSessionRequestResponse(e,r);default:return this.client.logger.info(`Unsupported response method ${n}`)}},this.onRelayEventUnknownPayload=t=>{const{topic:e}=t,{message:r}=m("MISSING_OR_INVALID",`Decoded payload on topic ${e} is not identifiable as a JSON-RPC request or a response.`);throw new Error(r)},this.onSessionProposeRequest=async(t,e)=>{const{params:r,id:n}=e;try{this.isValidConnect(Ao({},e.params));const s=M(i.FIVE_MINUTES),o=Ao({id:n,pairingTopic:t,expiry:s},r);await this.setProposal(n,o);const a=et(JSON.stringify(e)),c=await this.getVerifyContext(a,o.proposer.metadata);this.client.events.emit("session_proposal",{id:n,params:o,verifyContext:c})}catch(He){await this.sendError(n,t,He),this.client.logger.error(He)}},this.onSessionProposeResponse=async(t,e)=>{const{id:r}=e;if(Xr(e)){const{result:n}=e;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:n});const i=this.client.proposal.get(r);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:i});const s=i.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:s});const o=n.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:o});const a=await this.client.core.crypto.generateSharedKey(s,o);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:a});const c=await this.client.core.relayer.subscribe(a);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:c}),await this.client.core.pairing.activate({topic:t})}else tn(e)&&(await this.client.proposal.delete(r,H("USER_DISCONNECTED")),this.events.emit(U("session_connect"),{error:e.error}))},this.onSessionSettleRequest=async(t,e)=>{const{id:r,params:n}=e;try{this.isValidSessionSettleRequest(n);const{relay:r,controller:i,expiry:s,namespaces:o,requiredNamespaces:a,optionalNamespaces:c,sessionProperties:u,pairingTopic:h}=e.params,l=Ao({topic:t,relay:r,expiry:s,namespaces:o,acknowledged:!0,pairingTopic:h,requiredNamespaces:a,optionalNamespaces:c,controller:i.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:i.publicKey,metadata:i.metadata}},u&&{sessionProperties:u});await this.sendResult({id:e.id,topic:t,result:!0}),this.events.emit(U("session_connect"),{session:l}),this.cleanupDuplicatePairings(l)}catch(He){await this.sendError(r,t,He),this.client.logger.error(He)}},this.onSessionSettleResponse=async(t,e)=>{const{id:r}=e;Xr(e)?(await this.client.session.update(t,{acknowledged:!0}),this.events.emit(U("session_approve",r),{})):tn(e)&&(await this.client.session.delete(t,H("USER_DISCONNECTED")),this.events.emit(U("session_approve",r),{error:e.error}))},this.onSessionUpdateRequest=async(t,e)=>{const{params:r,id:n}=e;try{const e=`${t}_session_update`,i=ht.get(e);if(i&&this.isRequestOutOfSync(i,n))return void this.client.logger.info(`Discarding out of sync request - ${n}`);this.isValidUpdate(Ao({topic:t},r)),await this.client.session.update(t,{namespaces:r.namespaces}),await this.sendResult({id:n,topic:t,result:!0}),this.client.events.emit("session_update",{id:n,topic:t,params:r}),ht.set(e,n)}catch(He){await this.sendError(n,t,He),this.client.logger.error(He)}},this.isRequestOutOfSync=(t,e)=>parseInt(e.toString().slice(0,-3))<=parseInt(t.toString().slice(0,-3)),this.onSessionUpdateResponse=(t,e)=>{const{id:r}=e;Xr(e)?this.events.emit(U("session_update",r),{}):tn(e)&&this.events.emit(U("session_update",r),{error:e.error})},this.onSessionExtendRequest=async(t,e)=>{const{id:r}=e;try{this.isValidExtend({topic:t}),await this.setExpiry(t,M(vo)),await this.sendResult({id:r,topic:t,result:!0}),this.client.events.emit("session_extend",{id:r,topic:t})}catch(n){await this.sendError(r,t,n),this.client.logger.error(n)}},this.onSessionExtendResponse=(t,e)=>{const{id:r}=e;Xr(e)?this.events.emit(U("session_extend",r),{}):tn(e)&&this.events.emit(U("session_extend",r),{error:e.error})},this.onSessionPingRequest=async(t,e)=>{const{id:r}=e;try{this.isValidPing({topic:t}),await this.sendResult({id:r,topic:t,result:!0}),this.client.events.emit("session_ping",{id:r,topic:t})}catch(n){await this.sendError(r,t,n),this.client.logger.error(n)}},this.onSessionPingResponse=(t,e)=>{const{id:r}=e;setTimeout((()=>{Xr(e)?this.events.emit(U("session_ping",r),{}):tn(e)&&this.events.emit(U("session_ping",r),{error:e.error})}),500)},this.onSessionDeleteRequest=async(t,e)=>{const{id:r}=e;try{this.isValidDisconnect({topic:t,reason:e.params}),await Promise.all([new Promise((e=>{this.client.core.relayer.once(Ji,(async()=>{e(await this.deleteSession(t))}))})),this.sendResult({id:r,topic:t,result:!0})]),this.client.events.emit("session_delete",{id:r,topic:t})}catch(n){this.client.logger.error(n)}},this.onSessionRequest=async(t,e)=>{const{id:r,params:n}=e;try{this.isValidRequest(Ao({topic:t},n));const e=et(JSON.stringify(kr("wc_sessionRequest",n,r))),i=this.client.session.get(t),s={id:r,topic:t,params:n,verifyContext:await this.getVerifyContext(e,i.peer.metadata)};await this.setPendingSessionRequest(s),this.addSessionRequestToSessionRequestQueue(s),this.processSessionRequestQueue()}catch(He){await this.sendError(r,t,He),this.client.logger.error(He)}},this.onSessionRequestResponse=(t,e)=>{const{id:r}=e;Xr(e)?this.events.emit(U("session_request",r),{result:e.result}):tn(e)&&this.events.emit(U("session_request",r),{error:e.error})},this.onSessionEventRequest=async(t,e)=>{const{id:r,params:n}=e;try{const e=`${t}_session_event_${n.event.name}`,i=ht.get(e);if(i&&this.isRequestOutOfSync(i,r))return void this.client.logger.info(`Discarding out of sync request - ${r}`);this.isValidEmit(Ao({topic:t},n)),this.client.events.emit("session_event",{id:r,topic:t,params:n}),ht.set(e,r)}catch(He){await this.sendError(r,t,He),this.client.logger.error(He)}},this.addSessionRequestToSessionRequestQueue=t=>{this.sessionRequestQueue.queue.push(t)},this.cleanupAfterResponse=t=>{this.deletePendingSessionRequest(t.response.id,{message:"fulfilled",code:0}),setTimeout((()=>{this.sessionRequestQueue.state=_o,this.processSessionRequestQueue()}),i.toMiliseconds(this.requestQueueDelay))},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===bo)return void this.client.logger.info("session request queue is already active.");const t=this.sessionRequestQueue.queue[0];if(t)try{this.sessionRequestQueue.state=bo,this.client.events.emit("session_request",t)}catch(e){this.client.logger.error(e)}else this.client.logger.info("session request queue is empty.")},this.onPairingCreated=t=>{if(t.active)return;const e=this.client.proposal.getAll().find((e=>e.pairingTopic===t.topic));e&&this.onSessionProposeRequest(t.topic,kr("wc_sessionPropose",{requiredNamespaces:e.requiredNamespaces,optionalNamespaces:e.optionalNamespaces,relays:e.relays,proposer:e.proposer},e.id))},this.isValidConnect=async t=>{if(!K(t)){const{message:e}=m("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(t)}`);throw new Error(e)}const{pairingTopic:e,requiredNamespaces:r,optionalNamespaces:n,sessionProperties:i,relays:s}=t;if(g(e)||await this.isValidPairingTopic(e),!lt(s,!0)){const{message:t}=m("MISSING_OR_INVALID",`connect() relays: ${s}`);throw new Error(t)}!g(r)&&0!==ot(r)&&this.validateNamespaces(r,"requiredNamespaces"),!g(n)&&0!==ot(n)&&this.validateNamespaces(n,"optionalNamespaces"),g(i)||this.validateSessionProps(i,"sessionProperties")},this.validateNamespaces=(t,e)=>{const r=ft(t,"connect()",e);if(r)throw new Error(r.message)},this.isValidApprove=async t=>{if(!K(t))throw new Error(m("MISSING_OR_INVALID",`approve() params: ${t}`).message);const{id:e,namespaces:r,relayProtocol:n,sessionProperties:i}=t;await this.isValidProposalId(e);const s=this.client.proposal.get(e),o=pt(r,"approve()");if(o)throw new Error(o.message);const a=dt(s.requiredNamespaces,r,"approve()");if(a)throw new Error(a.message);if(!F(n,!0)){const{message:t}=m("MISSING_OR_INVALID",`approve() relayProtocol: ${n}`);throw new Error(t)}g(i)||this.validateSessionProps(i,"sessionProperties")},this.isValidReject=async t=>{if(!K(t)){const{message:e}=m("MISSING_OR_INVALID",`reject() params: ${t}`);throw new Error(e)}const{id:e,reason:r}=t;if(await this.isValidProposalId(e),!gt(r)){const{message:t}=m("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(r)}`);throw new Error(t)}},this.isValidSessionSettleRequest=t=>{if(!K(t)){const{message:e}=m("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${t}`);throw new Error(e)}const{relay:e,controller:r,namespaces:n,expiry:i}=t;if(!yt(e)){const{message:t}=m("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(t)}const s=vt(r,"onSessionSettleRequest()");if(s)throw new Error(s.message);const o=pt(n,"onSessionSettleRequest()");if(o)throw new Error(o.message);if(V(i)){const{message:t}=m("EXPIRED","onSessionSettleRequest()");throw new Error(t)}},this.isValidUpdate=async t=>{if(!K(t)){const{message:e}=m("MISSING_OR_INVALID",`update() params: ${t}`);throw new Error(e)}const{topic:e,namespaces:r}=t;await this.isValidSessionTopic(e);const n=this.client.session.get(e),i=pt(r,"update()");if(i)throw new Error(i.message);const s=dt(n.requiredNamespaces,r,"update()");if(s)throw new Error(s.message)},this.isValidExtend=async t=>{if(!K(t)){const{message:e}=m("MISSING_OR_INVALID",`extend() params: ${t}`);throw new Error(e)}const{topic:e}=t;await this.isValidSessionTopic(e)},this.isValidRequest=async t=>{if(!K(t)){const{message:e}=m("MISSING_OR_INVALID",`request() params: ${t}`);throw new Error(e)}const{topic:e,request:r,chainId:n,expiry:i}=t;await this.isValidSessionTopic(e);const{namespaces:s}=this.client.session.get(e);if(!mt(s,n)){const{message:t}=m("MISSING_OR_INVALID",`request() chainId: ${n}`);throw new Error(t)}if(!wt(r)){const{message:t}=m("MISSING_OR_INVALID",`request() ${JSON.stringify(r)}`);throw new Error(t)}if(!_t(s,n,r.method)){const{message:t}=m("MISSING_OR_INVALID",`request() method: ${r.method}`);throw new Error(t)}if(i&&!bt(i,wo)){const{message:t}=m("MISSING_OR_INVALID",`request() expiry: ${i}. Expiry must be a number (in seconds) between ${wo.min} and ${wo.max}`);throw new Error(t)}},this.isValidRespond=async t=>{if(!K(t)){const{message:e}=m("MISSING_OR_INVALID",`respond() params: ${t}`);throw new Error(e)}const{topic:e,response:r}=t;if(await this.isValidSessionTopic(e),!Et(r)){const{message:t}=m("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(r)}`);throw new Error(t)}},this.isValidPing=async t=>{if(!K(t)){const{message:e}=m("MISSING_OR_INVALID",`ping() params: ${t}`);throw new Error(e)}const{topic:e}=t;await this.isValidSessionOrPairingTopic(e)},this.isValidEmit=async t=>{if(!K(t)){const{message:e}=m("MISSING_OR_INVALID",`emit() params: ${t}`);throw new Error(e)}const{topic:e,event:r,chainId:n}=t;await this.isValidSessionTopic(e);const{namespaces:i}=this.client.session.get(e);if(!mt(i,n)){const{message:t}=m("MISSING_OR_INVALID",`emit() chainId: ${n}`);throw new Error(t)}if(!It(r)){const{message:t}=m("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(r)}`);throw new Error(t)}if(!Pt(i,n,r.name)){const{message:t}=m("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(r)}`);throw new Error(t)}},this.isValidDisconnect=async t=>{if(!K(t)){const{message:e}=m("MISSING_OR_INVALID",`disconnect() params: ${t}`);throw new Error(e)}const{topic:e}=t;await this.isValidSessionOrPairingTopic(e)},this.getVerifyContext=async(t,e)=>{const r={verified:{verifyUrl:e.verifyUrl||Es,validation:"UNKNOWN",origin:e.url||""}};try{const n=await this.client.core.verify.resolve({attestationId:t,verifyUrl:e.verifyUrl});n&&(r.verified.origin=n.origin,r.verified.isScam=n.isScam,r.verified.validation=n.origin===new URL(e.url).origin?"VALID":"INVALID")}catch(n){this.client.logger.info(n)}return this.client.logger.info(`Verify context: ${JSON.stringify(r)}`),r},this.validateSessionProps=(t,e)=>{Object.values(t).forEach((t=>{if(!F(t,!1)){const{message:r}=m("MISSING_OR_INVALID",`${e} must be in Record<string, string> format. Received: ${JSON.stringify(t)}`);throw new Error(r)}}))}}async isInitialized(){if(!this.initialized){const{message:t}=m("NOT_INITIALIZED",this.name);throw new Error(t)}await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(Bi,(async t=>{const{topic:e,message:r}=t;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(r)))return;const n=await this.client.core.crypto.decode(e,r);try{Jr(n)?(this.client.core.history.set(e,n),this.onRelayEventRequest({topic:e,payload:n})):Zr(n)?(await this.client.core.history.resolve(n),await this.onRelayEventResponse({topic:e,payload:n}),this.client.core.history.delete(e,n.id)):this.onRelayEventUnknownPayload({topic:e,payload:n})}catch(i){this.client.logger.error(i)}}))}registerExpirerEvents(){this.client.core.expirer.on(ws,(async t=>{const{topic:e,id:r}=G(t.target);if(r&&this.client.pendingRequest.keys.includes(r))return await this.deletePendingSessionRequest(r,m("EXPIRED"),!0);e?this.client.session.keys.includes(e)&&(await this.deleteSession(e,!0),this.client.events.emit("session_expire",{topic:e})):r&&(await this.deleteProposal(r,!0),this.client.events.emit("proposal_expire",{id:r}))}))}registerPairingEvents(){this.client.core.pairing.events.on(us,(t=>this.onPairingCreated(t)))}isValidPairingTopic(t){if(!F(t,!1)){const{message:e}=m("MISSING_OR_INVALID",`pairing topic should be a string: ${t}`);throw new Error(e)}if(!this.client.core.pairing.pairings.keys.includes(t)){const{message:e}=m("NO_MATCHING_KEY",`pairing topic doesn't exist: ${t}`);throw new Error(e)}if(V(this.client.core.pairing.pairings.get(t).expiry)){const{message:e}=m("EXPIRED",`pairing topic: ${t}`);throw new Error(e)}}async isValidSessionTopic(t){if(!F(t,!1)){const{message:e}=m("MISSING_OR_INVALID",`session topic should be a string: ${t}`);throw new Error(e)}if(!this.client.session.keys.includes(t)){const{message:e}=m("NO_MATCHING_KEY",`session topic doesn't exist: ${t}`);throw new Error(e)}if(V(this.client.session.get(t).expiry)){await this.deleteSession(t);const{message:e}=m("EXPIRED",`session topic: ${t}`);throw new Error(e)}}async isValidSessionOrPairingTopic(t){if(this.client.session.keys.includes(t))await this.isValidSessionTopic(t);else{if(!this.client.core.pairing.pairings.keys.includes(t)){if(F(t,!1)){const{message:e}=m("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${t}`);throw new Error(e)}{const{message:e}=m("MISSING_OR_INVALID",`session or pairing topic should be a string: ${t}`);throw new Error(e)}}this.isValidPairingTopic(t)}}async isValidProposalId(t){if(!St(t)){const{message:e}=m("MISSING_OR_INVALID",`proposal id should be a number: ${t}`);throw new Error(e)}if(!this.client.proposal.keys.includes(t)){const{message:e}=m("NO_MATCHING_KEY",`proposal id doesn't exist: ${t}`);throw new Error(e)}if(V(this.client.proposal.get(t).expiry)){await this.deleteProposal(t);const{message:e}=m("EXPIRED",`proposal id: ${t}`);throw new Error(e)}}}class No extends Js{constructor(t,e){super(t,e,"proposal",lo),this.core=t,this.logger=e}}class Lo extends Js{constructor(t,e){super(t,e,"session",lo),this.core=t,this.logger=e}}class qo extends Js{constructor(t,e){super(t,e,"request",lo,(t=>t.id)),this.core=t,this.logger=e}}let Do=class t extends Je{constructor(t){super(t),this.protocol="wc",this.version=2,this.name=fo,this.events=new s.EventEmitter,this.on=(t,e)=>this.events.on(t,e),this.once=(t,e)=>this.events.once(t,e),this.off=(t,e)=>this.events.off(t,e),this.removeListener=(t,e)=>this.events.removeListener(t,e),this.removeAllListeners=t=>this.events.removeAllListeners(t),this.connect=async t=>{try{return await this.engine.connect(t)}catch(e){throw this.logger.error(e.message),e}},this.pair=async t=>{try{return await this.engine.pair(t)}catch(e){throw this.logger.error(e.message),e}},this.approve=async t=>{try{return await this.engine.approve(t)}catch(e){throw this.logger.error(e.message),e}},this.reject=async t=>{try{return await this.engine.reject(t)}catch(e){throw this.logger.error(e.message),e}},this.update=async t=>{try{return await this.engine.update(t)}catch(e){throw this.logger.error(e.message),e}},this.extend=async t=>{try{return await this.engine.extend(t)}catch(e){throw this.logger.error(e.message),e}},this.request=async t=>{try{return await this.engine.request(t)}catch(e){throw this.logger.error(e.message),e}},this.respond=async t=>{try{return await this.engine.respond(t)}catch(e){throw this.logger.error(e.message),e}},this.ping=async t=>{try{return await this.engine.ping(t)}catch(e){throw this.logger.error(e.message),e}},this.emit=async t=>{try{return await this.engine.emit(t)}catch(e){throw this.logger.error(e.message),e}},this.disconnect=async t=>{try{return await this.engine.disconnect(t)}catch(e){throw this.logger.error(e.message),e}},this.find=t=>{try{return this.engine.find(t)}catch(e){throw this.logger.error(e.message),e}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(t){throw this.logger.error(t.message),t}},this.name=(null==t?void 0:t.name)||fo,this.metadata=(null==t?void 0:t.metadata)||st();const e=typeof(null==t?void 0:t.logger)<"u"&&"string"!=typeof(null==t?void 0:t.logger)?t.logger:Pe.pino(Pe.getDefaultLoggerOptions({level:(null==t?void 0:t.logger)||po}));this.core=(null==t?void 0:t.core)||new uo(t),this.logger=Pe.generateChildLogger(e,this.name),this.session=new Lo(this.core,this.logger),this.proposal=new No(this.core,this.logger),this.pendingRequest=new qo(this.core,this.logger),this.engine=new jo(this)}static async init(e){const r=new t(e);return await r.initialize(),r}get context(){return Pe.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(t){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(t.message),t}}};var Mo={exports:{}};!function(t,e){var r="undefined"!=typeof self?self:n,i=function(){function t(){this.fetch=!1,this.DOMException=r.DOMException}return t.prototype=r,new t}();!function(t){!function(e){var r="URLSearchParams"in t,n="Symbol"in t&&"iterator"in Symbol,i="FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(t){return!1}}(),s="FormData"in t,o="ArrayBuffer"in t;if(o)var a=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],c=ArrayBuffer.isView||function(t){return t&&a.indexOf(Object.prototype.toString.call(t))>-1};function u(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function h(t){return"string"!=typeof t&&(t=String(t)),t}function l(t){var e={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return n&&(e[Symbol.iterator]=function(){return e}),e}function f(t){this.map={},t instanceof f?t.forEach((function(t,e){this.append(e,t)}),this):Array.isArray(t)?t.forEach((function(t){this.append(t[0],t[1])}),this):t&&Object.getOwnPropertyNames(t).forEach((function(e){this.append(e,t[e])}),this)}function p(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function d(t){return new Promise((function(e,r){t.onload=function(){e(t.result)},t.onerror=function(){r(t.error)}}))}function g(t){var e=new FileReader,r=d(e);return e.readAsArrayBuffer(t),r}function y(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function v(){return this.bodyUsed=!1,this._initBody=function(t){var e;this._bodyInit=t,t?"string"==typeof t?this._bodyText=t:i&&Blob.prototype.isPrototypeOf(t)?this._bodyBlob=t:s&&FormData.prototype.isPrototypeOf(t)?this._bodyFormData=t:r&&URLSearchParams.prototype.isPrototypeOf(t)?this._bodyText=t.toString():o&&i&&(e=t)&&DataView.prototype.isPrototypeOf(e)?(this._bodyArrayBuffer=y(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):o&&(ArrayBuffer.prototype.isPrototypeOf(t)||c(t))?this._bodyArrayBuffer=y(t):this._bodyText=t=Object.prototype.toString.call(t):this._bodyText="",this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):r&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},i&&(this.blob=function(){var t=p(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?p(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(g)}),this.text=function(){var t,e,r,n=p(this);if(n)return n;if(this._bodyBlob)return t=this._bodyBlob,e=new FileReader,r=d(e),e.readAsText(t),r;if(this._bodyArrayBuffer)return Promise.resolve(function(t){for(var e=new Uint8Array(t),r=new Array(e.length),n=0;n<e.length;n++)r[n]=String.fromCharCode(e[n]);return r.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},s&&(this.formData=function(){return this.text().then(_)}),this.json=function(){return this.text().then(JSON.parse)},this}f.prototype.append=function(t,e){t=u(t),e=h(e);var r=this.map[t];this.map[t]=r?r+", "+e:e},f.prototype.delete=function(t){delete this.map[u(t)]},f.prototype.get=function(t){return t=u(t),this.has(t)?this.map[t]:null},f.prototype.has=function(t){return this.map.hasOwnProperty(u(t))},f.prototype.set=function(t,e){this.map[u(t)]=h(e)},f.prototype.forEach=function(t,e){for(var r in this.map)this.map.hasOwnProperty(r)&&t.call(e,this.map[r],r,this)},f.prototype.keys=function(){var t=[];return this.forEach((function(e,r){t.push(r)})),l(t)},f.prototype.values=function(){var t=[];return this.forEach((function(e){t.push(e)})),l(t)},f.prototype.entries=function(){var t=[];return this.forEach((function(e,r){t.push([r,e])})),l(t)},n&&(f.prototype[Symbol.iterator]=f.prototype.entries);var m=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function w(t,e){var r,n,i=(e=e||{}).body;if(t instanceof w){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new f(t.headers)),this.method=t.method,this.mode=t.mode,this.signal=t.signal,i||null==t._bodyInit||(i=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"same-origin",!e.headers&&this.headers||(this.headers=new f(e.headers)),this.method=(r=e.method||this.method||"GET",n=r.toUpperCase(),m.indexOf(n)>-1?n:r),this.mode=e.mode||this.mode||null,this.signal=e.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&i)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(i)}function _(t){var e=new FormData;return t.trim().split("&").forEach((function(t){if(t){var r=t.split("="),n=r.shift().replace(/\+/g," "),i=r.join("=").replace(/\+/g," ");e.append(decodeURIComponent(n),decodeURIComponent(i))}})),e}function b(t,e){e||(e={}),this.type="default",this.status=void 0===e.status?200:e.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in e?e.statusText:"OK",this.headers=new f(e.headers),this.url=e.url||"",this._initBody(t)}w.prototype.clone=function(){return new w(this,{body:this._bodyInit})},v.call(w.prototype),v.call(b.prototype),b.prototype.clone=function(){return new b(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new f(this.headers),url:this.url})},b.error=function(){var t=new b(null,{status:0,statusText:""});return t.type="error",t};var E=[301,302,303,307,308];b.redirect=function(t,e){if(-1===E.indexOf(e))throw new RangeError("Invalid status code");return new b(null,{status:e,headers:{location:t}})},e.DOMException=t.DOMException;try{new e.DOMException}catch(P){e.DOMException=function(t,e){this.message=t,this.name=e;var r=Error(t);this.stack=r.stack},e.DOMException.prototype=Object.create(Error.prototype),e.DOMException.prototype.constructor=e.DOMException}function I(t,r){return new Promise((function(n,s){var o=new w(t,r);if(o.signal&&o.signal.aborted)return s(new e.DOMException("Aborted","AbortError"));var a=new XMLHttpRequest;function c(){a.abort()}a.onload=function(){var t,e,r={status:a.status,statusText:a.statusText,headers:(t=a.getAllResponseHeaders()||"",e=new f,t.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(t){var r=t.split(":"),n=r.shift().trim();if(n){var i=r.join(":").trim();e.append(n,i)}})),e)};r.url="responseURL"in a?a.responseURL:r.headers.get("X-Request-URL");var i="response"in a?a.response:a.responseText;n(new b(i,r))},a.onerror=function(){s(new TypeError("Network request failed"))},a.ontimeout=function(){s(new TypeError("Network request failed"))},a.onabort=function(){s(new e.DOMException("Aborted","AbortError"))},a.open(o.method,o.url,!0),"include"===o.credentials?a.withCredentials=!0:"omit"===o.credentials&&(a.withCredentials=!1),"responseType"in a&&i&&(a.responseType="blob"),o.headers.forEach((function(t,e){a.setRequestHeader(e,t)})),o.signal&&(o.signal.addEventListener("abort",c),a.onreadystatechange=function(){4===a.readyState&&o.signal.removeEventListener("abort",c)}),a.send(void 0===o._bodyInit?null:o._bodyInit)}))}I.polyfill=!0,t.fetch||(t.fetch=I,t.Headers=f,t.Request=w,t.Response=b),e.Headers=f,e.Request=w,e.Response=b,e.fetch=I,Object.defineProperty(e,"__esModule",{value:!0})}({})}(i),i.fetch.ponyfill=!0,delete i.fetch.polyfill;var s=i;(e=s.fetch).default=s.fetch,e.fetch=s.fetch,e.Headers=s.Headers,e.Request=s.Request,e.Response=s.Response,t.exports=e}(Mo,Mo.exports);const zo=d(Mo.exports),ko={headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST"};class $o{constructor(t,e=!1){if(this.url=t,this.disableProviderPing=e,this.events=new s.EventEmitter,this.isAvailable=!1,this.registering=!1,!Gr(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);this.url=t,this.disableProviderPing=e}get connected(){return this.isAvailable}get connecting(){return this.registering}on(t,e){this.events.on(t,e)}once(t,e){this.events.once(t,e)}off(t,e){this.events.off(t,e)}removeListener(t,e){this.events.removeListener(t,e)}async open(t=this.url){await this.register(t)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(t,e){this.isAvailable||await this.register();try{const e=er(t),r=await zo(this.url,Object.assign(Object.assign({},ko),{body:e})),n=await r.json();this.onPayload({data:n})}catch(r){this.onError(t.id,r)}}async register(t=this.url){if(!Gr(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise(((t,e)=>{this.events.once("register_error",(t=>{this.resetMaxListeners(),e(t)})),this.events.once("open",(()=>{if(this.resetMaxListeners(),void 0===this.isAvailable)return e(new Error("HTTP connection is missing or invalid"));t()}))}))}this.url=t,this.registering=!0;try{if(!this.disableProviderPing){const e=er({id:1,jsonrpc:"2.0",method:"test",params:[]});await zo(t,Object.assign(Object.assign({},ko),{body:e}))}this.onOpen()}catch(e){const t=this.parseError(e);throw this.events.emit("register_error",t),this.onClose(),t}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(t){if(void 0===t.data)return;const e="string"==typeof t.data?tr(t.data):t.data;this.events.emit("payload",e)}onError(t,e){const r=this.parseError(e),n=Ur(t,r.message||r.toString());this.events.emit("payload",n)}parseError(t,e=this.url){return Pr(t,e,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>10&&this.events.setMaxListeners(10)}}const Uo="error",Ho="wc@2:universal_provider:",Vo="default_chain_changed";var Ko=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof p<"u"?p:typeof self<"u"?self:{},Bo={exports:{}};
/**
             * @license
             * Lodash <https://lodash.com/>
             * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
             * Released under MIT license <https://lodash.com/license>
             * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
             * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
             */!function(t,e){(function(){var r,n="Expected a function",i="__lodash_hash_undefined__",s="__lodash_placeholder__",o=16,a=32,c=64,u=128,h=256,l=1/0,f=9007199254740991,p=NaN,d=4294967295,g=[["ary",u],["bind",1],["bindKey",2],["curry",8],["curryRight",o],["flip",512],["partial",a],["partialRight",c],["rearg",h]],y="[object Arguments]",v="[object Array]",m="[object Boolean]",w="[object Date]",_="[object Error]",b="[object Function]",E="[object GeneratorFunction]",I="[object Map]",P="[object Number]",S="[object Object]",O="[object Promise]",x="[object RegExp]",R="[object Set]",C="[object String]",A="[object Symbol]",T="[object WeakMap]",j="[object ArrayBuffer]",N="[object DataView]",L="[object Float32Array]",q="[object Float64Array]",D="[object Int8Array]",M="[object Int16Array]",z="[object Int32Array]",k="[object Uint8Array]",$="[object Uint8ClampedArray]",U="[object Uint16Array]",H="[object Uint32Array]",V=/\b__p \+= '';/g,K=/\b(__p \+=) '' \+/g,B=/(__e\(.*?\)|\b__t\)) \+\n'';/g,F=/&(?:amp|lt|gt|quot|#39);/g,G=/[&<>"']/g,W=RegExp(F.source),Q=RegExp(G.source),Y=/<%-([\s\S]+?)%>/g,J=/<%([\s\S]+?)%>/g,Z=/<%=([\s\S]+?)%>/g,X=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,tt=/^\w*$/,et=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,rt=/[\\^$.*+?()[\]{}|]/g,nt=RegExp(rt.source),it=/^\s+/,st=/\s/,ot=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,at=/\{\n\/\* \[wrapped with (.+)\] \*/,ct=/,? & /,ut=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ht=/[()=,{}\[\]\/\s]/,lt=/\\(\\)?/g,ft=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,pt=/\w*$/,dt=/^[-+]0x[0-9a-f]+$/i,gt=/^0b[01]+$/i,yt=/^\[object .+?Constructor\]$/,vt=/^0o[0-7]+$/i,mt=/^(?:0|[1-9]\d*)$/,wt=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,_t=/($^)/,bt=/['\n\r\u2028\u2029\\]/g,Et="\\ud800-\\udfff",It="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",Pt="\\u2700-\\u27bf",St="a-z\\xdf-\\xf6\\xf8-\\xff",Ot="A-Z\\xc0-\\xd6\\xd8-\\xde",xt="\\ufe0e\\ufe0f",Rt="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ct="[']",At="["+Et+"]",Tt="["+Rt+"]",jt="["+It+"]",Nt="\\d+",Lt="["+Pt+"]",qt="["+St+"]",Dt="[^"+Et+Rt+Nt+Pt+St+Ot+"]",Mt="\\ud83c[\\udffb-\\udfff]",zt="[^"+Et+"]",kt="(?:\\ud83c[\\udde6-\\uddff]){2}",$t="[\\ud800-\\udbff][\\udc00-\\udfff]",Ut="["+Ot+"]",Ht="\\u200d",Vt="(?:"+qt+"|"+Dt+")",Kt="(?:"+Ut+"|"+Dt+")",Bt="(?:['](?:d|ll|m|re|s|t|ve))?",Ft="(?:['](?:D|LL|M|RE|S|T|VE))?",Gt="(?:"+jt+"|"+Mt+")?",Wt="["+xt+"]?",Qt=Wt+Gt+"(?:"+Ht+"(?:"+[zt,kt,$t].join("|")+")"+Wt+Gt+")*",Yt="(?:"+[Lt,kt,$t].join("|")+")"+Qt,Jt="(?:"+[zt+jt+"?",jt,kt,$t,At].join("|")+")",Zt=RegExp(Ct,"g"),Xt=RegExp(jt,"g"),te=RegExp(Mt+"(?="+Mt+")|"+Jt+Qt,"g"),ee=RegExp([Ut+"?"+qt+"+"+Bt+"(?="+[Tt,Ut,"$"].join("|")+")",Kt+"+"+Ft+"(?="+[Tt,Ut+Vt,"$"].join("|")+")",Ut+"?"+Vt+"+"+Bt,Ut+"+"+Ft,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Nt,Yt].join("|"),"g"),re=RegExp("["+Ht+Et+It+xt+"]"),ne=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,ie=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],se=-1,oe={};oe[L]=oe[q]=oe[D]=oe[M]=oe[z]=oe[k]=oe[$]=oe[U]=oe[H]=!0,oe[y]=oe[v]=oe[j]=oe[m]=oe[N]=oe[w]=oe[_]=oe[b]=oe[I]=oe[P]=oe[S]=oe[x]=oe[R]=oe[C]=oe[T]=!1;var ae={};ae[y]=ae[v]=ae[j]=ae[N]=ae[m]=ae[w]=ae[L]=ae[q]=ae[D]=ae[M]=ae[z]=ae[I]=ae[P]=ae[S]=ae[x]=ae[R]=ae[C]=ae[A]=ae[k]=ae[$]=ae[U]=ae[H]=!0,ae[_]=ae[b]=ae[T]=!1;var ce={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},ue=parseFloat,he=parseInt,le="object"==typeof Ko&&Ko&&Ko.Object===Object&&Ko,fe="object"==typeof self&&self&&self.Object===Object&&self,pe=le||fe||Function("return this")(),de=e&&!e.nodeType&&e,ge=de&&t&&!t.nodeType&&t,ye=ge&&ge.exports===de,ve=ye&&le.process,me=function(){try{return ge&&ge.require&&ge.require("util").types||ve&&ve.binding&&ve.binding("util")}catch{}}(),we=me&&me.isArrayBuffer,_e=me&&me.isDate,be=me&&me.isMap,Ee=me&&me.isRegExp,Ie=me&&me.isSet,Pe=me&&me.isTypedArray;function Se(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}function Oe(t,e,r,n){for(var i=-1,s=null==t?0:t.length;++i<s;){var o=t[i];e(n,o,r(o),t)}return n}function xe(t,e){for(var r=-1,n=null==t?0:t.length;++r<n&&!1!==e(t[r],r,t););return t}function Re(t,e){for(var r=null==t?0:t.length;r--&&!1!==e(t[r],r,t););return t}function Ce(t,e){for(var r=-1,n=null==t?0:t.length;++r<n;)if(!e(t[r],r,t))return!1;return!0}function Ae(t,e){for(var r=-1,n=null==t?0:t.length,i=0,s=[];++r<n;){var o=t[r];e(o,r,t)&&(s[i++]=o)}return s}function Te(t,e){return!(null==t||!t.length)&&Ue(t,e,0)>-1}function je(t,e,r){for(var n=-1,i=null==t?0:t.length;++n<i;)if(r(e,t[n]))return!0;return!1}function Ne(t,e){for(var r=-1,n=null==t?0:t.length,i=Array(n);++r<n;)i[r]=e(t[r],r,t);return i}function Le(t,e){for(var r=-1,n=e.length,i=t.length;++r<n;)t[i+r]=e[r];return t}function qe(t,e,r,n){var i=-1,s=null==t?0:t.length;for(n&&s&&(r=t[++i]);++i<s;)r=e(r,t[i],i,t);return r}function De(t,e,r,n){var i=null==t?0:t.length;for(n&&i&&(r=t[--i]);i--;)r=e(r,t[i],i,t);return r}function Me(t,e){for(var r=-1,n=null==t?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1}var ze=Be("length");function ke(t,e,r){var n;return r(t,(function(t,r,i){if(e(t,r,i))return n=r,!1})),n}function $e(t,e,r,n){for(var i=t.length,s=r+(n?1:-1);n?s--:++s<i;)if(e(t[s],s,t))return s;return-1}function Ue(t,e,r){return e==e?function(t,e,r){for(var n=r-1,i=t.length;++n<i;)if(t[n]===e)return n;return-1}(t,e,r):$e(t,Ve,r)}function He(t,e,r,n){for(var i=r-1,s=t.length;++i<s;)if(n(t[i],e))return i;return-1}function Ve(t){return t!=t}function Ke(t,e){var r=null==t?0:t.length;return r?We(t,e)/r:p}function Be(t){return function(e){return null==e?r:e[t]}}function Fe(t){return function(e){return null==t?r:t[e]}}function Ge(t,e,r,n,i){return i(t,(function(t,i,s){r=n?(n=!1,t):e(r,t,i,s)})),r}function We(t,e){for(var n,i=-1,s=t.length;++i<s;){var o=e(t[i]);o!==r&&(n=n===r?o:n+o)}return n}function Qe(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}function Ye(t){return t&&t.slice(0,fr(t)+1).replace(it,"")}function Je(t){return function(e){return t(e)}}function Ze(t,e){return Ne(e,(function(e){return t[e]}))}function Xe(t,e){return t.has(e)}function tr(t,e){for(var r=-1,n=t.length;++r<n&&Ue(e,t[r],0)>-1;);return r}function er(t,e){for(var r=t.length;r--&&Ue(e,t[r],0)>-1;);return r}var rr=Fe({"":"A","":"A","":"A","":"A","":"A","":"A","":"a","":"a","":"a","":"a","":"a","":"a","":"C","":"c","":"D","":"d","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"N","":"n","":"O","":"O","":"O","":"O","":"O","":"O","":"o","":"o","":"o","":"o","":"o","":"o","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"Y","":"y","":"y","":"Ae","":"ae","":"Th","":"th","":"ss","":"A","":"A","":"A","":"a","":"a","":"a","":"C","":"C","":"C","":"C","":"c","":"c","":"c","":"c","":"D","":"D","":"d","":"d","":"E","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"e","":"G","":"G","":"G","":"G","":"g","":"g","":"g","":"g","":"H","":"H","":"h","":"h","":"I","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"i","":"J","":"j","":"K","":"k","":"k","":"L","":"L","":"L","":"L","":"L","":"l","":"l","":"l","":"l","":"l","":"N","":"N","":"N","":"N","":"n","":"n","":"n","":"n","":"O","":"O","":"O","":"o","":"o","":"o","":"R","":"R","":"R","":"r","":"r","":"r","":"S","":"S","":"S","":"S","":"s","":"s","":"s","":"s","":"T","":"T","":"T","":"t","":"t","":"t","":"U","":"U","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"u","":"u","":"W","":"w","":"Y","":"y","":"Y","":"Z","":"Z","":"Z","":"z","":"z","":"z","":"IJ","":"ij","":"Oe","":"oe","":"'n","":"s"}),nr=Fe({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function ir(t){return"\\"+ce[t]}function sr(t){return re.test(t)}function or(t){var e=-1,r=Array(t.size);return t.forEach((function(t,n){r[++e]=[n,t]})),r}function ar(t,e){return function(r){return t(e(r))}}function cr(t,e){for(var r=-1,n=t.length,i=0,o=[];++r<n;){var a=t[r];(a===e||a===s)&&(t[r]=s,o[i++]=r)}return o}function ur(t){var e=-1,r=Array(t.size);return t.forEach((function(t){r[++e]=t})),r}function hr(t){return sr(t)?function(t){for(var e=te.lastIndex=0;te.test(t);)++e;return e}(t):ze(t)}function lr(t){return sr(t)?function(t){return t.match(te)||[]}(t):function(t){return t.split("")}(t)}function fr(t){for(var e=t.length;e--&&st.test(t.charAt(e)););return e}var pr=Fe({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),dr=function t(e){var st=(e=null==e?pe:dr.defaults(pe.Object(),e,dr.pick(pe,ie))).Array,Et=e.Date,It=e.Error,Pt=e.Function,St=e.Math,Ot=e.Object,xt=e.RegExp,Rt=e.String,Ct=e.TypeError,At=st.prototype,Tt=Pt.prototype,jt=Ot.prototype,Nt=e["__core-js_shared__"],Lt=Tt.toString,qt=jt.hasOwnProperty,Dt=0,Mt=function(){var t=/[^.]+$/.exec(Nt&&Nt.keys&&Nt.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),zt=jt.toString,kt=Lt.call(Ot),$t=pe._,Ut=xt("^"+Lt.call(qt).replace(rt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ht=ye?e.Buffer:r,Vt=e.Symbol,Kt=e.Uint8Array,Bt=Ht?Ht.allocUnsafe:r,Ft=ar(Ot.getPrototypeOf,Ot),Gt=Ot.create,Wt=jt.propertyIsEnumerable,Qt=At.splice,Yt=Vt?Vt.isConcatSpreadable:r,Jt=Vt?Vt.iterator:r,te=Vt?Vt.toStringTag:r,re=function(){try{var t=hs(Ot,"defineProperty");return t({},"",{}),t}catch{}}(),ce=e.clearTimeout!==pe.clearTimeout&&e.clearTimeout,le=Et&&Et.now!==pe.Date.now&&Et.now,fe=e.setTimeout!==pe.setTimeout&&e.setTimeout,de=St.ceil,ge=St.floor,ve=Ot.getOwnPropertySymbols,me=Ht?Ht.isBuffer:r,ze=e.isFinite,Fe=At.join,gr=ar(Ot.keys,Ot),yr=St.max,vr=St.min,mr=Et.now,wr=e.parseInt,_r=St.random,br=At.reverse,Er=hs(e,"DataView"),Ir=hs(e,"Map"),Pr=hs(e,"Promise"),Sr=hs(e,"Set"),Or=hs(e,"WeakMap"),xr=hs(Ot,"create"),Rr=Or&&new Or,Cr={},Ar=Ds(Er),Tr=Ds(Ir),jr=Ds(Pr),Nr=Ds(Sr),Lr=Ds(Or),qr=Vt?Vt.prototype:r,Dr=qr?qr.valueOf:r,Mr=qr?qr.toString:r;function zr(t){if(ta(t)&&!Vo(t)&&!(t instanceof Hr)){if(t instanceof Ur)return t;if(qt.call(t,"__wrapped__"))return Ms(t)}return new Ur(t)}var kr=function(){function t(){}return function(e){if(!Xo(e))return{};if(Gt)return Gt(e);t.prototype=e;var n=new t;return t.prototype=r,n}}();function $r(){}function Ur(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=r}function Hr(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=d,this.__views__=[]}function Vr(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function Kr(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function Br(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function Fr(t){var e=-1,r=null==t?0:t.length;for(this.__data__=new Br;++e<r;)this.add(t[e])}function Gr(t){var e=this.__data__=new Kr(t);this.size=e.size}function Wr(t,e){var r=Vo(t),n=!r&&Ho(t),i=!r&&!n&&Go(t),s=!r&&!n&&!i&&ca(t),o=r||n||i||s,a=o?Qe(t.length,Rt):[],c=a.length;for(var u in t)(e||qt.call(t,u))&&(!o||!("length"==u||i&&("offset"==u||"parent"==u)||s&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||vs(u,c)))&&a.push(u);return a}function Qr(t){var e=t.length;return e?t[Gn(0,e-1)]:r}function Yr(t,e){return Ns(Ri(t),on(e,0,t.length))}function Jr(t){return Ns(Ri(t))}function Zr(t,e,n){(n!==r&&!ko(t[e],n)||n===r&&!(e in t))&&nn(t,e,n)}function Xr(t,e,n){var i=t[e];(!qt.call(t,e)||!ko(i,n)||n===r&&!(e in t))&&nn(t,e,n)}function tn(t,e){for(var r=t.length;r--;)if(ko(t[r][0],e))return r;return-1}function en(t,e,r,n){return ln(t,(function(t,i,s){e(n,t,r(t),s)})),n}function rn(t,e){return t&&Ci(e,Aa(e),t)}function nn(t,e,r){"__proto__"==e&&re?re(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}function sn(t,e){for(var n=-1,i=e.length,s=st(i),o=null==t;++n<i;)s[n]=o?r:Sa(t,e[n]);return s}function on(t,e,n){return t==t&&(n!==r&&(t=t<=n?t:n),e!==r&&(t=t>=e?t:e)),t}function an(t,e,n,i,s,o){var a,c=1&e,u=2&e,h=4&e;if(n&&(a=s?n(t,i,s,o):n(t)),a!==r)return a;if(!Xo(t))return t;var l=Vo(t);if(l){if(a=function(t){var e=t.length,r=new t.constructor(e);return e&&"string"==typeof t[0]&&qt.call(t,"index")&&(r.index=t.index,r.input=t.input),r}(t),!c)return Ri(t,a)}else{var f=ps(t),p=f==b||f==E;if(Go(t))return Ei(t,c);if(f==S||f==y||p&&!s){if(a=u||p?{}:gs(t),!c)return u?function(t,e){return Ci(t,fs(t),e)}(t,function(t,e){return t&&Ci(e,Ta(e),t)}(a,t)):function(t,e){return Ci(t,ls(t),e)}(t,rn(a,t))}else{if(!ae[f])return s?t:{};a=function(t,e,r){var n=t.constructor;switch(e){case j:return Ii(t);case m:case w:return new n(+t);case N:return function(t,e){var r=e?Ii(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.byteLength)}(t,r);case L:case q:case D:case M:case z:case k:case $:case U:case H:return Pi(t,r);case I:return new n;case P:case C:return new n(t);case x:return function(t){var e=new t.constructor(t.source,pt.exec(t));return e.lastIndex=t.lastIndex,e}(t);case R:return new n;case A:return function(t){return Dr?Ot(Dr.call(t)):{}}(t)}}(t,f,c)}}o||(o=new Gr);var d=o.get(t);if(d)return d;o.set(t,a),sa(t)?t.forEach((function(r){a.add(an(r,e,n,r,t,o))})):ea(t)&&t.forEach((function(r,i){a.set(i,an(r,e,n,i,t,o))}));var g=l?r:(h?u?ns:rs:u?Ta:Aa)(t);return xe(g||t,(function(r,i){g&&(r=t[i=r]),Xr(a,i,an(r,e,n,i,t,o))})),a}function cn(t,e,n){var i=n.length;if(null==t)return!i;for(t=Ot(t);i--;){var s=n[i],o=e[s],a=t[s];if(a===r&&!(s in t)||!o(a))return!1}return!0}function un(t,e,i){if("function"!=typeof t)throw new Ct(n);return Cs((function(){t.apply(r,i)}),e)}function hn(t,e,r,n){var i=-1,s=Te,o=!0,a=t.length,c=[],u=e.length;if(!a)return c;r&&(e=Ne(e,Je(r))),n?(s=je,o=!1):e.length>=200&&(s=Xe,o=!1,e=new Fr(e));t:for(;++i<a;){var h=t[i],l=null==r?h:r(h);if(h=n||0!==h?h:0,o&&l==l){for(var f=u;f--;)if(e[f]===l)continue t;c.push(h)}else s(e,l,n)||c.push(h)}return c}zr.templateSettings={escape:Y,evaluate:J,interpolate:Z,variable:"",imports:{_:zr}},zr.prototype=$r.prototype,zr.prototype.constructor=zr,Ur.prototype=kr($r.prototype),Ur.prototype.constructor=Ur,Hr.prototype=kr($r.prototype),Hr.prototype.constructor=Hr,Vr.prototype.clear=function(){this.__data__=xr?xr(null):{},this.size=0},Vr.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},Vr.prototype.get=function(t){var e=this.__data__;if(xr){var n=e[t];return n===i?r:n}return qt.call(e,t)?e[t]:r},Vr.prototype.has=function(t){var e=this.__data__;return xr?e[t]!==r:qt.call(e,t)},Vr.prototype.set=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=xr&&e===r?i:e,this},Kr.prototype.clear=function(){this.__data__=[],this.size=0},Kr.prototype.delete=function(t){var e=this.__data__,r=tn(e,t);return!(r<0||(r==e.length-1?e.pop():Qt.call(e,r,1),--this.size,0))},Kr.prototype.get=function(t){var e=this.__data__,n=tn(e,t);return n<0?r:e[n][1]},Kr.prototype.has=function(t){return tn(this.__data__,t)>-1},Kr.prototype.set=function(t,e){var r=this.__data__,n=tn(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this},Br.prototype.clear=function(){this.size=0,this.__data__={hash:new Vr,map:new(Ir||Kr),string:new Vr}},Br.prototype.delete=function(t){var e=cs(this,t).delete(t);return this.size-=e?1:0,e},Br.prototype.get=function(t){return cs(this,t).get(t)},Br.prototype.has=function(t){return cs(this,t).has(t)},Br.prototype.set=function(t,e){var r=cs(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this},Fr.prototype.add=Fr.prototype.push=function(t){return this.__data__.set(t,i),this},Fr.prototype.has=function(t){return this.__data__.has(t)},Gr.prototype.clear=function(){this.__data__=new Kr,this.size=0},Gr.prototype.delete=function(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r},Gr.prototype.get=function(t){return this.__data__.get(t)},Gr.prototype.has=function(t){return this.__data__.has(t)},Gr.prototype.set=function(t,e){var r=this.__data__;if(r instanceof Kr){var n=r.__data__;if(!Ir||n.length<199)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new Br(n)}return r.set(t,e),this.size=r.size,this};var ln=ji(wn),fn=ji(_n,!0);function pn(t,e){var r=!0;return ln(t,(function(t,n,i){return r=!!e(t,n,i)})),r}function dn(t,e,n){for(var i=-1,s=t.length;++i<s;){var o=t[i],a=e(o);if(null!=a&&(c===r?a==a&&!aa(a):n(a,c)))var c=a,u=o}return u}function gn(t,e){var r=[];return ln(t,(function(t,n,i){e(t,n,i)&&r.push(t)})),r}function yn(t,e,r,n,i){var s=-1,o=t.length;for(r||(r=ys),i||(i=[]);++s<o;){var a=t[s];e>0&&r(a)?e>1?yn(a,e-1,r,n,i):Le(i,a):n||(i[i.length]=a)}return i}var vn=Ni(),mn=Ni(!0);function wn(t,e){return t&&vn(t,e,Aa)}function _n(t,e){return t&&mn(t,e,Aa)}function bn(t,e){return Ae(e,(function(e){return Yo(t[e])}))}function En(t,e){for(var n=0,i=(e=mi(e,t)).length;null!=t&&n<i;)t=t[qs(e[n++])];return n&&n==i?t:r}function In(t,e,r){var n=e(t);return Vo(t)?n:Le(n,r(t))}function Pn(t){return null==t?t===r?"[object Undefined]":"[object Null]":te&&te in Ot(t)?function(t){var e=qt.call(t,te),n=t[te];try{t[te]=r;var i=!0}catch{}var s=zt.call(t);return i&&(e?t[te]=n:delete t[te]),s}(t):function(t){return zt.call(t)}(t)}function Sn(t,e){return t>e}function On(t,e){return null!=t&&qt.call(t,e)}function xn(t,e){return null!=t&&e in Ot(t)}function Rn(t,e,n){for(var i=n?je:Te,s=t[0].length,o=t.length,a=o,c=st(o),u=1/0,h=[];a--;){var l=t[a];a&&e&&(l=Ne(l,Je(e))),u=vr(l.length,u),c[a]=!n&&(e||s>=120&&l.length>=120)?new Fr(a&&l):r}l=t[0];var f=-1,p=c[0];t:for(;++f<s&&h.length<u;){var d=l[f],g=e?e(d):d;if(d=n||0!==d?d:0,!(p?Xe(p,g):i(h,g,n))){for(a=o;--a;){var y=c[a];if(!(y?Xe(y,g):i(t[a],g,n)))continue t}p&&p.push(g),h.push(d)}}return h}function Cn(t,e,n){var i=null==(t=Os(t,e=mi(e,t)))?t:t[qs(Ws(e))];return null==i?r:Se(i,t,n)}function An(t){return ta(t)&&Pn(t)==y}function Tn(t,e,n,i,s){return t===e||(null==t||null==e||!ta(t)&&!ta(e)?t!=t&&e!=e:function(t,e,n,i,s,o){var a=Vo(t),c=Vo(e),u=a?v:ps(t),h=c?v:ps(e),l=(u=u==y?S:u)==S,f=(h=h==y?S:h)==S,p=u==h;if(p&&Go(t)){if(!Go(e))return!1;a=!0,l=!1}if(p&&!l)return o||(o=new Gr),a||ca(t)?ts(t,e,n,i,s,o):function(t,e,r,n,i,s,o){switch(r){case N:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case j:return!(t.byteLength!=e.byteLength||!s(new Kt(t),new Kt(e)));case m:case w:case P:return ko(+t,+e);case _:return t.name==e.name&&t.message==e.message;case x:case C:return t==e+"";case I:var a=or;case R:var c=1&n;if(a||(a=ur),t.size!=e.size&&!c)return!1;var u=o.get(t);if(u)return u==e;n|=2,o.set(t,e);var h=ts(a(t),a(e),n,i,s,o);return o.delete(t),h;case A:if(Dr)return Dr.call(t)==Dr.call(e)}return!1}(t,e,u,n,i,s,o);if(!(1&n)){var d=l&&qt.call(t,"__wrapped__"),g=f&&qt.call(e,"__wrapped__");if(d||g){var b=d?t.value():t,E=g?e.value():e;return o||(o=new Gr),s(b,E,n,i,o)}}return!!p&&(o||(o=new Gr),function(t,e,n,i,s,o){var a=1&n,c=rs(t),u=c.length,h=rs(e),l=h.length;if(u!=l&&!a)return!1;for(var f=u;f--;){var p=c[f];if(!(a?p in e:qt.call(e,p)))return!1}var d=o.get(t),g=o.get(e);if(d&&g)return d==e&&g==t;var y=!0;o.set(t,e),o.set(e,t);for(var v=a;++f<u;){var m=t[p=c[f]],w=e[p];if(i)var _=a?i(w,m,p,e,t,o):i(m,w,p,t,e,o);if(!(_===r?m===w||s(m,w,n,i,o):_)){y=!1;break}v||(v="constructor"==p)}if(y&&!v){var b=t.constructor,E=e.constructor;b!=E&&"constructor"in t&&"constructor"in e&&!("function"==typeof b&&b instanceof b&&"function"==typeof E&&E instanceof E)&&(y=!1)}return o.delete(t),o.delete(e),y}(t,e,n,i,s,o))}(t,e,n,i,Tn,s))}function jn(t,e,n,i){var s=n.length,o=s,a=!i;if(null==t)return!o;for(t=Ot(t);s--;){var c=n[s];if(a&&c[2]?c[1]!==t[c[0]]:!(c[0]in t))return!1}for(;++s<o;){var u=(c=n[s])[0],h=t[u],l=c[1];if(a&&c[2]){if(h===r&&!(u in t))return!1}else{var f=new Gr;if(i)var p=i(h,l,u,t,e,f);if(!(p===r?Tn(l,h,3,i,f):p))return!1}}return!0}function Nn(t){return!(!Xo(t)||function(t){return!!Mt&&Mt in t}(t))&&(Yo(t)?Ut:yt).test(Ds(t))}function Ln(t){return"function"==typeof t?t:null==t?rc:"object"==typeof t?Vo(t)?$n(t[0],t[1]):kn(t):lc(t)}function qn(t){if(!Es(t))return gr(t);var e=[];for(var r in Ot(t))qt.call(t,r)&&"constructor"!=r&&e.push(r);return e}function Dn(t){if(!Xo(t))return function(t){var e=[];if(null!=t)for(var r in Ot(t))e.push(r);return e}(t);var e=Es(t),r=[];for(var n in t)"constructor"==n&&(e||!qt.call(t,n))||r.push(n);return r}function Mn(t,e){return t<e}function zn(t,e){var r=-1,n=Bo(t)?st(t.length):[];return ln(t,(function(t,i,s){n[++r]=e(t,i,s)})),n}function kn(t){var e=us(t);return 1==e.length&&e[0][2]?Ps(e[0][0],e[0][1]):function(r){return r===t||jn(r,t,e)}}function $n(t,e){return ws(t)&&Is(e)?Ps(qs(t),e):function(n){var i=Sa(n,t);return i===r&&i===e?Oa(n,t):Tn(e,i,3)}}function Un(t,e,n,i,s){t!==e&&vn(e,(function(o,a){if(s||(s=new Gr),Xo(o))!function(t,e,n,i,s,o,a){var c=xs(t,n),u=xs(e,n),h=a.get(u);if(h)Zr(t,n,h);else{var l=o?o(c,u,n+"",t,e,a):r,f=l===r;if(f){var p=Vo(u),d=!p&&Go(u),g=!p&&!d&&ca(u);l=u,p||d||g?Vo(c)?l=c:Fo(c)?l=Ri(c):d?(f=!1,l=Ei(u,!0)):g?(f=!1,l=Pi(u,!0)):l=[]:na(u)||Ho(u)?(l=c,Ho(c)?l=ya(c):(!Xo(c)||Yo(c))&&(l=gs(u))):f=!1}f&&(a.set(u,l),s(l,u,i,o,a),a.delete(u)),Zr(t,n,l)}}(t,e,a,n,Un,i,s);else{var c=i?i(xs(t,a),o,a+"",t,e,s):r;c===r&&(c=o),Zr(t,a,c)}}),Ta)}function Hn(t,e){var n=t.length;if(n)return vs(e+=e<0?n:0,n)?t[e]:r}function Vn(t,e,r){e=e.length?Ne(e,(function(t){return Vo(t)?function(e){return En(e,1===t.length?t[0]:t)}:t})):[rc];var n=-1;e=Ne(e,Je(as()));var i=zn(t,(function(t,r,i){var s=Ne(e,(function(e){return e(t)}));return{criteria:s,index:++n,value:t}}));return function(t,e){var r=t.length;for(t.sort(e);r--;)t[r]=t[r].value;return t}(i,(function(t,e){return function(t,e,r){for(var n=-1,i=t.criteria,s=e.criteria,o=i.length,a=r.length;++n<o;){var c=Si(i[n],s[n]);if(c)return n>=a?c:c*("desc"==r[n]?-1:1)}return t.index-e.index}(t,e,r)}))}function Kn(t,e,r){for(var n=-1,i=e.length,s={};++n<i;){var o=e[n],a=En(t,o);r(a,o)&&Zn(s,mi(o,t),a)}return s}function Bn(t,e,r,n){var i=n?He:Ue,s=-1,o=e.length,a=t;for(t===e&&(e=Ri(e)),r&&(a=Ne(t,Je(r)));++s<o;)for(var c=0,u=e[s],h=r?r(u):u;(c=i(a,h,c,n))>-1;)a!==t&&Qt.call(a,c,1),Qt.call(t,c,1);return t}function Fn(t,e){for(var r=t?e.length:0,n=r-1;r--;){var i=e[r];if(r==n||i!==s){var s=i;vs(i)?Qt.call(t,i,1):hi(t,i)}}return t}function Gn(t,e){return t+ge(_r()*(e-t+1))}function Wn(t,e){var r="";if(!t||e<1||e>f)return r;do{e%2&&(r+=t),(e=ge(e/2))&&(t+=t)}while(e);return r}function Qn(t,e){return As(Ss(t,e,rc),t+"")}function Yn(t){return Qr(ka(t))}function Jn(t,e){var r=ka(t);return Ns(r,on(e,0,r.length))}function Zn(t,e,n,i){if(!Xo(t))return t;for(var s=-1,o=(e=mi(e,t)).length,a=o-1,c=t;null!=c&&++s<o;){var u=qs(e[s]),h=n;if("__proto__"===u||"constructor"===u||"prototype"===u)return t;if(s!=a){var l=c[u];(h=i?i(l,u,c):r)===r&&(h=Xo(l)?l:vs(e[s+1])?[]:{})}Xr(c,u,h),c=c[u]}return t}var Xn=Rr?function(t,e){return Rr.set(t,e),t}:rc,ti=re?function(t,e){return re(t,"toString",{configurable:!0,enumerable:!1,value:Xa(e),writable:!0})}:rc;function ei(t){return Ns(ka(t))}function ri(t,e,r){var n=-1,i=t.length;e<0&&(e=-e>i?0:i+e),(r=r>i?i:r)<0&&(r+=i),i=e>r?0:r-e>>>0,e>>>=0;for(var s=st(i);++n<i;)s[n]=t[n+e];return s}function ni(t,e){var r;return ln(t,(function(t,n,i){return!(r=e(t,n,i))})),!!r}function ii(t,e,r){var n=0,i=null==t?n:t.length;if("number"==typeof e&&e==e&&i<=2147483647){for(;n<i;){var s=n+i>>>1,o=t[s];null!==o&&!aa(o)&&(r?o<=e:o<e)?n=s+1:i=s}return i}return si(t,e,rc,r)}function si(t,e,n,i){var s=0,o=null==t?0:t.length;if(0===o)return 0;for(var a=(e=n(e))!=e,c=null===e,u=aa(e),h=e===r;s<o;){var l=ge((s+o)/2),f=n(t[l]),p=f!==r,d=null===f,g=f==f,y=aa(f);if(a)var v=i||g;else v=h?g&&(i||p):c?g&&p&&(i||!d):u?g&&p&&!d&&(i||!y):!d&&!y&&(i?f<=e:f<e);v?s=l+1:o=l}return vr(o,4294967294)}function oi(t,e){for(var r=-1,n=t.length,i=0,s=[];++r<n;){var o=t[r],a=e?e(o):o;if(!r||!ko(a,c)){var c=a;s[i++]=0===o?0:o}}return s}function ai(t){return"number"==typeof t?t:aa(t)?p:+t}function ci(t){if("string"==typeof t)return t;if(Vo(t))return Ne(t,ci)+"";if(aa(t))return Mr?Mr.call(t):"";var e=t+"";return"0"==e&&1/t==-l?"-0":e}function ui(t,e,r){var n=-1,i=Te,s=t.length,o=!0,a=[],c=a;if(r)o=!1,i=je;else if(s>=200){var u=e?null:Wi(t);if(u)return ur(u);o=!1,i=Xe,c=new Fr}else c=e?[]:a;t:for(;++n<s;){var h=t[n],l=e?e(h):h;if(h=r||0!==h?h:0,o&&l==l){for(var f=c.length;f--;)if(c[f]===l)continue t;e&&c.push(l),a.push(h)}else i(c,l,r)||(c!==a&&c.push(l),a.push(h))}return a}function hi(t,e){return null==(t=Os(t,e=mi(e,t)))||delete t[qs(Ws(e))]}function li(t,e,r,n){return Zn(t,e,r(En(t,e)),n)}function fi(t,e,r,n){for(var i=t.length,s=n?i:-1;(n?s--:++s<i)&&e(t[s],s,t););return r?ri(t,n?0:s,n?s+1:i):ri(t,n?s+1:0,n?i:s)}function pi(t,e){var r=t;return r instanceof Hr&&(r=r.value()),qe(e,(function(t,e){return e.func.apply(e.thisArg,Le([t],e.args))}),r)}function di(t,e,r){var n=t.length;if(n<2)return n?ui(t[0]):[];for(var i=-1,s=st(n);++i<n;)for(var o=t[i],a=-1;++a<n;)a!=i&&(s[i]=hn(s[i]||o,t[a],e,r));return ui(yn(s,1),e,r)}function gi(t,e,n){for(var i=-1,s=t.length,o=e.length,a={};++i<s;){var c=i<o?e[i]:r;n(a,t[i],c)}return a}function yi(t){return Fo(t)?t:[]}function vi(t){return"function"==typeof t?t:rc}function mi(t,e){return Vo(t)?t:ws(t,e)?[t]:Ls(va(t))}var wi=Qn;function _i(t,e,n){var i=t.length;return n=n===r?i:n,!e&&n>=i?t:ri(t,e,n)}var bi=ce||function(t){return pe.clearTimeout(t)};function Ei(t,e){if(e)return t.slice();var r=t.length,n=Bt?Bt(r):new t.constructor(r);return t.copy(n),n}function Ii(t){var e=new t.constructor(t.byteLength);return new Kt(e).set(new Kt(t)),e}function Pi(t,e){var r=e?Ii(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)}function Si(t,e){if(t!==e){var n=t!==r,i=null===t,s=t==t,o=aa(t),a=e!==r,c=null===e,u=e==e,h=aa(e);if(!c&&!h&&!o&&t>e||o&&a&&u&&!c&&!h||i&&a&&u||!n&&u||!s)return 1;if(!i&&!o&&!h&&t<e||h&&n&&s&&!i&&!o||c&&n&&s||!a&&s||!u)return-1}return 0}function Oi(t,e,r,n){for(var i=-1,s=t.length,o=r.length,a=-1,c=e.length,u=yr(s-o,0),h=st(c+u),l=!n;++a<c;)h[a]=e[a];for(;++i<o;)(l||i<s)&&(h[r[i]]=t[i]);for(;u--;)h[a++]=t[i++];return h}function xi(t,e,r,n){for(var i=-1,s=t.length,o=-1,a=r.length,c=-1,u=e.length,h=yr(s-a,0),l=st(h+u),f=!n;++i<h;)l[i]=t[i];for(var p=i;++c<u;)l[p+c]=e[c];for(;++o<a;)(f||i<s)&&(l[p+r[o]]=t[i++]);return l}function Ri(t,e){var r=-1,n=t.length;for(e||(e=st(n));++r<n;)e[r]=t[r];return e}function Ci(t,e,n,i){var s=!n;n||(n={});for(var o=-1,a=e.length;++o<a;){var c=e[o],u=i?i(n[c],t[c],c,n,t):r;u===r&&(u=t[c]),s?nn(n,c,u):Xr(n,c,u)}return n}function Ai(t,e){return function(r,n){var i=Vo(r)?Oe:en,s=e?e():{};return i(r,t,as(n,2),s)}}function Ti(t){return Qn((function(e,n){var i=-1,s=n.length,o=s>1?n[s-1]:r,a=s>2?n[2]:r;for(o=t.length>3&&"function"==typeof o?(s--,o):r,a&&ms(n[0],n[1],a)&&(o=s<3?r:o,s=1),e=Ot(e);++i<s;){var c=n[i];c&&t(e,c,i,o)}return e}))}function ji(t,e){return function(r,n){if(null==r)return r;if(!Bo(r))return t(r,n);for(var i=r.length,s=e?i:-1,o=Ot(r);(e?s--:++s<i)&&!1!==n(o[s],s,o););return r}}function Ni(t){return function(e,r,n){for(var i=-1,s=Ot(e),o=n(e),a=o.length;a--;){var c=o[t?a:++i];if(!1===r(s[c],c,s))break}return e}}function Li(t){return function(e){var n=sr(e=va(e))?lr(e):r,i=n?n[0]:e.charAt(0),s=n?_i(n,1).join(""):e.slice(1);return i[t]()+s}}function qi(t){return function(e){return qe(Ya(Ha(e).replace(Zt,"")),t,"")}}function Di(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var r=kr(t.prototype),n=t.apply(r,e);return Xo(n)?n:r}}function Mi(t){return function(e,n,i){var s=Ot(e);if(!Bo(e)){var o=as(n,3);e=Aa(e),n=function(t){return o(s[t],t,s)}}var a=t(e,n,i);return a>-1?s[o?e[a]:a]:r}}function zi(t){return es((function(e){var i=e.length,s=i,o=Ur.prototype.thru;for(t&&e.reverse();s--;){var a=e[s];if("function"!=typeof a)throw new Ct(n);if(o&&!c&&"wrapper"==ss(a))var c=new Ur([],!0)}for(s=c?s:i;++s<i;){var u=ss(a=e[s]),h="wrapper"==u?is(a):r;c=h&&_s(h[0])&&424==h[1]&&!h[4].length&&1==h[9]?c[ss(h[0])].apply(c,h[3]):1==a.length&&_s(a)?c[u]():c.thru(a)}return function(){var t=arguments,r=t[0];if(c&&1==t.length&&Vo(r))return c.plant(r).value();for(var n=0,s=i?e[n].apply(this,t):r;++n<i;)s=e[n].call(this,s);return s}}))}function ki(t,e,n,i,s,o,a,c,h,l){var f=e&u,p=1&e,d=2&e,g=24&e,y=512&e,v=d?r:Di(t);return function u(){for(var m=arguments.length,w=st(m),_=m;_--;)w[_]=arguments[_];if(g)var b=os(u),E=function(t,e){for(var r=t.length,n=0;r--;)t[r]===e&&++n;return n}(w,b);if(i&&(w=Oi(w,i,s,g)),o&&(w=xi(w,o,a,g)),m-=E,g&&m<l){var I=cr(w,b);return Fi(t,e,ki,u.placeholder,n,w,I,c,h,l-m)}var P=p?n:this,S=d?P[t]:t;return m=w.length,c?w=function(t,e){for(var n=t.length,i=vr(e.length,n),s=Ri(t);i--;){var o=e[i];t[i]=vs(o,n)?s[o]:r}return t}(w,c):y&&m>1&&w.reverse(),f&&h<m&&(w.length=h),this&&this!==pe&&this instanceof u&&(S=v||Di(S)),S.apply(P,w)}}function $i(t,e){return function(r,n){return function(t,e,r,n){return wn(t,(function(t,i,s){e(n,r(t),i,s)})),n}(r,t,e(n),{})}}function Ui(t,e){return function(n,i){var s;if(n===r&&i===r)return e;if(n!==r&&(s=n),i!==r){if(s===r)return i;"string"==typeof n||"string"==typeof i?(n=ci(n),i=ci(i)):(n=ai(n),i=ai(i)),s=t(n,i)}return s}}function Hi(t){return es((function(e){return e=Ne(e,Je(as())),Qn((function(r){var n=this;return t(e,(function(t){return Se(t,n,r)}))}))}))}function Vi(t,e){var n=(e=e===r?" ":ci(e)).length;if(n<2)return n?Wn(e,t):e;var i=Wn(e,de(t/hr(e)));return sr(e)?_i(lr(i),0,t).join(""):i.slice(0,t)}function Ki(t){return function(e,n,i){return i&&"number"!=typeof i&&ms(e,n,i)&&(n=i=r),e=fa(e),n===r?(n=e,e=0):n=fa(n),function(t,e,r,n){for(var i=-1,s=yr(de((e-t)/(r||1)),0),o=st(s);s--;)o[n?s:++i]=t,t+=r;return o}(e,n,i=i===r?e<n?1:-1:fa(i),t)}}function Bi(t){return function(e,r){return"string"==typeof e&&"string"==typeof r||(e=ga(e),r=ga(r)),t(e,r)}}function Fi(t,e,n,i,s,o,u,h,l,f){var p=8&e;e|=p?a:c,4&(e&=~(p?c:a))||(e&=-4);var d=[t,e,s,p?o:r,p?u:r,p?r:o,p?r:u,h,l,f],g=n.apply(r,d);return _s(t)&&Rs(g,d),g.placeholder=i,Ts(g,t,e)}function Gi(t){var e=St[t];return function(t,r){if(t=ga(t),(r=null==r?0:vr(pa(r),292))&&ze(t)){var n=(va(t)+"e").split("e");return+((n=(va(e(n[0]+"e"+(+n[1]+r)))+"e").split("e"))[0]+"e"+(+n[1]-r))}return e(t)}}var Wi=Sr&&1/ur(new Sr([,-0]))[1]==l?function(t){return new Sr(t)}:ac;function Qi(t){return function(e){var r=ps(e);return r==I?or(e):r==R?function(t){var e=-1,r=Array(t.size);return t.forEach((function(t){r[++e]=[t,t]})),r}(e):function(t,e){return Ne(e,(function(e){return[e,t[e]]}))}(e,t(e))}}function Yi(t,e,i,l,f,p,d,g){var y=2&e;if(!y&&"function"!=typeof t)throw new Ct(n);var v=l?l.length:0;if(v||(e&=-97,l=f=r),d=d===r?d:yr(pa(d),0),g=g===r?g:pa(g),v-=f?f.length:0,e&c){var m=l,w=f;l=f=r}var _=y?r:is(t),b=[t,e,i,l,f,m,w,p,d,g];if(_&&function(t,e){var r=t[1],n=e[1],i=r|n,o=i<131,a=n==u&&8==r||n==u&&r==h&&t[7].length<=e[8]||384==n&&e[7].length<=e[8]&&8==r;if(!o&&!a)return t;1&n&&(t[2]=e[2],i|=1&r?0:4);var c=e[3];if(c){var l=t[3];t[3]=l?Oi(l,c,e[4]):c,t[4]=l?cr(t[3],s):e[4]}(c=e[5])&&(l=t[5],t[5]=l?xi(l,c,e[6]):c,t[6]=l?cr(t[5],s):e[6]),(c=e[7])&&(t[7]=c),n&u&&(t[8]=null==t[8]?e[8]:vr(t[8],e[8])),null==t[9]&&(t[9]=e[9]),t[0]=e[0],t[1]=i}(b,_),t=b[0],e=b[1],i=b[2],l=b[3],f=b[4],!(g=b[9]=b[9]===r?y?0:t.length:yr(b[9]-v,0))&&24&e&&(e&=-25),e&&1!=e)E=8==e||e==o?function(t,e,n){var i=Di(t);return function s(){for(var o=arguments.length,a=st(o),c=o,u=os(s);c--;)a[c]=arguments[c];var h=o<3&&a[0]!==u&&a[o-1]!==u?[]:cr(a,u);return(o-=h.length)<n?Fi(t,e,ki,s.placeholder,r,a,h,r,r,n-o):Se(this&&this!==pe&&this instanceof s?i:t,this,a)}}(t,e,g):e!=a&&33!=e||f.length?ki.apply(r,b):function(t,e,r,n){var i=1&e,s=Di(t);return function e(){for(var o=-1,a=arguments.length,c=-1,u=n.length,h=st(u+a),l=this&&this!==pe&&this instanceof e?s:t;++c<u;)h[c]=n[c];for(;a--;)h[c++]=arguments[++o];return Se(l,i?r:this,h)}}(t,e,i,l);else var E=function(t,e,r){var n=1&e,i=Di(t);return function e(){return(this&&this!==pe&&this instanceof e?i:t).apply(n?r:this,arguments)}}(t,e,i);return Ts((_?Xn:Rs)(E,b),t,e)}function Ji(t,e,n,i){return t===r||ko(t,jt[n])&&!qt.call(i,n)?e:t}function Zi(t,e,n,i,s,o){return Xo(t)&&Xo(e)&&(o.set(e,t),Un(t,e,r,Zi,o),o.delete(e)),t}function Xi(t){return na(t)?r:t}function ts(t,e,n,i,s,o){var a=1&n,c=t.length,u=e.length;if(c!=u&&!(a&&u>c))return!1;var h=o.get(t),l=o.get(e);if(h&&l)return h==e&&l==t;var f=-1,p=!0,d=2&n?new Fr:r;for(o.set(t,e),o.set(e,t);++f<c;){var g=t[f],y=e[f];if(i)var v=a?i(y,g,f,e,t,o):i(g,y,f,t,e,o);if(v!==r){if(v)continue;p=!1;break}if(d){if(!Me(e,(function(t,e){if(!Xe(d,e)&&(g===t||s(g,t,n,i,o)))return d.push(e)}))){p=!1;break}}else if(g!==y&&!s(g,y,n,i,o)){p=!1;break}}return o.delete(t),o.delete(e),p}function es(t){return As(Ss(t,r,Vs),t+"")}function rs(t){return In(t,Aa,ls)}function ns(t){return In(t,Ta,fs)}var is=Rr?function(t){return Rr.get(t)}:ac;function ss(t){for(var e=t.name+"",r=Cr[e],n=qt.call(Cr,e)?r.length:0;n--;){var i=r[n],s=i.func;if(null==s||s==t)return i.name}return e}function os(t){return(qt.call(zr,"placeholder")?zr:t).placeholder}function as(){var t=zr.iteratee||nc;return t=t===nc?Ln:t,arguments.length?t(arguments[0],arguments[1]):t}function cs(t,e){var r=t.__data__;return function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}(e)?r["string"==typeof e?"string":"hash"]:r.map}function us(t){for(var e=Aa(t),r=e.length;r--;){var n=e[r],i=t[n];e[r]=[n,i,Is(i)]}return e}function hs(t,e){var n=function(t,e){return null==t?r:t[e]}(t,e);return Nn(n)?n:r}var ls=ve?function(t){return null==t?[]:(t=Ot(t),Ae(ve(t),(function(e){return Wt.call(t,e)})))}:dc,fs=ve?function(t){for(var e=[];t;)Le(e,ls(t)),t=Ft(t);return e}:dc,ps=Pn;function ds(t,e,r){for(var n=-1,i=(e=mi(e,t)).length,s=!1;++n<i;){var o=qs(e[n]);if(!(s=null!=t&&r(t,o)))break;t=t[o]}return s||++n!=i?s:!!(i=null==t?0:t.length)&&Zo(i)&&vs(o,i)&&(Vo(t)||Ho(t))}function gs(t){return"function"!=typeof t.constructor||Es(t)?{}:kr(Ft(t))}function ys(t){return Vo(t)||Ho(t)||!!(Yt&&t&&t[Yt])}function vs(t,e){var r,n=typeof t;return!!(e=null!==(r=e)&&void 0!==r?r:f)&&("number"==n||"symbol"!=n&&mt.test(t))&&t>-1&&t%1==0&&t<e}function ms(t,e,r){if(!Xo(r))return!1;var n=typeof e;return!!("number"==n?Bo(r)&&vs(e,r.length):"string"==n&&e in r)&&ko(r[e],t)}function ws(t,e){if(Vo(t))return!1;var r=typeof t;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=t&&!aa(t))||tt.test(t)||!X.test(t)||null!=e&&t in Ot(e)}function _s(t){var e=ss(t),r=zr[e];if("function"!=typeof r||!(e in Hr.prototype))return!1;if(t===r)return!0;var n=is(r);return!!n&&t===n[0]}(Er&&ps(new Er(new ArrayBuffer(1)))!=N||Ir&&ps(new Ir)!=I||Pr&&ps(Pr.resolve())!=O||Sr&&ps(new Sr)!=R||Or&&ps(new Or)!=T)&&(ps=function(t){var e=Pn(t),n=e==S?t.constructor:r,i=n?Ds(n):"";if(i)switch(i){case Ar:return N;case Tr:return I;case jr:return O;case Nr:return R;case Lr:return T}return e});var bs=Nt?Yo:gc;function Es(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||jt)}function Is(t){return t==t&&!Xo(t)}function Ps(t,e){return function(n){return null!=n&&n[t]===e&&(e!==r||t in Ot(n))}}function Ss(t,e,n){return e=yr(e===r?t.length-1:e,0),function(){for(var r=arguments,i=-1,s=yr(r.length-e,0),o=st(s);++i<s;)o[i]=r[e+i];i=-1;for(var a=st(e+1);++i<e;)a[i]=r[i];return a[e]=n(o),Se(t,this,a)}}function Os(t,e){return e.length<2?t:En(t,ri(e,0,-1))}function xs(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}var Rs=js(Xn),Cs=fe||function(t,e){return pe.setTimeout(t,e)},As=js(ti);function Ts(t,e,r){var n=e+"";return As(t,function(t,e){var r=e.length;if(!r)return t;var n=r-1;return e[n]=(r>1?"& ":"")+e[n],e=e.join(r>2?", ":" "),t.replace(ot,"{\n/* [wrapped with "+e+"] */\n")}(n,function(t,e){return xe(g,(function(r){var n="_."+r[0];e&r[1]&&!Te(t,n)&&t.push(n)})),t.sort()}(function(t){var e=t.match(at);return e?e[1].split(ct):[]}(n),r)))}function js(t){var e=0,n=0;return function(){var i=mr(),s=16-(i-n);if(n=i,s>0){if(++e>=800)return arguments[0]}else e=0;return t.apply(r,arguments)}}function Ns(t,e){var n=-1,i=t.length,s=i-1;for(e=e===r?i:e;++n<e;){var o=Gn(n,s),a=t[o];t[o]=t[n],t[n]=a}return t.length=e,t}var Ls=function(t){var e=No(t,(function(t){return 500===r.size&&r.clear(),t})),r=e.cache;return e}((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(et,(function(t,r,n,i){e.push(n?i.replace(lt,"$1"):r||t)})),e}));function qs(t){if("string"==typeof t||aa(t))return t;var e=t+"";return"0"==e&&1/t==-l?"-0":e}function Ds(t){if(null!=t){try{return Lt.call(t)}catch{}try{return t+""}catch{}}return""}function Ms(t){if(t instanceof Hr)return t.clone();var e=new Ur(t.__wrapped__,t.__chain__);return e.__actions__=Ri(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}var zs=Qn((function(t,e){return Fo(t)?hn(t,yn(e,1,Fo,!0)):[]})),ks=Qn((function(t,e){var n=Ws(e);return Fo(n)&&(n=r),Fo(t)?hn(t,yn(e,1,Fo,!0),as(n,2)):[]})),$s=Qn((function(t,e){var n=Ws(e);return Fo(n)&&(n=r),Fo(t)?hn(t,yn(e,1,Fo,!0),r,n):[]}));function Us(t,e,r){var n=null==t?0:t.length;if(!n)return-1;var i=null==r?0:pa(r);return i<0&&(i=yr(n+i,0)),$e(t,as(e,3),i)}function Hs(t,e,n){var i=null==t?0:t.length;if(!i)return-1;var s=i-1;return n!==r&&(s=pa(n),s=n<0?yr(i+s,0):vr(s,i-1)),$e(t,as(e,3),s,!0)}function Vs(t){return null!=t&&t.length?yn(t,1):[]}function Ks(t){return t&&t.length?t[0]:r}var Bs=Qn((function(t){var e=Ne(t,yi);return e.length&&e[0]===t[0]?Rn(e):[]})),Fs=Qn((function(t){var e=Ws(t),n=Ne(t,yi);return e===Ws(n)?e=r:n.pop(),n.length&&n[0]===t[0]?Rn(n,as(e,2)):[]})),Gs=Qn((function(t){var e=Ws(t),n=Ne(t,yi);return(e="function"==typeof e?e:r)&&n.pop(),n.length&&n[0]===t[0]?Rn(n,r,e):[]}));function Ws(t){var e=null==t?0:t.length;return e?t[e-1]:r}var Qs=Qn(Ys);function Ys(t,e){return t&&t.length&&e&&e.length?Bn(t,e):t}var Js=es((function(t,e){var r=null==t?0:t.length,n=sn(t,e);return Fn(t,Ne(e,(function(t){return vs(t,r)?+t:t})).sort(Si)),n}));function Zs(t){return null==t?t:br.call(t)}var Xs=Qn((function(t){return ui(yn(t,1,Fo,!0))})),to=Qn((function(t){var e=Ws(t);return Fo(e)&&(e=r),ui(yn(t,1,Fo,!0),as(e,2))})),eo=Qn((function(t){var e=Ws(t);return e="function"==typeof e?e:r,ui(yn(t,1,Fo,!0),r,e)}));function ro(t){if(!t||!t.length)return[];var e=0;return t=Ae(t,(function(t){if(Fo(t))return e=yr(t.length,e),!0})),Qe(e,(function(e){return Ne(t,Be(e))}))}function no(t,e){if(!t||!t.length)return[];var n=ro(t);return null==e?n:Ne(n,(function(t){return Se(e,r,t)}))}var io=Qn((function(t,e){return Fo(t)?hn(t,e):[]})),so=Qn((function(t){return di(Ae(t,Fo))})),oo=Qn((function(t){var e=Ws(t);return Fo(e)&&(e=r),di(Ae(t,Fo),as(e,2))})),ao=Qn((function(t){var e=Ws(t);return e="function"==typeof e?e:r,di(Ae(t,Fo),r,e)})),co=Qn(ro),uo=Qn((function(t){var e=t.length,n=e>1?t[e-1]:r;return n="function"==typeof n?(t.pop(),n):r,no(t,n)}));function ho(t){var e=zr(t);return e.__chain__=!0,e}function lo(t,e){return e(t)}var fo=es((function(t){var e=t.length,n=e?t[0]:0,i=this.__wrapped__,s=function(e){return sn(e,t)};return!(e>1||this.__actions__.length)&&i instanceof Hr&&vs(n)?((i=i.slice(n,+n+(e?1:0))).__actions__.push({func:lo,args:[s],thisArg:r}),new Ur(i,this.__chain__).thru((function(t){return e&&!t.length&&t.push(r),t}))):this.thru(s)})),po=Ai((function(t,e,r){qt.call(t,r)?++t[r]:nn(t,r,1)})),go=Mi(Us),yo=Mi(Hs);function vo(t,e){return(Vo(t)?xe:ln)(t,as(e,3))}function mo(t,e){return(Vo(t)?Re:fn)(t,as(e,3))}var wo=Ai((function(t,e,r){qt.call(t,r)?t[r].push(e):nn(t,r,[e])})),_o=Qn((function(t,e,r){var n=-1,i="function"==typeof e,s=Bo(t)?st(t.length):[];return ln(t,(function(t){s[++n]=i?Se(e,t,r):Cn(t,e,r)})),s})),bo=Ai((function(t,e,r){nn(t,r,e)}));function Eo(t,e){return(Vo(t)?Ne:zn)(t,as(e,3))}var Io=Ai((function(t,e,r){t[r?0:1].push(e)}),(function(){return[[],[]]})),Po=Qn((function(t,e){if(null==t)return[];var r=e.length;return r>1&&ms(t,e[0],e[1])?e=[]:r>2&&ms(e[0],e[1],e[2])&&(e=[e[0]]),Vn(t,yn(e,1),[])})),So=le||function(){return pe.Date.now()};function Oo(t,e,n){return e=n?r:e,e=t&&null==e?t.length:e,Yi(t,u,r,r,r,r,e)}function xo(t,e){var i;if("function"!=typeof e)throw new Ct(n);return t=pa(t),function(){return--t>0&&(i=e.apply(this,arguments)),t<=1&&(e=r),i}}var Ro=Qn((function(t,e,r){var n=1;if(r.length){var i=cr(r,os(Ro));n|=a}return Yi(t,n,e,r,i)})),Co=Qn((function(t,e,r){var n=3;if(r.length){var i=cr(r,os(Co));n|=a}return Yi(e,n,t,r,i)}));function Ao(t,e,i){var s,o,a,c,u,h,l=0,f=!1,p=!1,d=!0;if("function"!=typeof t)throw new Ct(n);function g(e){var n=s,i=o;return s=o=r,l=e,c=t.apply(i,n)}function y(t){var n=t-h;return h===r||n>=e||n<0||p&&t-l>=a}function v(){var t=So();if(y(t))return m(t);u=Cs(v,function(t){var r=e-(t-h);return p?vr(r,a-(t-l)):r}(t))}function m(t){return u=r,d&&s?g(t):(s=o=r,c)}function w(){var t=So(),n=y(t);if(s=arguments,o=this,h=t,n){if(u===r)return function(t){return l=t,u=Cs(v,e),f?g(t):c}(h);if(p)return bi(u),u=Cs(v,e),g(h)}return u===r&&(u=Cs(v,e)),c}return e=ga(e)||0,Xo(i)&&(f=!!i.leading,a=(p="maxWait"in i)?yr(ga(i.maxWait)||0,e):a,d="trailing"in i?!!i.trailing:d),w.cancel=function(){u!==r&&bi(u),l=0,s=h=o=u=r},w.flush=function(){return u===r?c:m(So())},w}var To=Qn((function(t,e){return un(t,1,e)})),jo=Qn((function(t,e,r){return un(t,ga(e)||0,r)}));function No(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new Ct(n);var r=function(){var n=arguments,i=e?e.apply(this,n):n[0],s=r.cache;if(s.has(i))return s.get(i);var o=t.apply(this,n);return r.cache=s.set(i,o)||s,o};return r.cache=new(No.Cache||Br),r}function Lo(t){if("function"!=typeof t)throw new Ct(n);return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}No.Cache=Br;var qo=wi((function(t,e){var r=(e=1==e.length&&Vo(e[0])?Ne(e[0],Je(as())):Ne(yn(e,1),Je(as()))).length;return Qn((function(n){for(var i=-1,s=vr(n.length,r);++i<s;)n[i]=e[i].call(this,n[i]);return Se(t,this,n)}))})),Do=Qn((function(t,e){var n=cr(e,os(Do));return Yi(t,a,r,e,n)})),Mo=Qn((function(t,e){var n=cr(e,os(Mo));return Yi(t,c,r,e,n)})),zo=es((function(t,e){return Yi(t,h,r,r,r,e)}));function ko(t,e){return t===e||t!=t&&e!=e}var $o=Bi(Sn),Uo=Bi((function(t,e){return t>=e})),Ho=An(function(){return arguments}())?An:function(t){return ta(t)&&qt.call(t,"callee")&&!Wt.call(t,"callee")},Vo=st.isArray,Ko=we?Je(we):function(t){return ta(t)&&Pn(t)==j};function Bo(t){return null!=t&&Zo(t.length)&&!Yo(t)}function Fo(t){return ta(t)&&Bo(t)}var Go=me||gc,Wo=_e?Je(_e):function(t){return ta(t)&&Pn(t)==w};function Qo(t){if(!ta(t))return!1;var e=Pn(t);return e==_||"[object DOMException]"==e||"string"==typeof t.message&&"string"==typeof t.name&&!na(t)}function Yo(t){if(!Xo(t))return!1;var e=Pn(t);return e==b||e==E||"[object AsyncFunction]"==e||"[object Proxy]"==e}function Jo(t){return"number"==typeof t&&t==pa(t)}function Zo(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=f}function Xo(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function ta(t){return null!=t&&"object"==typeof t}var ea=be?Je(be):function(t){return ta(t)&&ps(t)==I};function ra(t){return"number"==typeof t||ta(t)&&Pn(t)==P}function na(t){if(!ta(t)||Pn(t)!=S)return!1;var e=Ft(t);if(null===e)return!0;var r=qt.call(e,"constructor")&&e.constructor;return"function"==typeof r&&r instanceof r&&Lt.call(r)==kt}var ia=Ee?Je(Ee):function(t){return ta(t)&&Pn(t)==x},sa=Ie?Je(Ie):function(t){return ta(t)&&ps(t)==R};function oa(t){return"string"==typeof t||!Vo(t)&&ta(t)&&Pn(t)==C}function aa(t){return"symbol"==typeof t||ta(t)&&Pn(t)==A}var ca=Pe?Je(Pe):function(t){return ta(t)&&Zo(t.length)&&!!oe[Pn(t)]},ua=Bi(Mn),ha=Bi((function(t,e){return t<=e}));function la(t){if(!t)return[];if(Bo(t))return oa(t)?lr(t):Ri(t);if(Jt&&t[Jt])return function(t){for(var e,r=[];!(e=t.next()).done;)r.push(e.value);return r}(t[Jt]());var e=ps(t);return(e==I?or:e==R?ur:ka)(t)}function fa(t){return t?(t=ga(t))===l||t===-l?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0}function pa(t){var e=fa(t),r=e%1;return e==e?r?e-r:e:0}function da(t){return t?on(pa(t),0,d):0}function ga(t){if("number"==typeof t)return t;if(aa(t))return p;if(Xo(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=Xo(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=Ye(t);var r=gt.test(t);return r||vt.test(t)?he(t.slice(2),r?2:8):dt.test(t)?p:+t}function ya(t){return Ci(t,Ta(t))}function va(t){return null==t?"":ci(t)}var ma=Ti((function(t,e){if(Es(e)||Bo(e))Ci(e,Aa(e),t);else for(var r in e)qt.call(e,r)&&Xr(t,r,e[r])})),wa=Ti((function(t,e){Ci(e,Ta(e),t)})),_a=Ti((function(t,e,r,n){Ci(e,Ta(e),t,n)})),ba=Ti((function(t,e,r,n){Ci(e,Aa(e),t,n)})),Ea=es(sn),Ia=Qn((function(t,e){t=Ot(t);var n=-1,i=e.length,s=i>2?e[2]:r;for(s&&ms(e[0],e[1],s)&&(i=1);++n<i;)for(var o=e[n],a=Ta(o),c=-1,u=a.length;++c<u;){var h=a[c],l=t[h];(l===r||ko(l,jt[h])&&!qt.call(t,h))&&(t[h]=o[h])}return t})),Pa=Qn((function(t){return t.push(r,Zi),Se(Na,r,t)}));function Sa(t,e,n){var i=null==t?r:En(t,e);return i===r?n:i}function Oa(t,e){return null!=t&&ds(t,e,xn)}var xa=$i((function(t,e,r){null!=e&&"function"!=typeof e.toString&&(e=zt.call(e)),t[e]=r}),Xa(rc)),Ra=$i((function(t,e,r){null!=e&&"function"!=typeof e.toString&&(e=zt.call(e)),qt.call(t,e)?t[e].push(r):t[e]=[r]}),as),Ca=Qn(Cn);function Aa(t){return Bo(t)?Wr(t):qn(t)}function Ta(t){return Bo(t)?Wr(t,!0):Dn(t)}var ja=Ti((function(t,e,r){Un(t,e,r)})),Na=Ti((function(t,e,r,n){Un(t,e,r,n)})),La=es((function(t,e){var r={};if(null==t)return r;var n=!1;e=Ne(e,(function(e){return e=mi(e,t),n||(n=e.length>1),e})),Ci(t,ns(t),r),n&&(r=an(r,7,Xi));for(var i=e.length;i--;)hi(r,e[i]);return r})),qa=es((function(t,e){return null==t?{}:function(t,e){return Kn(t,e,(function(e,r){return Oa(t,r)}))}(t,e)}));function Da(t,e){if(null==t)return{};var r=Ne(ns(t),(function(t){return[t]}));return e=as(e),Kn(t,r,(function(t,r){return e(t,r[0])}))}var Ma=Qi(Aa),za=Qi(Ta);function ka(t){return null==t?[]:Ze(t,Aa(t))}var $a=qi((function(t,e,r){return e=e.toLowerCase(),t+(r?Ua(e):e)}));function Ua(t){return Qa(va(t).toLowerCase())}function Ha(t){return(t=va(t))&&t.replace(wt,rr).replace(Xt,"")}var Va=qi((function(t,e,r){return t+(r?"-":"")+e.toLowerCase()})),Ka=qi((function(t,e,r){return t+(r?" ":"")+e.toLowerCase()})),Ba=Li("toLowerCase"),Fa=qi((function(t,e,r){return t+(r?"_":"")+e.toLowerCase()})),Ga=qi((function(t,e,r){return t+(r?" ":"")+Qa(e)})),Wa=qi((function(t,e,r){return t+(r?" ":"")+e.toUpperCase()})),Qa=Li("toUpperCase");function Ya(t,e,n){return t=va(t),(e=n?r:e)===r?function(t){return ne.test(t)}(t)?function(t){return t.match(ee)||[]}(t):function(t){return t.match(ut)||[]}(t):t.match(e)||[]}var Ja=Qn((function(t,e){try{return Se(t,r,e)}catch(n){return Qo(n)?n:new It(n)}})),Za=es((function(t,e){return xe(e,(function(e){e=qs(e),nn(t,e,Ro(t[e],t))})),t}));function Xa(t){return function(){return t}}var tc=zi(),ec=zi(!0);function rc(t){return t}function nc(t){return Ln("function"==typeof t?t:an(t,1))}var ic=Qn((function(t,e){return function(r){return Cn(r,t,e)}})),sc=Qn((function(t,e){return function(r){return Cn(t,r,e)}}));function oc(t,e,r){var n=Aa(e),i=bn(e,n);null==r&&(!Xo(e)||!i.length&&n.length)&&(r=e,e=t,t=this,i=bn(e,Aa(e)));var s=!(Xo(r)&&"chain"in r&&!r.chain),o=Yo(t);return xe(i,(function(r){var n=e[r];t[r]=n,o&&(t.prototype[r]=function(){var e=this.__chain__;if(s||e){var r=t(this.__wrapped__);return(r.__actions__=Ri(this.__actions__)).push({func:n,args:arguments,thisArg:t}),r.__chain__=e,r}return n.apply(t,Le([this.value()],arguments))})})),t}function ac(){}var cc=Hi(Ne),uc=Hi(Ce),hc=Hi(Me);function lc(t){return ws(t)?Be(qs(t)):function(t){return function(e){return En(e,t)}}(t)}var fc=Ki(),pc=Ki(!0);function dc(){return[]}function gc(){return!1}var yc=Ui((function(t,e){return t+e}),0),vc=Gi("ceil"),mc=Ui((function(t,e){return t/e}),1),wc=Gi("floor"),_c=Ui((function(t,e){return t*e}),1),bc=Gi("round"),Ec=Ui((function(t,e){return t-e}),0);return zr.after=function(t,e){if("function"!=typeof e)throw new Ct(n);return t=pa(t),function(){if(--t<1)return e.apply(this,arguments)}},zr.ary=Oo,zr.assign=ma,zr.assignIn=wa,zr.assignInWith=_a,zr.assignWith=ba,zr.at=Ea,zr.before=xo,zr.bind=Ro,zr.bindAll=Za,zr.bindKey=Co,zr.castArray=function(){if(!arguments.length)return[];var t=arguments[0];return Vo(t)?t:[t]},zr.chain=ho,zr.chunk=function(t,e,n){e=(n?ms(t,e,n):e===r)?1:yr(pa(e),0);var i=null==t?0:t.length;if(!i||e<1)return[];for(var s=0,o=0,a=st(de(i/e));s<i;)a[o++]=ri(t,s,s+=e);return a},zr.compact=function(t){for(var e=-1,r=null==t?0:t.length,n=0,i=[];++e<r;){var s=t[e];s&&(i[n++]=s)}return i},zr.concat=function(){var t=arguments.length;if(!t)return[];for(var e=st(t-1),r=arguments[0],n=t;n--;)e[n-1]=arguments[n];return Le(Vo(r)?Ri(r):[r],yn(e,1))},zr.cond=function(t){var e=null==t?0:t.length,r=as();return t=e?Ne(t,(function(t){if("function"!=typeof t[1])throw new Ct(n);return[r(t[0]),t[1]]})):[],Qn((function(r){for(var n=-1;++n<e;){var i=t[n];if(Se(i[0],this,r))return Se(i[1],this,r)}}))},zr.conforms=function(t){return function(t){var e=Aa(t);return function(r){return cn(r,t,e)}}(an(t,1))},zr.constant=Xa,zr.countBy=po,zr.create=function(t,e){var r=kr(t);return null==e?r:rn(r,e)},zr.curry=function t(e,n,i){var s=Yi(e,8,r,r,r,r,r,n=i?r:n);return s.placeholder=t.placeholder,s},zr.curryRight=function t(e,n,i){var s=Yi(e,o,r,r,r,r,r,n=i?r:n);return s.placeholder=t.placeholder,s},zr.debounce=Ao,zr.defaults=Ia,zr.defaultsDeep=Pa,zr.defer=To,zr.delay=jo,zr.difference=zs,zr.differenceBy=ks,zr.differenceWith=$s,zr.drop=function(t,e,n){var i=null==t?0:t.length;return i?ri(t,(e=n||e===r?1:pa(e))<0?0:e,i):[]},zr.dropRight=function(t,e,n){var i=null==t?0:t.length;return i?ri(t,0,(e=i-(e=n||e===r?1:pa(e)))<0?0:e):[]},zr.dropRightWhile=function(t,e){return t&&t.length?fi(t,as(e,3),!0,!0):[]},zr.dropWhile=function(t,e){return t&&t.length?fi(t,as(e,3),!0):[]},zr.fill=function(t,e,n,i){var s=null==t?0:t.length;return s?(n&&"number"!=typeof n&&ms(t,e,n)&&(n=0,i=s),function(t,e,n,i){var s=t.length;for((n=pa(n))<0&&(n=-n>s?0:s+n),(i=i===r||i>s?s:pa(i))<0&&(i+=s),i=n>i?0:da(i);n<i;)t[n++]=e;return t}(t,e,n,i)):[]},zr.filter=function(t,e){return(Vo(t)?Ae:gn)(t,as(e,3))},zr.flatMap=function(t,e){return yn(Eo(t,e),1)},zr.flatMapDeep=function(t,e){return yn(Eo(t,e),l)},zr.flatMapDepth=function(t,e,n){return n=n===r?1:pa(n),yn(Eo(t,e),n)},zr.flatten=Vs,zr.flattenDeep=function(t){return null!=t&&t.length?yn(t,l):[]},zr.flattenDepth=function(t,e){return null!=t&&t.length?yn(t,e=e===r?1:pa(e)):[]},zr.flip=function(t){return Yi(t,512)},zr.flow=tc,zr.flowRight=ec,zr.fromPairs=function(t){for(var e=-1,r=null==t?0:t.length,n={};++e<r;){var i=t[e];n[i[0]]=i[1]}return n},zr.functions=function(t){return null==t?[]:bn(t,Aa(t))},zr.functionsIn=function(t){return null==t?[]:bn(t,Ta(t))},zr.groupBy=wo,zr.initial=function(t){return null!=t&&t.length?ri(t,0,-1):[]},zr.intersection=Bs,zr.intersectionBy=Fs,zr.intersectionWith=Gs,zr.invert=xa,zr.invertBy=Ra,zr.invokeMap=_o,zr.iteratee=nc,zr.keyBy=bo,zr.keys=Aa,zr.keysIn=Ta,zr.map=Eo,zr.mapKeys=function(t,e){var r={};return e=as(e,3),wn(t,(function(t,n,i){nn(r,e(t,n,i),t)})),r},zr.mapValues=function(t,e){var r={};return e=as(e,3),wn(t,(function(t,n,i){nn(r,n,e(t,n,i))})),r},zr.matches=function(t){return kn(an(t,1))},zr.matchesProperty=function(t,e){return $n(t,an(e,1))},zr.memoize=No,zr.merge=ja,zr.mergeWith=Na,zr.method=ic,zr.methodOf=sc,zr.mixin=oc,zr.negate=Lo,zr.nthArg=function(t){return t=pa(t),Qn((function(e){return Hn(e,t)}))},zr.omit=La,zr.omitBy=function(t,e){return Da(t,Lo(as(e)))},zr.once=function(t){return xo(2,t)},zr.orderBy=function(t,e,n,i){return null==t?[]:(Vo(e)||(e=null==e?[]:[e]),Vo(n=i?r:n)||(n=null==n?[]:[n]),Vn(t,e,n))},zr.over=cc,zr.overArgs=qo,zr.overEvery=uc,zr.overSome=hc,zr.partial=Do,zr.partialRight=Mo,zr.partition=Io,zr.pick=qa,zr.pickBy=Da,zr.property=lc,zr.propertyOf=function(t){return function(e){return null==t?r:En(t,e)}},zr.pull=Qs,zr.pullAll=Ys,zr.pullAllBy=function(t,e,r){return t&&t.length&&e&&e.length?Bn(t,e,as(r,2)):t},zr.pullAllWith=function(t,e,n){return t&&t.length&&e&&e.length?Bn(t,e,r,n):t},zr.pullAt=Js,zr.range=fc,zr.rangeRight=pc,zr.rearg=zo,zr.reject=function(t,e){return(Vo(t)?Ae:gn)(t,Lo(as(e,3)))},zr.remove=function(t,e){var r=[];if(!t||!t.length)return r;var n=-1,i=[],s=t.length;for(e=as(e,3);++n<s;){var o=t[n];e(o,n,t)&&(r.push(o),i.push(n))}return Fn(t,i),r},zr.rest=function(t,e){if("function"!=typeof t)throw new Ct(n);return Qn(t,e=e===r?e:pa(e))},zr.reverse=Zs,zr.sampleSize=function(t,e,n){return e=(n?ms(t,e,n):e===r)?1:pa(e),(Vo(t)?Yr:Jn)(t,e)},zr.set=function(t,e,r){return null==t?t:Zn(t,e,r)},zr.setWith=function(t,e,n,i){return i="function"==typeof i?i:r,null==t?t:Zn(t,e,n,i)},zr.shuffle=function(t){return(Vo(t)?Jr:ei)(t)},zr.slice=function(t,e,n){var i=null==t?0:t.length;return i?(n&&"number"!=typeof n&&ms(t,e,n)?(e=0,n=i):(e=null==e?0:pa(e),n=n===r?i:pa(n)),ri(t,e,n)):[]},zr.sortBy=Po,zr.sortedUniq=function(t){return t&&t.length?oi(t):[]},zr.sortedUniqBy=function(t,e){return t&&t.length?oi(t,as(e,2)):[]},zr.split=function(t,e,n){return n&&"number"!=typeof n&&ms(t,e,n)&&(e=n=r),(n=n===r?d:n>>>0)?(t=va(t))&&("string"==typeof e||null!=e&&!ia(e))&&!(e=ci(e))&&sr(t)?_i(lr(t),0,n):t.split(e,n):[]},zr.spread=function(t,e){if("function"!=typeof t)throw new Ct(n);return e=null==e?0:yr(pa(e),0),Qn((function(r){var n=r[e],i=_i(r,0,e);return n&&Le(i,n),Se(t,this,i)}))},zr.tail=function(t){var e=null==t?0:t.length;return e?ri(t,1,e):[]},zr.take=function(t,e,n){return t&&t.length?ri(t,0,(e=n||e===r?1:pa(e))<0?0:e):[]},zr.takeRight=function(t,e,n){var i=null==t?0:t.length;return i?ri(t,(e=i-(e=n||e===r?1:pa(e)))<0?0:e,i):[]},zr.takeRightWhile=function(t,e){return t&&t.length?fi(t,as(e,3),!1,!0):[]},zr.takeWhile=function(t,e){return t&&t.length?fi(t,as(e,3)):[]},zr.tap=function(t,e){return e(t),t},zr.throttle=function(t,e,r){var i=!0,s=!0;if("function"!=typeof t)throw new Ct(n);return Xo(r)&&(i="leading"in r?!!r.leading:i,s="trailing"in r?!!r.trailing:s),Ao(t,e,{leading:i,maxWait:e,trailing:s})},zr.thru=lo,zr.toArray=la,zr.toPairs=Ma,zr.toPairsIn=za,zr.toPath=function(t){return Vo(t)?Ne(t,qs):aa(t)?[t]:Ri(Ls(va(t)))},zr.toPlainObject=ya,zr.transform=function(t,e,r){var n=Vo(t),i=n||Go(t)||ca(t);if(e=as(e,4),null==r){var s=t&&t.constructor;r=i?n?new s:[]:Xo(t)&&Yo(s)?kr(Ft(t)):{}}return(i?xe:wn)(t,(function(t,n,i){return e(r,t,n,i)})),r},zr.unary=function(t){return Oo(t,1)},zr.union=Xs,zr.unionBy=to,zr.unionWith=eo,zr.uniq=function(t){return t&&t.length?ui(t):[]},zr.uniqBy=function(t,e){return t&&t.length?ui(t,as(e,2)):[]},zr.uniqWith=function(t,e){return e="function"==typeof e?e:r,t&&t.length?ui(t,r,e):[]},zr.unset=function(t,e){return null==t||hi(t,e)},zr.unzip=ro,zr.unzipWith=no,zr.update=function(t,e,r){return null==t?t:li(t,e,vi(r))},zr.updateWith=function(t,e,n,i){return i="function"==typeof i?i:r,null==t?t:li(t,e,vi(n),i)},zr.values=ka,zr.valuesIn=function(t){return null==t?[]:Ze(t,Ta(t))},zr.without=io,zr.words=Ya,zr.wrap=function(t,e){return Do(vi(e),t)},zr.xor=so,zr.xorBy=oo,zr.xorWith=ao,zr.zip=co,zr.zipObject=function(t,e){return gi(t||[],e||[],Xr)},zr.zipObjectDeep=function(t,e){return gi(t||[],e||[],Zn)},zr.zipWith=uo,zr.entries=Ma,zr.entriesIn=za,zr.extend=wa,zr.extendWith=_a,oc(zr,zr),zr.add=yc,zr.attempt=Ja,zr.camelCase=$a,zr.capitalize=Ua,zr.ceil=vc,zr.clamp=function(t,e,n){return n===r&&(n=e,e=r),n!==r&&(n=(n=ga(n))==n?n:0),e!==r&&(e=(e=ga(e))==e?e:0),on(ga(t),e,n)},zr.clone=function(t){return an(t,4)},zr.cloneDeep=function(t){return an(t,5)},zr.cloneDeepWith=function(t,e){return an(t,5,e="function"==typeof e?e:r)},zr.cloneWith=function(t,e){return an(t,4,e="function"==typeof e?e:r)},zr.conformsTo=function(t,e){return null==e||cn(t,e,Aa(e))},zr.deburr=Ha,zr.defaultTo=function(t,e){return null==t||t!=t?e:t},zr.divide=mc,zr.endsWith=function(t,e,n){t=va(t),e=ci(e);var i=t.length,s=n=n===r?i:on(pa(n),0,i);return(n-=e.length)>=0&&t.slice(n,s)==e},zr.eq=ko,zr.escape=function(t){return(t=va(t))&&Q.test(t)?t.replace(G,nr):t},zr.escapeRegExp=function(t){return(t=va(t))&&nt.test(t)?t.replace(rt,"\\$&"):t},zr.every=function(t,e,n){var i=Vo(t)?Ce:pn;return n&&ms(t,e,n)&&(e=r),i(t,as(e,3))},zr.find=go,zr.findIndex=Us,zr.findKey=function(t,e){return ke(t,as(e,3),wn)},zr.findLast=yo,zr.findLastIndex=Hs,zr.findLastKey=function(t,e){return ke(t,as(e,3),_n)},zr.floor=wc,zr.forEach=vo,zr.forEachRight=mo,zr.forIn=function(t,e){return null==t?t:vn(t,as(e,3),Ta)},zr.forInRight=function(t,e){return null==t?t:mn(t,as(e,3),Ta)},zr.forOwn=function(t,e){return t&&wn(t,as(e,3))},zr.forOwnRight=function(t,e){return t&&_n(t,as(e,3))},zr.get=Sa,zr.gt=$o,zr.gte=Uo,zr.has=function(t,e){return null!=t&&ds(t,e,On)},zr.hasIn=Oa,zr.head=Ks,zr.identity=rc,zr.includes=function(t,e,r,n){t=Bo(t)?t:ka(t),r=r&&!n?pa(r):0;var i=t.length;return r<0&&(r=yr(i+r,0)),oa(t)?r<=i&&t.indexOf(e,r)>-1:!!i&&Ue(t,e,r)>-1},zr.indexOf=function(t,e,r){var n=null==t?0:t.length;if(!n)return-1;var i=null==r?0:pa(r);return i<0&&(i=yr(n+i,0)),Ue(t,e,i)},zr.inRange=function(t,e,n){return e=fa(e),n===r?(n=e,e=0):n=fa(n),function(t,e,r){return t>=vr(e,r)&&t<yr(e,r)}(t=ga(t),e,n)},zr.invoke=Ca,zr.isArguments=Ho,zr.isArray=Vo,zr.isArrayBuffer=Ko,zr.isArrayLike=Bo,zr.isArrayLikeObject=Fo,zr.isBoolean=function(t){return!0===t||!1===t||ta(t)&&Pn(t)==m},zr.isBuffer=Go,zr.isDate=Wo,zr.isElement=function(t){return ta(t)&&1===t.nodeType&&!na(t)},zr.isEmpty=function(t){if(null==t)return!0;if(Bo(t)&&(Vo(t)||"string"==typeof t||"function"==typeof t.splice||Go(t)||ca(t)||Ho(t)))return!t.length;var e=ps(t);if(e==I||e==R)return!t.size;if(Es(t))return!qn(t).length;for(var r in t)if(qt.call(t,r))return!1;return!0},zr.isEqual=function(t,e){return Tn(t,e)},zr.isEqualWith=function(t,e,n){var i=(n="function"==typeof n?n:r)?n(t,e):r;return i===r?Tn(t,e,r,n):!!i},zr.isError=Qo,zr.isFinite=function(t){return"number"==typeof t&&ze(t)},zr.isFunction=Yo,zr.isInteger=Jo,zr.isLength=Zo,zr.isMap=ea,zr.isMatch=function(t,e){return t===e||jn(t,e,us(e))},zr.isMatchWith=function(t,e,n){return n="function"==typeof n?n:r,jn(t,e,us(e),n)},zr.isNaN=function(t){return ra(t)&&t!=+t},zr.isNative=function(t){if(bs(t))throw new It("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Nn(t)},zr.isNil=function(t){return null==t},zr.isNull=function(t){return null===t},zr.isNumber=ra,zr.isObject=Xo,zr.isObjectLike=ta,zr.isPlainObject=na,zr.isRegExp=ia,zr.isSafeInteger=function(t){return Jo(t)&&t>=-f&&t<=f},zr.isSet=sa,zr.isString=oa,zr.isSymbol=aa,zr.isTypedArray=ca,zr.isUndefined=function(t){return t===r},zr.isWeakMap=function(t){return ta(t)&&ps(t)==T},zr.isWeakSet=function(t){return ta(t)&&"[object WeakSet]"==Pn(t)},zr.join=function(t,e){return null==t?"":Fe.call(t,e)},zr.kebabCase=Va,zr.last=Ws,zr.lastIndexOf=function(t,e,n){var i=null==t?0:t.length;if(!i)return-1;var s=i;return n!==r&&(s=(s=pa(n))<0?yr(i+s,0):vr(s,i-1)),e==e?function(t,e,r){for(var n=r+1;n--;)if(t[n]===e)return n;return n}(t,e,s):$e(t,Ve,s,!0)},zr.lowerCase=Ka,zr.lowerFirst=Ba,zr.lt=ua,zr.lte=ha,zr.max=function(t){return t&&t.length?dn(t,rc,Sn):r},zr.maxBy=function(t,e){return t&&t.length?dn(t,as(e,2),Sn):r},zr.mean=function(t){return Ke(t,rc)},zr.meanBy=function(t,e){return Ke(t,as(e,2))},zr.min=function(t){return t&&t.length?dn(t,rc,Mn):r},zr.minBy=function(t,e){return t&&t.length?dn(t,as(e,2),Mn):r},zr.stubArray=dc,zr.stubFalse=gc,zr.stubObject=function(){return{}},zr.stubString=function(){return""},zr.stubTrue=function(){return!0},zr.multiply=_c,zr.nth=function(t,e){return t&&t.length?Hn(t,pa(e)):r},zr.noConflict=function(){return pe._===this&&(pe._=$t),this},zr.noop=ac,zr.now=So,zr.pad=function(t,e,r){t=va(t);var n=(e=pa(e))?hr(t):0;if(!e||n>=e)return t;var i=(e-n)/2;return Vi(ge(i),r)+t+Vi(de(i),r)},zr.padEnd=function(t,e,r){t=va(t);var n=(e=pa(e))?hr(t):0;return e&&n<e?t+Vi(e-n,r):t},zr.padStart=function(t,e,r){t=va(t);var n=(e=pa(e))?hr(t):0;return e&&n<e?Vi(e-n,r)+t:t},zr.parseInt=function(t,e,r){return r||null==e?e=0:e&&(e=+e),wr(va(t).replace(it,""),e||0)},zr.random=function(t,e,n){if(n&&"boolean"!=typeof n&&ms(t,e,n)&&(e=n=r),n===r&&("boolean"==typeof e?(n=e,e=r):"boolean"==typeof t&&(n=t,t=r)),t===r&&e===r?(t=0,e=1):(t=fa(t),e===r?(e=t,t=0):e=fa(e)),t>e){var i=t;t=e,e=i}if(n||t%1||e%1){var s=_r();return vr(t+s*(e-t+ue("1e-"+((s+"").length-1))),e)}return Gn(t,e)},zr.reduce=function(t,e,r){var n=Vo(t)?qe:Ge,i=arguments.length<3;return n(t,as(e,4),r,i,ln)},zr.reduceRight=function(t,e,r){var n=Vo(t)?De:Ge,i=arguments.length<3;return n(t,as(e,4),r,i,fn)},zr.repeat=function(t,e,n){return e=(n?ms(t,e,n):e===r)?1:pa(e),Wn(va(t),e)},zr.replace=function(){var t=arguments,e=va(t[0]);return t.length<3?e:e.replace(t[1],t[2])},zr.result=function(t,e,n){var i=-1,s=(e=mi(e,t)).length;for(s||(s=1,t=r);++i<s;){var o=null==t?r:t[qs(e[i])];o===r&&(i=s,o=n),t=Yo(o)?o.call(t):o}return t},zr.round=bc,zr.runInContext=t,zr.sample=function(t){return(Vo(t)?Qr:Yn)(t)},zr.size=function(t){if(null==t)return 0;if(Bo(t))return oa(t)?hr(t):t.length;var e=ps(t);return e==I||e==R?t.size:qn(t).length},zr.snakeCase=Fa,zr.some=function(t,e,n){var i=Vo(t)?Me:ni;return n&&ms(t,e,n)&&(e=r),i(t,as(e,3))},zr.sortedIndex=function(t,e){return ii(t,e)},zr.sortedIndexBy=function(t,e,r){return si(t,e,as(r,2))},zr.sortedIndexOf=function(t,e){var r=null==t?0:t.length;if(r){var n=ii(t,e);if(n<r&&ko(t[n],e))return n}return-1},zr.sortedLastIndex=function(t,e){return ii(t,e,!0)},zr.sortedLastIndexBy=function(t,e,r){return si(t,e,as(r,2),!0)},zr.sortedLastIndexOf=function(t,e){if(null!=t&&t.length){var r=ii(t,e,!0)-1;if(ko(t[r],e))return r}return-1},zr.startCase=Ga,zr.startsWith=function(t,e,r){return t=va(t),r=null==r?0:on(pa(r),0,t.length),e=ci(e),t.slice(r,r+e.length)==e},zr.subtract=Ec,zr.sum=function(t){return t&&t.length?We(t,rc):0},zr.sumBy=function(t,e){return t&&t.length?We(t,as(e,2)):0},zr.template=function(t,e,n){var i=zr.templateSettings;n&&ms(t,e,n)&&(e=r),t=va(t),e=_a({},e,i,Ji);var s,o,a=_a({},e.imports,i.imports,Ji),c=Aa(a),u=Ze(a,c),h=0,l=e.interpolate||_t,f="__p += '",p=xt((e.escape||_t).source+"|"+l.source+"|"+(l===Z?ft:_t).source+"|"+(e.evaluate||_t).source+"|$","g"),d="//# sourceURL="+(qt.call(e,"sourceURL")?(e.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++se+"]")+"\n";t.replace(p,(function(e,r,n,i,a,c){return n||(n=i),f+=t.slice(h,c).replace(bt,ir),r&&(s=!0,f+="' +\n__e("+r+") +\n'"),a&&(o=!0,f+="';\n"+a+";\n__p += '"),n&&(f+="' +\n((__t = ("+n+")) == null ? '' : __t) +\n'"),h=c+e.length,e})),f+="';\n";var g=qt.call(e,"variable")&&e.variable;if(g){if(ht.test(g))throw new It("Invalid `variable` option passed into `_.template`")}else f="with (obj) {\n"+f+"\n}\n";f=(o?f.replace(V,""):f).replace(K,"$1").replace(B,"$1;"),f="function("+(g||"obj")+") {\n"+(g?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(s?", __e = _.escape":"")+(o?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+f+"return __p\n}";var y=Ja((function(){return Pt(c,d+"return "+f).apply(r,u)}));if(y.source=f,Qo(y))throw y;return y},zr.times=function(t,e){if((t=pa(t))<1||t>f)return[];var r=d,n=vr(t,d);e=as(e),t-=d;for(var i=Qe(n,e);++r<t;)e(r);return i},zr.toFinite=fa,zr.toInteger=pa,zr.toLength=da,zr.toLower=function(t){return va(t).toLowerCase()},zr.toNumber=ga,zr.toSafeInteger=function(t){return t?on(pa(t),-f,f):0===t?t:0},zr.toString=va,zr.toUpper=function(t){return va(t).toUpperCase()},zr.trim=function(t,e,n){if((t=va(t))&&(n||e===r))return Ye(t);if(!t||!(e=ci(e)))return t;var i=lr(t),s=lr(e);return _i(i,tr(i,s),er(i,s)+1).join("")},zr.trimEnd=function(t,e,n){if((t=va(t))&&(n||e===r))return t.slice(0,fr(t)+1);if(!t||!(e=ci(e)))return t;var i=lr(t);return _i(i,0,er(i,lr(e))+1).join("")},zr.trimStart=function(t,e,n){if((t=va(t))&&(n||e===r))return t.replace(it,"");if(!t||!(e=ci(e)))return t;var i=lr(t);return _i(i,tr(i,lr(e))).join("")},zr.truncate=function(t,e){var n=30,i="...";if(Xo(e)){var s="separator"in e?e.separator:s;n="length"in e?pa(e.length):n,i="omission"in e?ci(e.omission):i}var o=(t=va(t)).length;if(sr(t)){var a=lr(t);o=a.length}if(n>=o)return t;var c=n-hr(i);if(c<1)return i;var u=a?_i(a,0,c).join(""):t.slice(0,c);if(s===r)return u+i;if(a&&(c+=u.length-c),ia(s)){if(t.slice(c).search(s)){var h,l=u;for(s.global||(s=xt(s.source,va(pt.exec(s))+"g")),s.lastIndex=0;h=s.exec(l);)var f=h.index;u=u.slice(0,f===r?c:f)}}else if(t.indexOf(ci(s),c)!=c){var p=u.lastIndexOf(s);p>-1&&(u=u.slice(0,p))}return u+i},zr.unescape=function(t){return(t=va(t))&&W.test(t)?t.replace(F,pr):t},zr.uniqueId=function(t){var e=++Dt;return va(t)+e},zr.upperCase=Wa,zr.upperFirst=Qa,zr.each=vo,zr.eachRight=mo,zr.first=Ks,oc(zr,function(){var t={};return wn(zr,(function(e,r){qt.call(zr.prototype,r)||(t[r]=e)})),t}(),{chain:!1}),zr.VERSION="4.17.21",xe(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(t){zr[t].placeholder=zr})),xe(["drop","take"],(function(t,e){Hr.prototype[t]=function(n){n=n===r?1:yr(pa(n),0);var i=this.__filtered__&&!e?new Hr(this):this.clone();return i.__filtered__?i.__takeCount__=vr(n,i.__takeCount__):i.__views__.push({size:vr(n,d),type:t+(i.__dir__<0?"Right":"")}),i},Hr.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()}})),xe(["filter","map","takeWhile"],(function(t,e){var r=e+1,n=1==r||3==r;Hr.prototype[t]=function(t){var e=this.clone();return e.__iteratees__.push({iteratee:as(t,3),type:r}),e.__filtered__=e.__filtered__||n,e}})),xe(["head","last"],(function(t,e){var r="take"+(e?"Right":"");Hr.prototype[t]=function(){return this[r](1).value()[0]}})),xe(["initial","tail"],(function(t,e){var r="drop"+(e?"":"Right");Hr.prototype[t]=function(){return this.__filtered__?new Hr(this):this[r](1)}})),Hr.prototype.compact=function(){return this.filter(rc)},Hr.prototype.find=function(t){return this.filter(t).head()},Hr.prototype.findLast=function(t){return this.reverse().find(t)},Hr.prototype.invokeMap=Qn((function(t,e){return"function"==typeof t?new Hr(this):this.map((function(r){return Cn(r,t,e)}))})),Hr.prototype.reject=function(t){return this.filter(Lo(as(t)))},Hr.prototype.slice=function(t,e){t=pa(t);var n=this;return n.__filtered__&&(t>0||e<0)?new Hr(n):(t<0?n=n.takeRight(-t):t&&(n=n.drop(t)),e!==r&&(n=(e=pa(e))<0?n.dropRight(-e):n.take(e-t)),n)},Hr.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},Hr.prototype.toArray=function(){return this.take(d)},wn(Hr.prototype,(function(t,e){var n=/^(?:filter|find|map|reject)|While$/.test(e),i=/^(?:head|last)$/.test(e),s=zr[i?"take"+("last"==e?"Right":""):e],o=i||/^find/.test(e);s&&(zr.prototype[e]=function(){var e=this.__wrapped__,a=i?[1]:arguments,c=e instanceof Hr,u=a[0],h=c||Vo(e),l=function(t){var e=s.apply(zr,Le([t],a));return i&&f?e[0]:e};h&&n&&"function"==typeof u&&1!=u.length&&(c=h=!1);var f=this.__chain__,p=!!this.__actions__.length,d=o&&!f,g=c&&!p;if(!o&&h){e=g?e:new Hr(this);var y=t.apply(e,a);return y.__actions__.push({func:lo,args:[l],thisArg:r}),new Ur(y,f)}return d&&g?t.apply(this,a):(y=this.thru(l),d?i?y.value()[0]:y.value():y)})})),xe(["pop","push","shift","sort","splice","unshift"],(function(t){var e=At[t],r=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",n=/^(?:pop|shift)$/.test(t);zr.prototype[t]=function(){var t=arguments;if(n&&!this.__chain__){var i=this.value();return e.apply(Vo(i)?i:[],t)}return this[r]((function(r){return e.apply(Vo(r)?r:[],t)}))}})),wn(Hr.prototype,(function(t,e){var r=zr[e];if(r){var n=r.name+"";qt.call(Cr,n)||(Cr[n]=[]),Cr[n].push({name:e,func:r})}})),Cr[ki(r,2).name]=[{name:"wrapper",func:r}],Hr.prototype.clone=function(){var t=new Hr(this.__wrapped__);return t.__actions__=Ri(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=Ri(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=Ri(this.__views__),t},Hr.prototype.reverse=function(){if(this.__filtered__){var t=new Hr(this);t.__dir__=-1,t.__filtered__=!0}else(t=this.clone()).__dir__*=-1;return t},Hr.prototype.value=function(){var t=this.__wrapped__.value(),e=this.__dir__,r=Vo(t),n=e<0,i=r?t.length:0,s=function(t,e,r){for(var n=-1,i=r.length;++n<i;){var s=r[n],o=s.size;switch(s.type){case"drop":t+=o;break;case"dropRight":e-=o;break;case"take":e=vr(e,t+o);break;case"takeRight":t=yr(t,e-o)}}return{start:t,end:e}}(0,i,this.__views__),o=s.start,a=s.end,c=a-o,u=n?a:o-1,h=this.__iteratees__,l=h.length,f=0,p=vr(c,this.__takeCount__);if(!r||!n&&i==c&&p==c)return pi(t,this.__actions__);var d=[];t:for(;c--&&f<p;){for(var g=-1,y=t[u+=e];++g<l;){var v=h[g],m=v.iteratee,w=v.type,_=m(y);if(2==w)y=_;else if(!_){if(1==w)continue t;break t}}d[f++]=y}return d},zr.prototype.at=fo,zr.prototype.chain=function(){return ho(this)},zr.prototype.commit=function(){return new Ur(this.value(),this.__chain__)},zr.prototype.next=function(){this.__values__===r&&(this.__values__=la(this.value()));var t=this.__index__>=this.__values__.length;return{done:t,value:t?r:this.__values__[this.__index__++]}},zr.prototype.plant=function(t){for(var e,n=this;n instanceof $r;){var i=Ms(n);i.__index__=0,i.__values__=r,e?s.__wrapped__=i:e=i;var s=i;n=n.__wrapped__}return s.__wrapped__=t,e},zr.prototype.reverse=function(){var t=this.__wrapped__;if(t instanceof Hr){var e=t;return this.__actions__.length&&(e=new Hr(this)),(e=e.reverse()).__actions__.push({func:lo,args:[Zs],thisArg:r}),new Ur(e,this.__chain__)}return this.thru(Zs)},zr.prototype.toJSON=zr.prototype.valueOf=zr.prototype.value=function(){return pi(this.__wrapped__,this.__actions__)},zr.prototype.first=zr.prototype.head,Jt&&(zr.prototype[Jt]=function(){return this}),zr}();ge?((ge.exports=dr)._=dr,de._=dr):pe._=dr}).call(Ko)}(Bo,Bo.exports);var Fo=Object.defineProperty,Go=Object.defineProperties,Wo=Object.getOwnPropertyDescriptors,Qo=Object.getOwnPropertySymbols,Yo=Object.prototype.hasOwnProperty,Jo=Object.prototype.propertyIsEnumerable,Zo=(t,e,r)=>e in t?Fo(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Xo=(t,e)=>{for(var r in e||(e={}))Yo.call(e,r)&&Zo(t,r,e[r]);if(Qo)for(var r of Qo(e))Jo.call(e,r)&&Zo(t,r,e[r]);return t},ta=(t,e)=>Go(t,Wo(e));function ea(t,e,r){var n;const i=Ct(t);return(null==(n=e.rpcMap)?void 0:n[i.reference])||`https://rpc.walletconnect.com/v1/?chainId=${i.namespace}:${i.reference}&projectId=${r}`}function ra(t){return t.includes(":")?t.split(":")[1]:t}function na(t){return t.map((t=>`${t.split(":")[0]}:${t.split(":")[1]}`))}function ia(t){var e,r,n,i;const s={};if(!ot(t))return s;for(const[o,a]of Object.entries(t)){const t=xt(o)?[o]:a.chains,c=a.methods||[],u=a.events||[],h=a.rpcMap||{},l=Ot(o);s[l]=ta(Xo(Xo({},s[l]),a),{chains:Rt(t,null==(e=s[l])?void 0:e.chains),methods:Rt(c,null==(r=s[l])?void 0:r.methods),events:Rt(u,null==(n=s[l])?void 0:n.events),rpcMap:Xo(Xo({},h),null==(i=s[l])?void 0:i.rpcMap)})}return s}function sa(t){return t.includes(":")?t.split(":")[2]:t}function oa(t){const e={};for(const[r,n]of Object.entries(t)){const t=n.methods||[],i=n.events||[],s=n.accounts||[],o=xt(r)?[r]:n.chains?n.chains:na(n.accounts);e[r]={chains:o,methods:t,events:i,accounts:s}}return e}function aa(t){return"number"==typeof t?t:t.includes("0x")?parseInt(t,16):t.includes(":")?Number(t.split(":")[1]):Number(t)}const ca={},ua=t=>ca[t],ha=(t,e)=>{ca[t]=e};class la{constructor(t){this.name="polkadot",this.namespace=t.namespace,this.events=ua("events"),this.client=ua("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,e){this.httpProviders[t]||this.setHttpProvider(t,e),this.chainId=t,this.events.emit(Vo,`${this.name}:${t}`)}getAccounts(){const t=this.namespace.accounts;return t&&t.filter((t=>t.split(":")[1]===this.chainId.toString())).map((t=>t.split(":")[2]))||[]}createHttpProviders(){const t={};return this.namespace.chains.forEach((e=>{var r;const n=ra(e);t[n]=this.createHttpProvider(n,null==(r=this.namespace.rpcMap)?void 0:r[e])})),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,e=this.httpProviders[t];if(typeof e>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return e}setHttpProvider(t,e){const r=this.createHttpProvider(t,e);r&&(this.httpProviders[t]=r)}createHttpProvider(t,e){const r=e||ea(t,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${t}`);return new en(new $o(r,ua("disableProviderPing")))}}class fa{constructor(t){this.name="eip155",this.namespace=t.namespace,this.events=ua("events"),this.client=ua("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(t){switch(t.request.method){case"eth_requestAccounts":case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(t);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(t.request.method)?await this.client.request(t):this.getHttpProvider().request(t.request)}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}setDefaultChain(t,e){this.httpProviders[t]||this.setHttpProvider(parseInt(t),e),this.chainId=parseInt(t),this.events.emit(Vo,`${this.name}:${t}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}createHttpProvider(t,e){const r=e||ea(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${t}`);return new en(new $o(r,ua("disableProviderPing")))}setHttpProvider(t,e){const r=this.createHttpProvider(t,e);r&&(this.httpProviders[t]=r)}createHttpProviders(){const t={};return this.namespace.chains.forEach((e=>{var r;const n=parseInt(ra(e));t[n]=this.createHttpProvider(n,null==(r=this.namespace.rpcMap)?void 0:r[e])})),t}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter((t=>t.split(":")[1]===this.chainId.toString())).map((t=>t.split(":")[2])))]:[]}getHttpProvider(){const t=this.chainId,e=this.httpProviders[t];if(typeof e>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return e}async handleSwitchChain(t){var e,r;let n=t.request.params?null==(e=t.request.params[0])?void 0:e.chainId:"0x0";n=n.startsWith("0x")?n:`0x${n}`;const i=parseInt(n,16);if(this.isChainApproved(i))this.setDefaultChain(`${i}`);else{if(!this.namespace.methods.includes("wallet_switchEthereumChain"))throw new Error(`Failed to switch to chain 'eip155:${i}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);await this.client.request({topic:t.topic,request:{method:t.request.method,params:[{chainId:n}]},chainId:null==(r=this.namespace.chains)?void 0:r[0]}),this.setDefaultChain(`${i}`)}return null}isChainApproved(t){return this.namespace.chains.includes(`${this.name}:${t}`)}}class pa{constructor(t){this.name="solana",this.namespace=t.namespace,this.events=ua("events"),this.client=ua("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,e){this.httpProviders[t]||this.setHttpProvider(t,e),this.chainId=t,this.events.emit(Vo,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter((t=>t.split(":")[1]===this.chainId.toString())).map((t=>t.split(":")[2])))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach((e=>{var r;const n=ra(e);t[n]=this.createHttpProvider(n,null==(r=this.namespace.rpcMap)?void 0:r[e])})),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,e=this.httpProviders[t];if(typeof e>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return e}setHttpProvider(t,e){const r=this.createHttpProvider(t,e);r&&(this.httpProviders[t]=r)}createHttpProvider(t,e){const r=e||ea(t,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${t}`);return new en(new $o(r,ua("disableProviderPing")))}}class da{constructor(t){this.name="cosmos",this.namespace=t.namespace,this.events=ua("events"),this.client=ua("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,e){this.httpProviders[t]||this.setHttpProvider(t,e),this.chainId=t,this.events.emit(Vo,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter((t=>t.split(":")[1]===this.chainId.toString())).map((t=>t.split(":")[2])))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach((e=>{var r;const n=ra(e);t[n]=this.createHttpProvider(n,null==(r=this.namespace.rpcMap)?void 0:r[e])})),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,e=this.httpProviders[t];if(typeof e>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return e}setHttpProvider(t,e){const r=this.createHttpProvider(t,e);r&&(this.httpProviders[t]=r)}createHttpProvider(t,e){const r=e||ea(t,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${t}`);return new en(new $o(r,ua("disableProviderPing")))}}class ga{constructor(t){this.name="cip34",this.namespace=t.namespace,this.events=ua("events"),this.client=ua("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,e){this.httpProviders[t]||this.setHttpProvider(t,e),this.chainId=t,this.events.emit(Vo,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter((t=>t.split(":")[1]===this.chainId.toString())).map((t=>t.split(":")[2])))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach((e=>{const r=this.getCardanoRPCUrl(e),n=ra(e);t[n]=this.createHttpProvider(n,r)})),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,e=this.httpProviders[t];if(typeof e>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return e}getCardanoRPCUrl(t){const e=this.namespace.rpcMap;if(e)return e[t]}setHttpProvider(t,e){const r=this.createHttpProvider(t,e);r&&(this.httpProviders[t]=r)}createHttpProvider(t,e){const r=e||this.getCardanoRPCUrl(t);if(!r)throw new Error(`No RPC url provided for chainId: ${t}`);return new en(new $o(r,ua("disableProviderPing")))}}class ya{constructor(t){this.name="elrond",this.namespace=t.namespace,this.events=ua("events"),this.client=ua("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,e){this.httpProviders[t]||this.setHttpProvider(t,e),this.chainId=t,this.events.emit(Vo,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter((t=>t.split(":")[1]===this.chainId.toString())).map((t=>t.split(":")[2])))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach((e=>{var r;const n=ra(e);t[n]=this.createHttpProvider(n,null==(r=this.namespace.rpcMap)?void 0:r[e])})),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,e=this.httpProviders[t];if(typeof e>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return e}setHttpProvider(t,e){const r=this.createHttpProvider(t,e);r&&(this.httpProviders[t]=r)}createHttpProvider(t,e){const r=e||ea(t,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${t}`);return new en(new $o(r,ua("disableProviderPing")))}}class va{constructor(t){this.name="multiversx",this.namespace=t.namespace,this.events=ua("events"),this.client=ua("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,e){this.httpProviders[t]||this.setHttpProvider(t,e),this.chainId=t,this.events.emit(Vo,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter((t=>t.split(":")[1]===this.chainId.toString())).map((t=>t.split(":")[2])))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach((e=>{var r;const n=ra(e);t[n]=this.createHttpProvider(n,null==(r=this.namespace.rpcMap)?void 0:r[e])})),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,e=this.httpProviders[t];if(typeof e>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return e}setHttpProvider(t,e){const r=this.createHttpProvider(t,e);r&&(this.httpProviders[t]=r)}createHttpProvider(t,e){const r=e||ea(t,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${t}`);return new en(new $o(r,ua("disableProviderPing")))}}class ma{constructor(t){this.name="near",this.namespace=t.namespace,this.events=ua("events"),this.client=ua("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,e){if(this.chainId=t,!this.httpProviders[t]){const r=e||ea(`${this.name}:${t}`,this.namespace);if(!r)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,r)}this.events.emit(Vo,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t&&t.filter((t=>t.split(":")[1]===this.chainId.toString())).map((t=>t.split(":")[2]))||[]}createHttpProviders(){const t={};return this.namespace.chains.forEach((e=>{var r;t[e]=this.createHttpProvider(e,null==(r=this.namespace.rpcMap)?void 0:r[e])})),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,e=this.httpProviders[t];if(typeof e>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return e}setHttpProvider(t,e){const r=this.createHttpProvider(t,e);r&&(this.httpProviders[t]=r)}createHttpProvider(t,e){const r=e||ea(t,this.namespace);return typeof r>"u"?void 0:new en(new $o(r,ua("disableProviderPing")))}}var wa=Object.defineProperty,_a=Object.defineProperties,ba=Object.getOwnPropertyDescriptors,Ea=Object.getOwnPropertySymbols,Ia=Object.prototype.hasOwnProperty,Pa=Object.prototype.propertyIsEnumerable,Sa=(t,e,r)=>e in t?wa(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Oa=(t,e)=>{for(var r in e||(e={}))Ia.call(e,r)&&Sa(t,r,e[r]);if(Ea)for(var r of Ea(e))Pa.call(e,r)&&Sa(t,r,e[r]);return t},xa=(t,e)=>_a(t,ba(e));class Ra{constructor(t){this.events=new q,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=t,this.logger=typeof(null==t?void 0:t.logger)<"u"&&"string"!=typeof(null==t?void 0:t.logger)?t.logger:Pe.pino(Pe.getDefaultLoggerOptions({level:(null==t?void 0:t.logger)||Uo})),this.disableProviderPing=(null==t?void 0:t.disableProviderPing)||!1}static async init(t){const e=new Ra(t);return await e.initialize(),e}async request(t,e){const[r,n]=this.validateChain(e);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(r).request({request:Oa({},t),chainId:`${r}:${n}`,topic:this.session.topic})}sendAsync(t,e,r){this.request(t,r).then((t=>e(null,t))).catch((t=>e(t,void 0)))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var t;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:null==(t=this.session)?void 0:t.topic,reason:H("USER_DISCONNECTED")}),await this.cleanup()}async connect(t){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(t),await this.cleanupPendingPairings(),!t.skipPairing)return await this.pair(t.pairingTopic)}on(t,e){this.events.on(t,e)}once(t,e){this.events.once(t,e)}removeListener(t,e){this.events.removeListener(t,e)}off(t,e){this.events.off(t,e)}get isWalletConnect(){return!0}async pair(t){this.shouldAbortPairingAttempt=!1;let e=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(e>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:r,approval:n}=await this.client.connect({pairingTopic:t,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});r&&(this.uri=r,this.events.emit("display_uri",r)),await n().then((t=>{this.session=t,this.namespaces||(this.namespaces=oa(t.namespaces),this.persist("namespaces",this.namespaces))})).catch((t=>{if(t.message!==yo)throw t;e++}))}while(!this.session);return this.onConnect(),this.session}setDefaultChain(t,e){try{if(!this.session)return;const[r,n]=this.validateChain(t);this.getProvider(r).setDefaultChain(n,e)}catch(We){if(!/Please call connect/.test(We.message))throw We}}async cleanupPendingPairings(t={}){this.logger.info("Cleaning up inactive pairings...");const e=this.client.pairing.getAll();if(it(e)){for(const r of e)t.deletePairings?this.client.core.expirer.set(r.topic,0):await this.client.core.relayer.subscriber.unsubscribe(r.topic);this.logger.info(`Inactive pairings cleared: ${e.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const t=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[t]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await Do.init({logger:this.providerOpts.logger||Uo,relayUrl:this.providerOpts.relayUrl||"wss://relay.walletconnect.com",projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const t=[...new Set(Object.keys(this.session.namespaces).map((t=>Ot(t))))];ha("client",this.client),ha("events",this.events),ha("disableProviderPing",this.disableProviderPing),t.forEach((t=>{if(!this.session)return;const e=function(t,e){const r=Object.keys(e.namespaces).filter((e=>e.includes(t)));if(!r.length)return[];const n=[];return r.forEach((t=>{const r=e.namespaces[t].accounts;n.push(...r)})),n}(t,this.session),r=na(e),n=function(t={},e={}){const r=ia(t),n=ia(e);return Bo.exports.merge(r,n)}(this.namespaces,this.optionalNamespaces),i=xa(Oa({},n[t]),{accounts:e,chains:r});switch(t){case"eip155":this.rpcProviders[t]=new fa({namespace:i});break;case"solana":this.rpcProviders[t]=new pa({namespace:i});break;case"cosmos":this.rpcProviders[t]=new da({namespace:i});break;case"polkadot":this.rpcProviders[t]=new la({namespace:i});break;case"cip34":this.rpcProviders[t]=new ga({namespace:i});break;case"elrond":this.rpcProviders[t]=new ya({namespace:i});break;case"multiversx":this.rpcProviders[t]=new va({namespace:i});break;case"near":this.rpcProviders[t]=new ma({namespace:i})}}))}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",(t=>{this.events.emit("session_ping",t)})),this.client.on("session_event",(t=>{const{params:e}=t,{event:r}=e;if("accountsChanged"===r.name){const t=r.data;t&&it(t)&&this.events.emit("accountsChanged",t.map(sa))}else if("chainChanged"===r.name){const t=e.chainId,r=e.event.data,n=Ot(t),i=aa(t)!==aa(r)?`${n}:${aa(r)}`:t;this.onChainChanged(i)}else this.events.emit(r.name,r.data);this.events.emit("session_event",t)})),this.client.on("session_update",(({topic:t,params:e})=>{var r;const{namespaces:n}=e,i=null==(r=this.client)?void 0:r.session.get(t);this.session=xa(Oa({},i),{namespaces:n}),this.onSessionUpdate(),this.events.emit("session_update",{topic:t,params:e})})),this.client.on("session_delete",(async t=>{await this.cleanup(),this.events.emit("session_delete",t),this.events.emit("disconnect",xa(Oa({},H("USER_DISCONNECTED")),{data:t.topic}))})),this.on(Vo,(t=>{this.onChainChanged(t,!0)}))}getProvider(t){if(!this.rpcProviders[t])throw new Error(`Provider not found: ${t}`);return this.rpcProviders[t]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach((t=>{var e;this.getProvider(t).updateNamespace(null==(e=this.session)?void 0:e.namespaces[t])}))}setNamespaces(t){const{namespaces:e,optionalNamespaces:r,sessionProperties:n}=t;e&&Object.keys(e).length&&(this.namespaces=e),r&&Object.keys(r).length&&(this.optionalNamespaces=r),this.sessionProperties=n,this.persist("namespaces",e),this.persist("optionalNamespaces",r)}validateChain(t){const[e,r]=(null==t?void 0:t.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[e,r];if(e&&!Object.keys(this.namespaces||{}).map((t=>Ot(t))).includes(e))throw new Error(`Namespace '${e}' is not configured. Please call connect() first with namespace config.`);if(e&&r)return[e,r];const n=Ot(Object.keys(this.namespaces)[0]);return[n,this.rpcProviders[n].getDefaultChain()]}async requestAccounts(){const[t]=this.validateChain();return await this.getProvider(t).requestAccounts()}onChainChanged(t,e=!1){var r;if(!this.namespaces)return;const[n,i]=this.validateChain(t);e||this.getProvider(n).setDefaultChain(i),(null!=(r=this.namespaces[n])?r:this.namespaces[`${n}:${i}`]).defaultChain=i,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",i)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(t,e){this.client.core.storage.setItem(`${Ho}/${t}`,e)}async getFromStore(t){return await this.client.core.storage.getItem(`${Ho}/${t}`)}}const Ca=Ra,Aa=["eth_sendTransaction","personal_sign"],Ta=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],ja=["chainChanged","accountsChanged"],Na=["chainChanged","accountsChanged","message","disconnect","connect"];t({REQUIRED_METHODS:Aa,OPTIONAL_METHODS:Ta,REQUIRED_EVENTS:ja,OPTIONAL_EVENTS:Na});var La=Object.defineProperty,qa=Object.defineProperties,Da=Object.getOwnPropertyDescriptors,Ma=Object.getOwnPropertySymbols,za=Object.prototype.hasOwnProperty,ka=Object.prototype.propertyIsEnumerable,$a=(t,e,r)=>e in t?La(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ua=(t,e)=>{for(var r in e||(e={}))za.call(e,r)&&$a(t,r,e[r]);if(Ma)for(var r of Ma(e))ka.call(e,r)&&$a(t,r,e[r]);return t},Ha=(t,e)=>qa(t,Da(e));function Va(t){return Number(t[0].split(":")[1])}function Ka(t){return`0x${t.toString(16)}`}class Ba{constructor(){this.events=new s.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY="wc@2:ethereum_provider:",this.on=(t,e)=>(this.events.on(t,e),this),this.once=(t,e)=>(this.events.once(t,e),this),this.removeListener=(t,e)=>(this.events.removeListener(t,e),this),this.off=(t,e)=>(this.events.off(t,e),this),this.parseAccount=t=>this.isCompatibleChainId(t)?this.parseAccountId(t).address:t,this.signer={},this.rpc={}}static async init(t){const e=new Ba;return await e.initialize(t),e}async request(t){return await this.signer.request(t,this.formatChainId(this.chainId))}sendAsync(t,e){this.signer.sendAsync(t,e,this.formatChainId(this.chainId))}get connected(){return!!this.signer.client&&this.signer.client.core.relayer.connected}get connecting(){return!!this.signer.client&&this.signer.client.core.relayer.connecting}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(t){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(t);const{required:e,optional:r}=function(t){const{chains:e,optionalChains:r,methods:n,optionalMethods:i,events:s,optionalEvents:o,rpcMap:a}=t;if(!it(e))throw new Error("Invalid chains");const c={chains:e,methods:n||Aa,events:s||ja,rpcMap:Ua({},e.length?{[Va(e)]:a[Va(e)]}:{})},u=null==s?void 0:s.filter((t=>!ja.includes(t))),h=null==n?void 0:n.filter((t=>!Aa.includes(t)));if(!(r||o||i||null!=u&&u.length||null!=h&&h.length))return{required:e.length?c:void 0};const l=(null==u?void 0:u.length)&&(null==h?void 0:h.length)||!r,f={chains:[...new Set(l?c.chains.concat(r||[]):r)],methods:[...new Set(c.methods.concat(null!=i&&i.length?i:Ta))],events:[...new Set(c.events.concat(null!=o&&o.length?o:Na))],rpcMap:a};return{required:e.length?c:void 0,optional:r.length?f:void 0}}(this.rpc);try{const n=await new Promise((async(n,i)=>{var s;this.rpc.showQrModal&&(null==(s=this.modal)||s.subscribeModal((t=>{!t.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),i(new Error("Connection request reset. Please try again.")))}))),await this.signer.connect(Ha(Ua({namespaces:Ua({},e&&{[this.namespace]:e})},r&&{optionalNamespaces:{[this.namespace]:r}}),{pairingTopic:null==t?void 0:t.pairingTopic})).then((t=>{n(t)})).catch((t=>{i(new Error(t.message))}))}));if(!n)return;const i=At(n.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:i),this.setAccounts(i),this.events.emit("connect",{chainId:Ka(this.chainId)})}catch(He){throw this.signer.logger.error(He),He}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",(t=>{const{params:e}=t,{event:r}=e;"accountsChanged"===r.name?(this.accounts=this.parseAccounts(r.data),this.events.emit("accountsChanged",this.accounts)):"chainChanged"===r.name?this.setChainId(this.formatChainId(r.data)):this.events.emit(r.name,r.data),this.events.emit("session_event",t)})),this.signer.on("chainChanged",(t=>{const e=parseInt(t);this.chainId=e,this.events.emit("chainChanged",Ka(this.chainId)),this.persist()})),this.signer.on("session_update",(t=>{this.events.emit("session_update",t)})),this.signer.on("session_delete",(t=>{this.reset(),this.events.emit("session_delete",t),this.events.emit("disconnect",Ha(Ua({},H("USER_DISCONNECTED")),{data:t.topic,name:"USER_DISCONNECTED"}))})),this.signer.on("display_uri",(t=>{var e,r;this.rpc.showQrModal&&(null==(e=this.modal)||e.closeModal(),null==(r=this.modal)||r.openModal({uri:t})),this.events.emit("display_uri",t)}))}switchEthereumChain(t){this.request({method:"wallet_switchEthereumChain",params:[{chainId:t.toString(16)}]})}isCompatibleChainId(t){return"string"==typeof t&&t.startsWith(`${this.namespace}:`)}formatChainId(t){return`${this.namespace}:${t}`}parseChainId(t){return Number(t.split(":")[1])}setChainIds(t){const e=t.filter((t=>this.isCompatibleChainId(t))).map((t=>this.parseChainId(t)));e.length&&(this.chainId=e[0],this.events.emit("chainChanged",Ka(this.chainId)),this.persist())}setChainId(t){if(this.isCompatibleChainId(t)){const e=this.parseChainId(t);this.chainId=e,this.switchEthereumChain(e)}}parseAccountId(t){const[e,r,n]=t.split(":");return{chainId:`${e}:${r}`,address:n}}setAccounts(t){this.accounts=t.filter((t=>this.parseChainId(this.parseAccountId(t).chainId)===this.chainId)).map((t=>this.parseAccountId(t).address)),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(t){var e,r;const n=null!=(e=null==t?void 0:t.chains)?e:[],i=null!=(r=null==t?void 0:t.optionalChains)?r:[],s=n.concat(i);if(!s.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const o=n.length?(null==t?void 0:t.methods)||Aa:[],a=n.length?(null==t?void 0:t.events)||ja:[],c=(null==t?void 0:t.optionalMethods)||[],u=(null==t?void 0:t.optionalEvents)||[],h=(null==t?void 0:t.rpcMap)||this.buildRpcMap(s,t.projectId),l=(null==t?void 0:t.qrModalOptions)||void 0;return{chains:null==n?void 0:n.map((t=>this.formatChainId(t))),optionalChains:i.map((t=>this.formatChainId(t))),methods:o,events:a,optionalMethods:c,optionalEvents:u,rpcMap:h,showQrModal:!(null==t||!t.showQrModal),qrModalOptions:l,projectId:t.projectId,metadata:t.metadata}}buildRpcMap(t,e){const r={};return t.forEach((t=>{r[t]=this.getRpcUrl(t,e)})),r}async initialize(t){if(this.rpc=this.getRpcConfig(t),this.chainId=this.rpc.chains.length?Va(this.rpc.chains):Va(this.rpc.optionalChains),this.signer=await Ca.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:t.disableProviderPing,relayUrl:t.relayUrl,storageOptions:t.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let t;try{const{WalletConnectModal:r}=await Tt((()=>e.import("./index-legacy-de211774.js").then((t=>t.i))),void 0);t=r}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(t)try{this.modal=new t(Ua({walletConnectVersion:2,projectId:this.rpc.projectId,standaloneChains:this.rpc.chains},this.rpc.qrModalOptions))}catch(r){throw this.signer.logger.error(r),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(t){if(!t)return;const{chains:e,optionalChains:r,rpcMap:n}=t;e&&it(e)&&(this.rpc.chains=e.map((t=>this.formatChainId(t))),e.forEach((t=>{this.rpc.rpcMap[t]=(null==n?void 0:n[t])||this.getRpcUrl(t)}))),r&&it(r)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=null==r?void 0:r.map((t=>this.formatChainId(t))),r.forEach((t=>{this.rpc.rpcMap[t]=(null==n?void 0:n[t])||this.getRpcUrl(t)})))}getRpcUrl(t,e){var r;return(null==(r=this.rpc.rpcMap)?void 0:r[t])||`https://rpc.walletconnect.com/v1/?chainId=eip155:${t}&projectId=${e||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const t=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),e=this.session.namespaces[`${this.namespace}:${t}`]?this.session.namespaces[`${this.namespace}:${t}`]:this.session.namespaces[this.namespace];this.setChainIds(t?[this.formatChainId(t)]:null==e?void 0:e.accounts),this.setAccounts(null==e?void 0:e.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(t){return"string"==typeof t||t instanceof String?[this.parseAccount(t)]:t.map((t=>this.parseAccount(t)))}}t("default",Ba),t("EthereumProvider",Ba)}}}));
